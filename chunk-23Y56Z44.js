import{a as tr}from"./chunk-HY3UCQ3V.js";import{a as Zn,aa as Ti,b as er,d as Ya,e as Ja,f as Qt}from"./chunk-3IMHSIYC.js";var Pi=Ya((Vr,$r)=>{"use strict";(function(x,P){typeof Vr=="object"&&typeof $r<"u"?$r.exports=P():typeof define=="function"&&define.amd?define(P):(x=typeof globalThis<"u"?globalThis:x||self,x.Dexie=P())})(Vr,function(){"use strict";var x=function(e,t){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},x(e,t)};function P(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");x(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var y=function(){return y=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},y.apply(this,arguments)};function R(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}typeof SuppressedError=="function"&&SuppressedError;var D=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,S=Object.keys,m=Array.isArray;typeof Promise<"u"&&!D.Promise&&(D.Promise=Promise);function Q(e,t){return typeof t!="object"||S(t).forEach(function(n){e[n]=t[n]}),e}var oe=Object.getPrototypeOf,E={}.hasOwnProperty;function z(e,t){return E.call(e,t)}function le(e,t){typeof t=="function"&&(t=t(oe(e))),(typeof Reflect>"u"?S:Reflect.ownKeys)(t).forEach(function(n){Ue(e,n,t[n])})}var qe=Object.defineProperty;function Ue(e,t,n,r){qe(e,t,Q(n&&z(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function be(e){return{from:function(t){return e.prototype=Object.create(t.prototype),Ue(e.prototype,"constructor",e),{extend:le.bind(null,e.prototype)}}}}var Ee=Object.getOwnPropertyDescriptor;function Fe(e,t){var n=Ee(e,t),r;return n||(r=oe(e))&&Fe(r,t)}var vt=[].slice;function tt(e,t,n){return vt.call(e,t,n)}function re(e,t){return t(e)}function lt(e){if(!e)throw new Error("Assertion Failed")}function me(e){D.setImmediate?setImmediate(e):setTimeout(e,0)}function Ye(e,t){return e.reduce(function(n,r,i){var a=t(r,i);return a&&(n[a[0]]=a[1]),n},{})}function Pe(e,t){if(typeof t=="string"&&z(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,i=t.length;r<i;++r){var a=Pe(e,t[r]);n.push(a)}return n}var u=t.indexOf(".");if(u!==-1){var f=e[t.substr(0,u)];return f==null?void 0:Pe(f,t.substr(u+1))}}function He(e,t,n){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){lt(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)He(e,t[r],n[r])}else{var a=t.indexOf(".");if(a!==-1){var u=t.substr(0,a),f=t.substr(a+1);if(f==="")n===void 0?m(e)&&!isNaN(parseInt(u))?e.splice(u,1):delete e[u]:e[u]=n;else{var l=e[u];(!l||!z(e,u))&&(l=e[u]={}),He(l,f,n)}}else n===void 0?m(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function T(e,t){typeof t=="string"?He(e,t,void 0):"length"in t&&[].map.call(t,function(n){He(e,n,void 0)})}function p(e){var t={};for(var n in e)z(e,n)&&(t[n]=e[n]);return t}var Y=[].concat;function I(e){return Y.apply([],e)}var Me="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(I([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return D[e]}),Oe=new Set(Me.map(function(e){return D[e]}));function Ve(e){var t={};for(var n in e)if(z(e,n)){var r=e[n];t[n]=!r||typeof r!="object"||Oe.has(r.constructor)?r:Ve(r)}return t}function nt(e){for(var t in e)if(z(e,t))return!1;return!0}var rt=null;function st(e){rt=new WeakMap;var t=yt(e);return rt=null,t}function yt(e){if(!e||typeof e!="object")return e;var t=rt.get(e);if(t)return t;if(m(e)){t=[],rt.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(yt(e[n]))}else if(Oe.has(e.constructor))t=e;else{var i=oe(e);t=i===Object.prototype?{}:Object.create(i),rt.set(e,t);for(var a in e)z(e,a)&&(t[a]=yt(e[a]))}return t}var Xe={}.toString;function Ze(e){return Xe.call(e).slice(8,-1)}var mt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Nt=typeof mt=="symbol"?function(e){var t;return e!=null&&(t=e[mt])&&t.apply(e)}:function(){return null};function de(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n>=0}var $e={};function it(e){var t,n,r,i;if(arguments.length===1){if(m(e))return e.slice();if(this===$e&&typeof e=="string")return[e];if(i=Nt(e)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var k=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},N=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],U=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],M=N.concat(U),G={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function _e(e,t){this.name=e,this.message=t}be(_e).from(Error).extend({toString:function(){return this.name+": "+this.message}});function Ie(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function Ce(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=Ie(e,t)}be(Ce).from(_e);function ie(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=Ie(e,this.failures)}be(ie).from(_e);var pt=M.reduce(function(e,t){return e[t]=t+"Error",e},{}),Ot=_e,ne=M.reduce(function(e,t){var n=t+"Error";function r(i,a){this.name=n,i?typeof i=="string"?(this.message="".concat(i).concat(a?`
 `+a:""),this.inner=a||null):typeof i=="object"&&(this.message="".concat(i.name," ").concat(i.message),this.inner=i):(this.message=G[t]||n,this.inner=null)}return be(r).from(Ot),e[t]=r,e},{});ne.Syntax=SyntaxError,ne.Type=TypeError,ne.Range=RangeError;var It=U.reduce(function(e,t){return e[t+"Error"]=ne[t],e},{});function Kt(e,t){if(!e||e instanceof _e||e instanceof TypeError||e instanceof SyntaxError||!e.name||!It[e.name])return e;var n=new It[e.name](t||e.message,e);return"stack"in e&&Ue(n,"stack",{get:function(){return this.inner.stack}}),n}var Bt=M.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=ne[t]),e},{});Bt.ModifyError=Ce,Bt.DexieError=_e,Bt.BulkError=ie;function Se(){}function bt(e){return e}function ot(e,t){return e==null||e===bt?t:function(n){return t(e(n))}}function Re(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ze(e,t){return e===Se?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Re(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Re(i,this.onerror):i),a!==void 0?a:n}}function Qe(e,t){return e===Se?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Re(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Re(r,this.onerror):r)}}function ut(e,t){return e===Se?t:function(n){var r=e.apply(this,arguments);Q(n,r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var u=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Re(i,this.onsuccess):i),a&&(this.onerror=this.onerror?Re(a,this.onerror):a),r===void 0?u===void 0?void 0:u:Q(r,u)}}function ue(e,t){return e===Se?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function c(e,t){return e===Se?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return n.then(function(){return t.apply(r,a)})}return t.apply(this,arguments)}}var o=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function s(e,t){o=e}var d={},w=100,J=typeof Promise>"u"?[]:(function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,oe(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,oe(t),e]})(),W=J[0],se=J[1],q=J[2],ye=se&&se.then,we=W&&W.constructor,Te=!!q;function Je(){queueMicrotask(Ct)}var ke=function(e,t){ce.push([e,t]),Ge&&(Je(),Ge=!1)},Be=!0,Ge=!0,Ke=[],ge=[],ht=bt,Z={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Se,pgp:!1,env:{},finalize:Se},O=Z,ce=[],ae=0,pe=[];function L(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=O;if(typeof e!="function"){if(e!==d)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&At(this,this._value);return}this._state=null,this._value=null,++t.ref,_t(this,e)}var wt={get:function(){var e=O,t=Rn;function n(r,i){var a=this,u=!e.global&&(e!==O||t!==Rn),f=u&&!en(),l=new L(function(h,b){Tt(a,new at(Qr(r,e,u,f),Qr(i,e,u,f),h,b,e))});return this._consoleTask&&(l._consoleTask=this._consoleTask),l}return n.prototype=d,n},set:function(e){Ue(this,"then",e&&e.prototype===d?wt:{get:function(){return e},set:wt.set})}};le(L.prototype,{then:wt,_then:function(e,t){Tt(this,new at(null,null,e,t,O))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],n=arguments[1];return typeof t=="function"?this.then(null,function(r){return r instanceof t?n(r):qt(r)}):this.then(null,function(r){return r&&r.name===t?n(r):qt(r)})},finally:function(e){return this.then(function(t){return L.resolve(e()).then(function(){return t})},function(t){return L.resolve(e()).then(function(){return qt(t)})})},timeout:function(e,t){var n=this;return e<1/0?new L(function(r,i){var a=setTimeout(function(){return i(new ne.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,a))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Ue(L.prototype,Symbol.toStringTag,"Dexie.Promise"),Z.env=Hr();function at(e,t,n,r,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=i}le(L,{all:function(){var e=it.apply(null,arguments).map(Nn);return new L(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(i,a){return L.resolve(i).then(function(u){e[a]=u,--r||t(e)},n)})})},resolve:function(e){if(e instanceof L)return e;if(e&&typeof e.then=="function")return new L(function(n,r){e.then(n,r)});var t=new L(d,!0,e);return t},reject:qt,race:function(){var e=it.apply(null,arguments).map(Nn);return new L(function(t,n){e.map(function(r){return L.resolve(r).then(t,n)})})},PSD:{get:function(){return O},set:function(e){return O=e}},totalEchoes:{get:function(){return Rn}},newPSD:Zt,usePSD:cn,scheduler:{get:function(){return ke},set:function(e){ke=e}},rejectionMapper:{get:function(){return ht},set:function(e){ht=e}},follow:function(e,t){return new L(function(n,r){return Zt(function(i,a){var u=O;u.unhandleds=[],u.onunhandled=a,u.finalize=Re(function(){var f=this;wn(function(){f.unhandleds.length===0?i():a(f.unhandleds[0])})},u.finalize),e()},t,n,r)})}}),we&&(we.allSettled&&Ue(L,"allSettled",function(){var e=it.apply(null,arguments).map(Nn);return new L(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(i,a){return L.resolve(i).then(function(u){return r[a]={status:"fulfilled",value:u}},function(u){return r[a]={status:"rejected",reason:u}}).then(function(){return--n||t(r)})})})}),we.any&&typeof AggregateError<"u"&&Ue(L,"any",function(){var e=it.apply(null,arguments).map(Nn);return new L(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(a,u){return L.resolve(a).then(function(f){return t(f)},function(f){i[u]=f,--r||n(new AggregateError(i))})})})}),we.withResolvers&&(L.withResolvers=we.withResolvers));function _t(e,t){try{t(function(n){if(e._state===null){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&ct();n&&typeof n.then=="function"?_t(e,function(i,a){n instanceof L?n._then(i,a):n.then(i,a)}):(e._state=!0,e._value=n,We(e)),r&&gt()}},At.bind(null,e))}catch(n){At(e,n)}}function At(e,t){if(ge.push(t),e._state===null){var n=e._lib&&ct();t=ht(t),e._state=!1,e._value=t,dn(e),We(e),n&&gt()}}function We(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Tt(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),ae===0&&(++ae,ke(function(){--ae===0&&kt()},[]))}function Tt(e,t){if(e._state===null){e._listeners.push(t);return}var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++ae,ke(et,[n,e,t])}function et(e,t,n){try{var r,i=t._value;!t._state&&ge.length&&(ge=[]),r=o&&t._consoleTask?t._consoleTask.run(function(){return e(i)}):e(i),!t._state&&ge.indexOf(i)===-1&&Xt(t),n.resolve(r)}catch(a){n.reject(a)}finally{--ae===0&&kt(),--n.psd.ref||n.psd.finalize()}}function Ct(){cn(Z,function(){ct()&&gt()})}function ct(){var e=Be;return Be=!1,Ge=!1,e}function gt(){var e,t,n;do for(;ce.length>0;)for(e=ce,ce=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(ce.length>0);Be=!0,Ge=!0}function kt(){var e=Ke;Ke=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=pe.slice(0),n=t.length;n;)t[--n]()}function wn(e){function t(){e(),pe.splice(pe.indexOf(t),1)}pe.push(t),++ae,ke(function(){--ae===0&&kt()},[])}function dn(e){Ke.some(function(t){return t._value===e._value})||Ke.push(e)}function Xt(e){for(var t=Ke.length;t;)if(Ke[--t]._value===e._value){Ke.splice(t,1);return}}function qt(e){return new L(d,!1,e)}function Le(e,t){var n=O;return function(){var r=ct(),i=O;try{return tn(n,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{tn(i,!1),r&&gt()}}}var De={awaits:0,echoes:0,id:0},Ut=0,jt=[],Gt=0,Rn=0,ji=0;function Zt(e,t,n,r){var i=O,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,a.id=++ji,Z.env,a.env=Te?{Promise:L,PromiseProp:{value:L,configurable:!0,writable:!0},all:L.all,race:L.race,allSettled:L.allSettled,any:L.any,resolve:L.resolve,reject:L.reject}:{},t&&Q(a,t),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=cn(a,e,n,r);return a.ref===0&&a.finalize(),u}function yn(){return De.id||(De.id=++Ut),++De.awaits,De.echoes+=w,De.id}function en(){return De.awaits?(--De.awaits===0&&(De.id=0),De.echoes=De.awaits*w,!0):!1}(""+ye).indexOf("[native code]")===-1&&(yn=en=Se);function Nn(e){return De.echoes&&e&&e.constructor===we?(yn(),e.then(function(t){return en(),t},function(t){return en(),dt(t)})):e}function Fi(e){++Rn,(!De.echoes||--De.echoes===0)&&(De.echoes=De.awaits=De.id=0),jt.push(O),tn(e,!0)}function Mi(){var e=jt[jt.length-1];jt.pop(),tn(e,!1)}function tn(e,t){var n=O;if((t?De.echoes&&(!Gt++||e!==O):Gt&&(!--Gt||e!==O))&&queueMicrotask(t?Fi.bind(null,e):Mi),e!==O&&(O=e,n===Z&&(Z.env=Hr()),Te)){var r=Z.env.Promise,i=e.env;(n.global||e.global)&&(Object.defineProperty(D,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function Hr(){var e=D.Promise;return Te?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(D,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function cn(e,t,n,r,i){var a=O;try{return tn(e,!0),t(n,r,i)}finally{tn(a,!1)}}function Qr(e,t,n,r){return typeof e!="function"?e:function(){var i=O;n&&yn(),tn(t,!0);try{return e.apply(this,arguments)}finally{tn(i,!1),r&&queueMicrotask(en)}}}function cr(e){Promise===we&&De.echoes===0?Gt===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}var dt=L.reject;function fr(e,t,n,r){if(!e.idbdb||!e._state.openComplete&&!O.letThrough&&!e._vip){if(e._state.openComplete)return dt(new ne.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return dt(new ne.DatabaseClosed);e.open().catch(Se)}return e._state.dbReadyPromise.then(function(){return fr(e,t,n,r)})}else{var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(a){return a.name===pt.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return fr(e,t,n,r)})):dt(a)}return i._promise(t,function(a,u){return Zt(function(){return O.trans=i,r(a,u,i)})}).then(function(a){if(t==="readwrite")try{i.idbtrans.commit()}catch(u){}return t==="readonly"?a:i._completion.then(function(){return a})})}}var Xr="4.3.0",fn="\uFFFF",lr=-1/0,Wt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",qr="String expected.",vn=[],Kn="__dbnames",pr="readonly",hr="readwrite";function ln(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Zr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Dn(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=st(t),delete t[e]),t}:function(t){return t}}function ei(){throw ne.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Ne(e,t){try{var n=ti(e),r=ti(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return Ui(ni(e),ni(t));case"Array":return Li(e,t)}}catch(i){}return NaN}function Li(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a){var u=Ne(e[a],t[a]);if(u!==0)return u}return n===r?0:n<r?-1:1}function Ui(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a)if(e[a]!==t[a])return e[a]<t[a]?-1:1;return n===r?0:n<r?-1:1}function ti(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var n=Ze(e);return n==="ArrayBuffer"?"binary":n}function ni(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function jn(e,t,n){var r=e.schema.yProps;return r?(t&&n.numFailures>0&&(t=t.filter(function(i,a){return!n.failures[a]})),Promise.all(r.map(function(i){var a=i.updatesTable;return t?e.db.table(a).where("k").anyOf(t).delete():e.db.table(a).clear()})).then(function(){return n})):n}var _n=(function(){function e(t){this["@@propmod"]=t}return e.prototype.execute=function(t){var n,r=this["@@propmod"];if(r.add!==void 0){var i=r.add;if(m(i))return R(R([],m(t)?t:[],!0),i,!0).sort();if(typeof i=="number")return(Number(t)||0)+i;if(typeof i=="bigint")try{return BigInt(t)+i}catch(f){return BigInt(0)+i}throw new TypeError("Invalid term ".concat(i))}if(r.remove!==void 0){var a=r.remove;if(m(a))return m(t)?t.filter(function(f){return!a.includes(f)}).sort():[];if(typeof a=="number")return Number(t)-a;if(typeof a=="bigint")try{return BigInt(t)-a}catch(f){return BigInt(0)-a}throw new TypeError("Invalid subtrahend ".concat(a))}var u=(n=r.replacePrefix)===null||n===void 0?void 0:n[0];return u&&typeof t=="string"&&t.startsWith(u)?r.replacePrefix[1]+t.substring(u.length):t},e})();function ri(e,t){for(var n=S(t),r=n.length,i=!1,a=0;a<r;++a){var u=n[a],f=t[u],l=Pe(e,u);f instanceof _n?(He(e,u,f.execute(l)),i=!0):l!==f&&(He(e,u,f),i=!0)}return i}var ii=(function(){function e(){}return e.prototype._trans=function(t,n,r){var i=this._tx||O.trans,a=this.name,u=o&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(t==="readonly"?"read":"write"," ").concat(this.name));function f(b,v,C){if(!C.schema[a])throw new ne.NotFound("Table "+a+" not part of transaction");return n(C.idbtrans,C)}var l=ct();try{var h=i&&i.db._novip===this.db._novip?i===O.trans?i._promise(t,f,r):Zt(function(){return i._promise(t,f,r)},{trans:i,transless:O.transless||O}):fr(this.db,t,[this.name],f);return u&&(h._consoleTask=u,h=h.catch(function(b){return console.trace(b),dt(b)})),h}finally{l&&gt()}},e.prototype.get=function(t,n){var r=this;return t&&t.constructor===Object?this.where(t).first(n):t==null?dt(new ne.Type("Invalid argument to Table.get()")):this._trans("readonly",function(i){return r.core.get({trans:i,key:t}).then(function(a){return r.hook.reading.fire(a)})}).then(n)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(m(t))return new this.db.WhereClause(this,"[".concat(t.join("+"),"]"));var n=S(t);if(n.length===1)return this.where(n[0]).equals(t[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(b){if(b.compound&&n.every(function(C){return b.keyPath.indexOf(C)>=0})){for(var v=0;v<n.length;++v)if(n.indexOf(b.keyPath[v])===-1)return!1;return!0}return!1}).sort(function(b,v){return b.keyPath.length-v.keyPath.length})[0];if(r&&this.db._maxKey!==fn){var i=r.keyPath.slice(0,n.length);return this.where(i).equals(i.map(function(b){return t[b]}))}!r&&o&&console.warn("The query ".concat(JSON.stringify(t)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(n.join("+"),"]"));var a=this.schema.idxByName;function u(b,v){return Ne(b,v)===0}var f=n.reduce(function(b,v){var C=b[0],$=b[1],g=a[v],_=t[v];return[C||g,C||!g?ln($,g&&g.multi?function(A){var B=Pe(A,v);return m(B)&&B.some(function(j){return u(_,j)})}:function(A){return u(_,Pe(A,v))}):$]},[null,null]),l=f[0],h=f[1];return l?this.where(l.name).equals(t[l.keyPath]).filter(h):r?this.filter(h):this.where(n).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,m(t)?"[".concat(t.join("+"),"]"):t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){var n=this,r=n.db,i=n.name;this.schema.mappedClass=t,t.prototype instanceof ei&&(t=(function(l){P(h,l);function h(){return l!==null&&l.apply(this,arguments)||this}return Object.defineProperty(h.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),h.prototype.table=function(){return i},h})(t));for(var a=new Set,u=t.prototype;u;u=oe(u))Object.getOwnPropertyNames(u).forEach(function(l){return a.add(l)});var f=function(l){if(!l)return l;var h=Object.create(t.prototype);for(var b in l)if(!a.has(b))try{h[b]=l[b]}catch(v){}return h};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=f,this.hook("reading",f),t},e.prototype.defineClass=function(){function t(n){Q(this,n)}return this.mapToClass(t)},e.prototype.add=function(t,n){var r=this,i=this.schema.primKey,a=i.auto,u=i.keyPath,f=t;return u&&a&&(f=Dn(u)(t)),this._trans("readwrite",function(l){return r.core.mutate({trans:l,type:"add",keys:n!=null?[n]:null,values:[f]})}).then(function(l){return l.numFailures?L.reject(l.failures[0]):l.lastResult}).then(function(l){if(u)try{He(t,u,l)}catch(h){}return l})},e.prototype.upsert=function(t,n){var r=this,i=this.schema.primKey.keyPath;return this._trans("readwrite",function(a){return r.core.get({trans:a,key:t}).then(function(u){var f=u??{};return ri(f,n),i&&He(f,i,t),r.core.mutate({trans:a,type:"put",values:[f],keys:[t],upsert:!0,updates:{keys:[t],changeSpecs:[n]}}).then(function(l){return l.numFailures?L.reject(l.failures[0]):!!u})})})},e.prototype.update=function(t,n){if(typeof t=="object"&&!m(t)){var r=Pe(t,this.schema.primKey.keyPath);return r===void 0?dt(new ne.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(t).modify(n)},e.prototype.put=function(t,n){var r=this,i=this.schema.primKey,a=i.auto,u=i.keyPath,f=t;return u&&a&&(f=Dn(u)(t)),this._trans("readwrite",function(l){return r.core.mutate({trans:l,type:"put",values:[f],keys:n!=null?[n]:null})}).then(function(l){return l.numFailures?L.reject(l.failures[0]):l.lastResult}).then(function(l){if(u)try{He(t,u,l)}catch(h){}return l})},e.prototype.delete=function(t){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[t]}).then(function(i){return jn(n,[t],i)}).then(function(i){return i.numFailures?L.reject(i.failures[0]):void 0})})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"deleteRange",range:Zr}).then(function(r){return jn(t,null,r)})}).then(function(n){return n.numFailures?L.reject(n.failures[0]):void 0})},e.prototype.bulkGet=function(t){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:t,trans:r}).then(function(i){return i.map(function(a){return n.hook.reading.fire(a)})})})},e.prototype.bulkAdd=function(t,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var u=r?r.allKeys:void 0;return this._trans("readwrite",function(f){var l=i.schema.primKey,h=l.auto,b=l.keyPath;if(b&&a)throw new ne.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var v=t.length,C=b&&h?t.map(Dn(b)):t;return i.core.mutate({trans:f,type:"add",keys:a,values:C,wantResults:u}).then(function($){var g=$.numFailures,_=$.results,A=$.lastResult,B=$.failures,j=u?_:A;if(g===0)return j;throw new ie("".concat(i.name,".bulkAdd(): ").concat(g," of ").concat(v," operations failed"),B)})})},e.prototype.bulkPut=function(t,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var u=r?r.allKeys:void 0;return this._trans("readwrite",function(f){var l=i.schema.primKey,h=l.auto,b=l.keyPath;if(b&&a)throw new ne.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var v=t.length,C=b&&h?t.map(Dn(b)):t;return i.core.mutate({trans:f,type:"put",keys:a,values:C,wantResults:u}).then(function($){var g=$.numFailures,_=$.results,A=$.lastResult,B=$.failures,j=u?_:A;if(g===0)return j;throw new ie("".concat(i.name,".bulkPut(): ").concat(g," of ").concat(v," operations failed"),B)})})},e.prototype.bulkUpdate=function(t){var n=this,r=this.core,i=t.map(function(f){return f.key}),a=t.map(function(f){return f.changes}),u=[];return this._trans("readwrite",function(f){return r.getMany({trans:f,keys:i,cache:"clone"}).then(function(l){var h=[],b=[];t.forEach(function(C,$){var g=C.key,_=C.changes,A=l[$];if(A){for(var B=0,j=Object.keys(_);B<j.length;B++){var F=j[B],V=_[F];if(F===n.schema.primKey.keyPath){if(Ne(V,g)!==0)throw new ne.Constraint("Cannot update primary key in bulkUpdate()")}else He(A,F,V)}u.push($),h.push(g),b.push(A)}});var v=h.length;return r.mutate({trans:f,type:"put",keys:h,values:b,updates:{keys:i,changeSpecs:a}}).then(function(C){var $=C.numFailures,g=C.failures;if($===0)return v;for(var _=0,A=Object.keys(g);_<A.length;_++){var B=A[_],j=u[Number(B)];if(j!=null){var F=g[B];delete g[B],g[j]=F}}throw new ie("".concat(n.name,".bulkUpdate(): ").concat($," of ").concat(v," operations failed"),g)})})})},e.prototype.bulkDelete=function(t){var n=this,r=t.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:t}).then(function(a){return jn(n,t,a)})}).then(function(i){var a=i.numFailures,u=i.lastResult,f=i.failures;if(a===0)return u;throw new ie("".concat(n.name,".bulkDelete(): ").concat(a," of ").concat(r," operations failed"),f)})},e})();function Sn(e){var t={},n=function(f,l){if(l){for(var h=arguments.length,b=new Array(h-1);--h;)b[h-1]=arguments[h];return t[f].subscribe.apply(null,b),e}else if(typeof f=="string")return t[f]};n.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return n;function a(f,l,h){if(typeof f=="object")return u(f);l||(l=ue),h||(h=Se);var b={subscribers:[],fire:h,subscribe:function(v){b.subscribers.indexOf(v)===-1&&(b.subscribers.push(v),b.fire=l(b.fire,v))},unsubscribe:function(v){b.subscribers=b.subscribers.filter(function(C){return C!==v}),b.fire=b.subscribers.reduce(l,h)}};return t[f]=n[f]=b,b}function u(f){S(f).forEach(function(l){var h=f[l];if(m(h))a(l,f[l][0],f[l][1]);else if(h==="asap")var b=a(l,bt,function(){for(var C=arguments.length,$=new Array(C);C--;)$[C]=arguments[C];b.subscribers.forEach(function(g){me(function(){g.apply(null,$)})})});else throw new ne.InvalidArgument("Invalid event config")})}}function En(e,t){return be(t).from({prototype:e}),t}function Vi(e){return En(ii.prototype,function(n,r,i){this.db=e,this._tx=i,this.name=n,this.schema=r,this.hook=e._allTables[n]?e._allTables[n].hook:Sn(null,{creating:[ze,Se],reading:[ot,bt],updating:[ut,Se],deleting:[Qe,Se]})})}function mn(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function dr(e,t){e.filter=ln(e.filter,t)}function yr(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return ln(r(),t())}:t,e.justLimit=n&&!r}function $i(e,t){e.isMatch=ln(e.isMatch,t)}function Fn(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new ne.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function ai(e,t,n){var r=Fn(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function Mn(e,t,n,r){var i=e.replayFilter?ln(e.filter,e.replayFilter()):e.filter;if(e.or){var a={},u=function(f,l,h){if(!i||i(l,h,function(C){return l.stop(C)},function(C){return l.fail(C)})){var b=l.primaryKey,v=""+b;v==="[object ArrayBuffer]"&&(v=""+new Uint8Array(b)),z(a,v)||(a[v]=!0,t(f,l,h))}};return Promise.all([e.or._iterate(u,n),oi(ai(e,r,n),e.algorithm,u,!e.keysOnly&&e.valueMapper)])}else return oi(ai(e,r,n),ln(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function oi(e,t,n,r){var i=r?function(u,f,l){return n(r(u),f,l)}:n,a=Le(i);return e.then(function(u){if(u)return u.start(function(){var f=function(){return u.continue()};(!t||t(u,function(l){return f=l},function(l){u.stop(l),f=Se},function(l){u.fail(l),f=Se}))&&a(u.value,u,function(l){return f=l}),f()})})}var zi=(function(){function e(){}return e.prototype._read=function(t,n){var r=this._ctx;return r.error?r.table._trans(null,dt.bind(null,r.error)):r.table._trans("readonly",t).then(n)},e.prototype._write=function(t){var n=this._ctx;return n.error?n.table._trans(null,dt.bind(null,n.error)):n.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var n=this._ctx;n.algorithm=ln(n.algorithm,t)},e.prototype._iterate=function(t,n){return Mn(this._ctx,t,n,this._ctx.table.core)},e.prototype.clone=function(t){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&Q(r,t),n._ctx=r,n},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var n=this._ctx;return this._read(function(r){return Mn(n,t,r,n.table.core)})},e.prototype.count=function(t){var n=this;return this._read(function(r){var i=n._ctx,a=i.table.core;if(mn(i,!0))return a.count({trans:r,query:{index:Fn(i,a.schema),range:i.range}}).then(function(f){return Math.min(f,i.limit)});var u=0;return Mn(i,function(){return++u,!1},r,a).then(function(){return u})}).then(t)},e.prototype.sortBy=function(t,n){var r=t.split(".").reverse(),i=r[0],a=r.length-1;function u(h,b){return b?u(h[r[b]],b-1):h[i]}var f=this._ctx.dir==="next"?1:-1;function l(h,b){var v=u(h,a),C=u(b,a);return Ne(v,C)*f}return this.toArray(function(h){return h.sort(l)}).then(n)},e.prototype.toArray=function(t){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&mn(i,!0)&&i.limit>0){var a=i.valueMapper,u=Fn(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:u,range:i.range}}).then(function(l){var h=l.result;return a?h.map(a):h})}else{var f=[];return Mn(i,function(l){return f.push(l)},r,i.table.core).then(function(){return f})}},t)},e.prototype.offset=function(t){var n=this._ctx;return t<=0?this:(n.offset+=t,mn(n)?yr(n,function(){var r=t;return function(i,a){return r===0?!0:r===1?(--r,!1):(a(function(){i.advance(r),r=0}),!1)}}):yr(n,function(){var r=t;return function(){return--r<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),yr(this._ctx,function(){var n=t;return function(r,i,a){return--n<=0&&i(a),n>=0}},!0),this},e.prototype.until=function(t,n){return dr(this._ctx,function(r,i,a){return t(r.value)?(i(a),n):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(n){return n[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return dr(this._ctx,function(n){return t(n.value)}),$i(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.key,i)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.primaryKey,i)})},e.prototype.keys=function(t){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.key)}).then(function(){return r}).then(t)},e.prototype.primaryKeys=function(t){var n=this._ctx;if(n.dir==="next"&&mn(n,!0)&&n.limit>0)return this._read(function(i){var a=Fn(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:a,range:n.range}})}).then(function(i){var a=i.result;return a}).then(t);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.primaryKey)}).then(function(){return r}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(n){return n[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var r={};return dr(this._ctx,function(i){var a=i.primaryKey.toString(),u=z(r,a);return r[a]=!0,!u}),this},e.prototype.modify=function(t){var n=this,r=this._ctx;return this._write(function(i){var a;typeof t=="function"?a=t:a=function(B){return ri(B,t)};var u=r.table.core,f=u.schema.primaryKey,l=f.outbound,h=f.extractKey,b=200,v=n.db._options.modifyChunkSize;v&&(typeof v=="object"?b=v[u.name]||v["*"]||200:b=v);var C=[],$=0,g=[],_=function(B,j){var F=j.failures,V=j.numFailures;$+=B-V;for(var K=0,H=S(F);K<H.length;K++){var ee=H[K];C.push(F[ee])}},A=t===ui;return n.clone().primaryKeys().then(function(B){var j=mn(r)&&r.limit===1/0&&(typeof t!="function"||A)&&{index:r.index,range:r.range},F=function(V){var K=Math.min(b,B.length-V),H=B.slice(V,V+K);return(A?Promise.resolve([]):u.getMany({trans:i,keys:H,cache:"immutable"})).then(function(ee){var X=[],he=[],xe=l?[]:null,te=A?H:[];if(!A)for(var Ae=0;Ae<K;++Ae){var ve=ee[Ae],je={value:st(ve),primKey:B[V+Ae]};a.call(je,je.value,je)!==!1&&(je.value==null?te.push(B[V+Ae]):!l&&Ne(h(ve),h(je.value))!==0?(te.push(B[V+Ae]),X.push(je.value)):(he.push(je.value),l&&xe.push(B[V+Ae])))}return Promise.resolve(X.length>0&&u.mutate({trans:i,type:"add",values:X}).then(function(fe){for(var ft in fe.failures)te.splice(parseInt(ft),1);_(X.length,fe)})).then(function(){return(he.length>0||j&&typeof t=="object")&&u.mutate({trans:i,type:"put",keys:xe,values:he,criteria:j,changeSpec:typeof t!="function"&&t,isAdditionalChunk:V>0}).then(function(fe){return _(he.length,fe)})}).then(function(){return(te.length>0||j&&A)&&u.mutate({trans:i,type:"delete",keys:te,criteria:j,isAdditionalChunk:V>0}).then(function(fe){return jn(r.table,te,fe)}).then(function(fe){return _(te.length,fe)})}).then(function(){return B.length>V+K&&F(V+b)})})};return F(0).then(function(){if(C.length>0)throw new Ce("Error modifying one or more objects",C,$,g);return B.length})})})},e.prototype.delete=function(){var t=this._ctx,n=t.range;return mn(t)&&!t.table.schema.yProps&&(t.isPrimKey||n.type===3)?this._write(function(r){var i=t.table.core.schema.primaryKey,a=n;return t.table.core.count({trans:r,query:{index:i,range:a}}).then(function(u){return t.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(function(f){var l=f.failures,h=f.numFailures;if(h)throw new Ce("Could not delete some values",Object.keys(l).map(function(b){return l[b]}),u-h);return u-h})})}):this.modify(ui)},e})(),ui=function(e,t){return t.value=null};function Yi(e){return En(zi.prototype,function(n,r){this.db=e;var i=Zr,a=null;if(r)try{i=r()}catch(h){a=h}var u=n._ctx,f=u.table,l=f.hook.reading.fire;this._ctx={table:f,index:u.index,isPrimKey:!u.index||f.schema.primKey.keyPath&&u.index===f.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:a,or:u.or,valueMapper:l!==bt?l:null}})}function Ji(e,t){return e<t?-1:e===t?0:1}function Gi(e,t){return e>t?-1:e===t?0:1}function Dt(e,t,n){var r=e instanceof ci?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function gn(e){return new e.Collection(e,function(){return si("")}).limit(0)}function Wi(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function Hi(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function Qi(e,t,n,r,i,a){for(var u=Math.min(e.length,r.length),f=-1,l=0;l<u;++l){var h=t[l];if(h!==r[l])return i(e[l],n[l])<0?e.substr(0,l)+n[l]+n.substr(l+1):i(e[l],r[l])<0?e.substr(0,l)+r[l]+n.substr(l+1):f>=0?e.substr(0,f)+t[f]+n.substr(f+1):null;i(e[l],h)<0&&(f=l)}return u<r.length&&a==="next"?e+n.substr(e.length):u<e.length&&a==="prev"?e.substr(0,n.length):f<0?null:e.substr(0,f)+r[f]+n.substr(f+1)}function Ln(e,t,n,r){var i,a,u,f,l,h,b,v=n.length;if(!n.every(function(_){return typeof _=="string"}))return Dt(e,qr);function C(_){i=Wi(_),a=Hi(_),u=_==="next"?Ji:Gi;var A=n.map(function(B){return{lower:a(B),upper:i(B)}}).sort(function(B,j){return u(B.lower,j.lower)});f=A.map(function(B){return B.upper}),l=A.map(function(B){return B.lower}),h=_,b=_==="next"?"":r}C("next");var $=new e.Collection(e,function(){return nn(f[0],l[v-1]+r)});$._ondirectionchange=function(_){C(_)};var g=0;return $._addAlgorithm(function(_,A,B){var j=_.key;if(typeof j!="string")return!1;var F=a(j);if(t(F,l,g))return!0;for(var V=null,K=g;K<v;++K){var H=Qi(j,F,f[K],l[K],u,h);H===null&&V===null?g=K+1:(V===null||u(V,H)>0)&&(V=H)}return A(V!==null?function(){_.continue(V+b)}:B),!1}),$}function nn(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function si(e){return{type:1,lower:e,upper:e}}var ci=(function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(t,n)>0||this._cmp(t,n)===0&&(r||i)&&!(r&&i)?gn(this):new this.Collection(this,function(){return nn(t,n,!r,!i)})}catch(a){return Dt(this,Wt)}},e.prototype.equals=function(t){return t==null?Dt(this,Wt):new this.Collection(this,function(){return si(t)})},e.prototype.above=function(t){return t==null?Dt(this,Wt):new this.Collection(this,function(){return nn(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?Dt(this,Wt):new this.Collection(this,function(){return nn(t,void 0,!1)})},e.prototype.below=function(t){return t==null?Dt(this,Wt):new this.Collection(this,function(){return nn(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?Dt(this,Wt):new this.Collection(this,function(){return nn(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?Dt(this,qr):this.between(t,t+fn,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):Ln(this,function(n,r){return n.indexOf(r[0])===0},[t],fn)},e.prototype.equalsIgnoreCase=function(t){return Ln(this,function(n,r){return n===r[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=it.apply($e,arguments);return t.length===0?gn(this):Ln(this,function(n,r){return r.indexOf(n)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=it.apply($e,arguments);return t.length===0?gn(this):Ln(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},t,fn)},e.prototype.anyOf=function(){var t=this,n=it.apply($e,arguments),r=this._cmp;try{n.sort(r)}catch(u){return Dt(this,Wt)}if(n.length===0)return gn(this);var i=new this.Collection(this,function(){return nn(n[0],n[n.length-1])});i._ondirectionchange=function(u){r=u==="next"?t._ascending:t._descending,n.sort(r)};var a=0;return i._addAlgorithm(function(u,f,l){for(var h=u.key;r(h,n[a])>0;)if(++a,a===n.length)return f(l),!1;return r(h,n[a])===0?!0:(f(function(){u.continue(n[a])}),!1)}),i},e.prototype.notEqual=function(t){return this.inAnyRange([[lr,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=it.apply($e,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch(r){return Dt(this,Wt)}var n=t.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[lr,i]]},null);return n.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,n){var r=this,i=this._cmp,a=this._ascending,u=this._descending,f=this._min,l=this._max;if(t.length===0)return gn(this);if(!t.every(function(K){return K[0]!==void 0&&K[1]!==void 0&&a(K[0],K[1])<=0}))return Dt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ne.InvalidArgument);var h=!n||n.includeLowers!==!1,b=n&&n.includeUppers===!0;function v(K,H){for(var ee=0,X=K.length;ee<X;++ee){var he=K[ee];if(i(H[0],he[1])<0&&i(H[1],he[0])>0){he[0]=f(he[0],H[0]),he[1]=l(he[1],H[1]);break}}return ee===X&&K.push(H),K}var C=a;function $(K,H){return C(K[0],H[0])}var g;try{g=t.reduce(v,[]),g.sort($)}catch(K){return Dt(this,Wt)}var _=0,A=b?function(K){return a(K,g[_][1])>0}:function(K){return a(K,g[_][1])>=0},B=h?function(K){return u(K,g[_][0])>0}:function(K){return u(K,g[_][0])>=0};function j(K){return!A(K)&&!B(K)}var F=A,V=new this.Collection(this,function(){return nn(g[0][0],g[g.length-1][1],!h,!b)});return V._ondirectionchange=function(K){K==="next"?(F=A,C=a):(F=B,C=u),g.sort($)},V._addAlgorithm(function(K,H,ee){for(var X=K.key;F(X);)if(++_,_===g.length)return H(ee),!1;return j(X)?!0:(r._cmp(X,g[_][1])===0||r._cmp(X,g[_][0])===0||H(function(){C===a?K.continue(g[_][0]):K.continue(g[_][1])}),!1)}),V},e.prototype.startsWithAnyOf=function(){var t=it.apply($e,arguments);return t.every(function(n){return typeof n=="string"})?t.length===0?gn(this):this.inAnyRange(t.map(function(n){return[n,n+fn]})):Dt(this,"startsWithAnyOf() only works with strings")},e})();function Xi(e){return En(ci.prototype,function(n,r,i){if(this.db=e,this._ctx={table:n,index:r===":id"?null:r,or:i},this._cmp=this._ascending=Ne,this._descending=function(a,u){return Ne(u,a)},this._max=function(a,u){return Ne(a,u)>0?a:u},this._min=function(a,u){return Ne(a,u)<0?a:u},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new ne.MissingAPI})}function zt(e){return Le(function(t){return On(t),e(t.target.error),!1})}function On(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var An="storagemutated",vr="x-storagemutated-1",rn=Sn(null,An),qi=(function(){function e(){}return e.prototype._lock=function(){return lt(!O.global),++this._reculock,this._reculock===1&&!O.global&&(O.lockOwnerFor=this),this},e.prototype._unlock=function(){if(lt(!O.global),--this._reculock===0)for(O.global||(O.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{cn(t[1],t[0])}catch(n){}}return this},e.prototype._locked=function(){return this._reculock&&O.lockOwnerFor!==this},e.prototype.create=function(t){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(lt(!this.idbtrans),!t&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new ne.DatabaseClosed(i);case"MissingAPIError":throw new ne.MissingAPI(i.message,i);default:throw new ne.OpenFailed(i)}if(!this.active)throw new ne.TransactionInactive;return lt(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=Le(function(a){On(a),n._reject(t.error)}),t.onabort=Le(function(a){On(a),n.active&&n._reject(new ne.Abort(t.error)),n.active=!1,n.on("abort").fire(a)}),t.oncomplete=Le(function(){n.active=!1,n._resolve(),"mutatedParts"in t&&rn.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,n,r){var i=this;if(t==="readwrite"&&this.mode!=="readwrite")return dt(new ne.ReadOnly("Transaction is readonly"));if(!this.active)return dt(new ne.TransactionInactive);if(this._locked())return new L(function(u,f){i._blockedFuncs.push([function(){i._promise(t,n,r).then(u,f)},O])});if(r)return Zt(function(){var u=new L(function(f,l){i._lock();var h=n(f,l,i);h&&h.then&&h.then(f,l)});return u.finally(function(){return i._unlock()}),u._lib=!0,u});var a=new L(function(u,f){var l=n(u,f,i);l&&l.then&&l.then(u,f)});return a._lib=!0,a},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var n=this._root(),r=L.resolve(t);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function u(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=u)})()}var a=n._waitingFor;return new L(function(u,f){r.then(function(l){return n._waitingQueue.push(Le(u.bind(null,l)))},function(l){return n._waitingQueue.push(Le(f.bind(null,l)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ne.Abort))},e.prototype.table=function(t){var n=this._memoizedTables||(this._memoizedTables={});if(z(n,t))return n[t];var r=this.schema[t];if(!r)throw new ne.NotFound("Table "+t+" not part of transaction");var i=new this.db.Table(t,r,this);return i.core=this.db.core.table(t),n[t]=i,i},e})();function Zi(e){return En(qi.prototype,function(n,r,i,a,u){var f=this;n!=="readonly"&&r.forEach(function(l){var h,b=(h=i[l])===null||h===void 0?void 0:h.yProps;b&&(r=r.concat(b.map(function(v){return v.updatesTable})))}),this.db=e,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=a,this.idbtrans=null,this.on=Sn(this,"complete","error","abort"),this.parent=u||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new L(function(l,h){f._resolve=l,f._reject=h}),this._completion.then(function(){f.active=!1,f.on.complete.fire()},function(l){var h=f.active;return f.active=!1,f.on.error.fire(l),f.parent?f.parent._reject(l):h&&f.idbtrans&&f.idbtrans.abort(),dt(l)})})}function mr(e,t,n,r,i,a,u,f){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:a,src:(n&&!u?"&":"")+(r?"*":"")+(i?"++":"")+fi(t),type:f}}function fi(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function gr(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:Ye(n,function(r){return[r.name,r]})}}function ea(e){return e.length===1?e[0]:e}var Tn=function(e){try{return e.only([[]]),Tn=function(){return[[]]},[[]]}catch(t){return Tn=function(){return fn},fn}};function br(e){return e==null?function(){}:typeof e=="string"?ta(e):function(t){return Pe(t,e)}}function ta(e){var t=e.split(".");return t.length===1?function(n){return n[e]}:function(n){return Pe(n,e)}}function li(e){return[].slice.call(e)}var na=0;function xn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function ra(e,t,n){function r(v,C){var $=li(v.objectStoreNames);return{schema:{name:v.name,tables:$.map(function(g){return C.objectStore(g)}).map(function(g){var _=g.keyPath,A=g.autoIncrement,B=m(_),j=_==null,F={},V={name:g.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:j,compound:B,keyPath:_,autoIncrement:A,unique:!0,extractKey:br(_)},indexes:li(g.indexNames).map(function(K){return g.index(K)}).map(function(K){var H=K.name,ee=K.unique,X=K.multiEntry,he=K.keyPath,xe=m(he),te={name:H,compound:xe,keyPath:he,unique:ee,multiEntry:X,extractKey:br(he)};return F[xn(he)]=te,te}),getIndexByKeyPath:function(K){return F[xn(K)]}};return F[":id"]=V.primaryKey,_!=null&&(F[xn(_)]=V.primaryKey),V})},hasGetAll:$.length>0&&"getAll"in C.objectStore($[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(v){if(v.type===3)return null;if(v.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var C=v.lower,$=v.upper,g=v.lowerOpen,_=v.upperOpen,A=C===void 0?$===void 0?null:t.upperBound($,!!_):$===void 0?t.lowerBound(C,!!g):t.bound(C,$,!!g,!!_);return A}function a(v){var C=v.name;function $(A){var B=A.trans,j=A.type,F=A.keys,V=A.values,K=A.range;return new Promise(function(H,ee){H=Le(H);var X=B.objectStore(C),he=X.keyPath==null,xe=j==="put"||j==="add";if(!xe&&j!=="delete"&&j!=="deleteRange")throw new Error("Invalid operation type: "+j);var te=(F||V||{length:1}).length;if(F&&V&&F.length!==V.length)throw new Error("Given keys array must have same length as given values array.");if(te===0)return H({numFailures:0,failures:{},results:[],lastResult:void 0});var Ae,ve=[],je=[],fe=0,ft=function(Jt){++fe,On(Jt)};if(j==="deleteRange"){if(K.type===4)return H({numFailures:fe,failures:je,results:[],lastResult:void 0});K.type===3?ve.push(Ae=X.clear()):ve.push(Ae=X.delete(i(K)))}else{var Pt=xe?he?[V,F]:[V,null]:[F,null],Yt=Pt[0],Rt=Pt[1];if(xe)for(var Ft=0;Ft<te;++Ft)ve.push(Ae=Rt&&Rt[Ft]!==void 0?X[j](Yt[Ft],Rt[Ft]):X[j](Yt[Ft])),Ae.onerror=ft;else for(var Ft=0;Ft<te;++Ft)ve.push(Ae=X[j](Yt[Ft])),Ae.onerror=ft}var un=function(Jt){var kn=Jt.target.result;ve.forEach(function(Vt,qn){return Vt.error!=null&&(je[qn]=Vt.error)}),H({numFailures:fe,failures:je,results:j==="delete"?F:ve.map(function(Vt){return Vt.result}),lastResult:kn})};Ae.onerror=function(Jt){ft(Jt),un(Jt)},Ae.onsuccess=un})}function g(A){var B=A.trans,j=A.values,F=A.query,V=A.reverse,K=A.unique;return new Promise(function(H,ee){H=Le(H);var X=F.index,he=F.range,xe=B.objectStore(C),te=X.isPrimaryKey?xe:xe.index(X.name),Ae=V?K?"prevunique":"prev":K?"nextunique":"next",ve=j||!("openKeyCursor"in te)?te.openCursor(i(he),Ae):te.openKeyCursor(i(he),Ae);ve.onerror=zt(ee),ve.onsuccess=Le(function(je){var fe=ve.result;if(!fe){H(null);return}fe.___id=++na,fe.done=!1;var ft=fe.continue.bind(fe),Pt=fe.continuePrimaryKey;Pt&&(Pt=Pt.bind(fe));var Yt=fe.advance.bind(fe),Rt=function(){throw new Error("Cursor not started")},Ft=function(){throw new Error("Cursor not stopped")};fe.trans=B,fe.stop=fe.continue=fe.continuePrimaryKey=fe.advance=Rt,fe.fail=Le(ee),fe.next=function(){var un=this,Jt=1;return this.start(function(){return Jt--?un.continue():un.stop()}).then(function(){return un})},fe.start=function(un){var Jt=new Promise(function(Vt,qn){Vt=Le(Vt),ve.onerror=zt(qn),fe.fail=qn,fe.stop=function(za){fe.stop=fe.continue=fe.continuePrimaryKey=fe.advance=Ft,Vt(za)}}),kn=function(){if(ve.result)try{un()}catch(Vt){fe.fail(Vt)}else fe.done=!0,fe.start=function(){throw new Error("Cursor behind last entry")},fe.stop()};return ve.onsuccess=Le(function(Vt){ve.onsuccess=kn,kn()}),fe.continue=ft,fe.continuePrimaryKey=Pt,fe.advance=Yt,kn(),Jt},H(fe)},ee)})}function _(A){return function(B){return new Promise(function(j,F){j=Le(j);var V=B.trans,K=B.values,H=B.limit,ee=B.query,X=H===1/0?void 0:H,he=ee.index,xe=ee.range,te=V.objectStore(C),Ae=he.isPrimaryKey?te:te.index(he.name),ve=i(xe);if(H===0)return j({result:[]});if(A){var je=K?Ae.getAll(ve,X):Ae.getAllKeys(ve,X);je.onsuccess=function(Yt){return j({result:Yt.target.result})},je.onerror=zt(F)}else{var fe=0,ft=K||!("openKeyCursor"in Ae)?Ae.openCursor(ve):Ae.openKeyCursor(ve),Pt=[];ft.onsuccess=function(Yt){var Rt=ft.result;if(!Rt)return j({result:Pt});if(Pt.push(K?Rt.value:Rt.primaryKey),++fe===H)return j({result:Pt});Rt.continue()},ft.onerror=zt(F)}})}}return{name:C,schema:v,mutate:$,getMany:function(A){var B=A.trans,j=A.keys;return new Promise(function(F,V){F=Le(F);for(var K=B.objectStore(C),H=j.length,ee=new Array(H),X=0,he=0,xe,te=function(fe){var ft=fe.target;(ee[ft._pos]=ft.result)!=null,++he===X&&F(ee)},Ae=zt(V),ve=0;ve<H;++ve){var je=j[ve];je!=null&&(xe=K.get(j[ve]),xe._pos=ve,xe.onsuccess=te,xe.onerror=Ae,++X)}X===0&&F(ee)})},get:function(A){var B=A.trans,j=A.key;return new Promise(function(F,V){F=Le(F);var K=B.objectStore(C),H=K.get(j);H.onsuccess=function(ee){return F(ee.target.result)},H.onerror=zt(V)})},query:_(l),openCursor:g,count:function(A){var B=A.query,j=A.trans,F=B.index,V=B.range;return new Promise(function(K,H){var ee=j.objectStore(C),X=F.isPrimaryKey?ee:ee.index(F.name),he=i(V),xe=he?X.count(he):X.count();xe.onsuccess=Le(function(te){return K(te.target.result)}),xe.onerror=zt(H)})}}}var u=r(e,n),f=u.schema,l=u.hasGetAll,h=f.tables.map(function(v){return a(v)}),b={};return h.forEach(function(v){return b[v.name]=v}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(v){var C=b[v];if(!C)throw new Error("Table '".concat(v,"' not found"));return b[v]},MIN_KEY:-1/0,MAX_KEY:Tn(t),schema:f}}function ia(e,t){return t.reduce(function(n,r){var i=r.create;return y(y({},n),i(n))},e)}function aa(e,t,n,r){var i=n.IDBKeyRange;n.indexedDB;var a=ia(ra(t,i,r),e.dbcore);return{dbcore:a}}function Un(e,t){var n=t.db,r=aa(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach(function(i){var a=i.name;e.core.schema.tables.some(function(u){return u.name===a})&&(i.core=e.core.table(a),e[a]instanceof e.Table&&(e[a].core=i.core))})}function Vn(e,t,n,r){n.forEach(function(i){var a=r[i];t.forEach(function(u){var f=Fe(u,i);(!f||"value"in f&&f.value===void 0)&&(u===e.Transaction.prototype||u instanceof e.Transaction?Ue(u,i,{get:function(){return this.table(i)},set:function(l){qe(this,i,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):u[i]=new e.Table(i,a))})})}function wr(e,t){t.forEach(function(n){for(var r in n)n[r]instanceof e.Table&&delete n[r]})}function oa(e,t){return e._cfg.version-t._cfg.version}function ua(e,t,n,r){var i=e._dbSchema;n.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=gr("$meta",hi("")[0],[]),e._storeNames.push("$meta"));var a=e._createTransaction("readwrite",e._storeNames,i);a.create(n),a._completion.catch(r);var u=a._reject.bind(a),f=O.transless||O;Zt(function(){if(O.trans=a,O.transless=f,t===0)S(i).forEach(function(l){Sr(n,l,i[l].primKey,i[l].indexes)}),Un(e,n),L.follow(function(){return e.on.populate.fire(a)}).catch(u);else return Un(e,n),ca(e,a,t).then(function(l){return fa(e,l,a,n)}).catch(u)})}function sa(e,t){pi(e._dbSchema,t),t.db.version%10===0&&!t.objectStoreNames.contains("$meta")&&t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=zn(e,e.idbdb,t);Yn(e,e._dbSchema,t);for(var r=_r(n,e._dbSchema),i=function(h){if(h.change.length||h.recreate)return console.warn("Unable to patch indexes of table ".concat(h.name," because it has changes on the type of index or primary key.")),{value:void 0};var b=t.objectStore(h.name);h.add.forEach(function(v){o&&console.debug("Dexie upgrade patch: Creating missing index ".concat(h.name,".").concat(v.src)),$n(b,v)})},a=0,u=r.change;a<u.length;a++){var f=u[a],l=i(f);if(typeof l=="object")return l.value}}function ca(e,t,n){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then(function(r){return r??n}):L.resolve(n)}function fa(e,t,n,r){var i=[],a=e._versions,u=e._dbSchema=zn(e,e.idbdb,r),f=a.filter(function(h){return h._cfg.version>=t});if(f.length===0)return L.resolve();f.forEach(function(h){i.push(function(){var b=u,v=h._cfg.dbschema;Yn(e,b,r),Yn(e,v,r),u=e._dbSchema=v;var C=_r(b,v);C.add.forEach(function(j){Sr(r,j[0],j[1].primKey,j[1].indexes)}),C.change.forEach(function(j){if(j.recreate)throw new ne.Upgrade("Not yet support for changing primary key");var F=r.objectStore(j.name);j.add.forEach(function(V){return $n(F,V)}),j.change.forEach(function(V){F.deleteIndex(V.name),$n(F,V)}),j.del.forEach(function(V){return F.deleteIndex(V)})});var $=h._cfg.contentUpgrade;if($&&h._cfg.version>t){Un(e,r),n._memoizedTables={};var g=p(v);C.del.forEach(function(j){g[j]=b[j]}),wr(e,[e.Transaction.prototype]),Vn(e,[e.Transaction.prototype],S(g),g),n.schema=g;var _=k($);_&&yn();var A,B=L.follow(function(){if(A=$(n),A&&_){var j=en.bind(null,null);A.then(j,j)}});return A&&typeof A.then=="function"?L.resolve(A):B.then(function(){return A})}}),i.push(function(b){var v=h._cfg.dbschema;la(v,b),wr(e,[e.Transaction.prototype]),Vn(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}),i.push(function(b){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===h._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(v){return v!=="$meta"})):b.objectStore("$meta").put(h._cfg.version,"version"))})});function l(){return i.length?L.resolve(i.shift()(n.idbtrans)).then(l):L.resolve()}return l().then(function(){pi(u,r)})}function _r(e,t){var n={del:[],add:[],change:[]},r;for(r in e)t[r]||n.del.push(r);for(r in t){var i=e[r],a=t[r];if(!i)n.add.push([r,a]);else{var u={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto)u.recreate=!0,n.change.push(u);else{var f=i.idxByName,l=a.idxByName,h=void 0;for(h in f)l[h]||u.del.push(h);for(h in l){var b=f[h],v=l[h];b?b.src!==v.src&&u.change.push(v):u.add.push(v)}(u.del.length>0||u.add.length>0||u.change.length>0)&&n.change.push(u)}}}return n}function Sr(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(a){return $n(i,a)}),i}function pi(e,t){S(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(o&&console.debug("Dexie: Creating missing table",n),Sr(t,n,e[n].primKey,e[n].indexes))})}function la(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(n){return e[n]==null&&t.db.deleteObjectStore(n)})}function $n(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function zn(e,t,n){var r={},i=tt(t.objectStoreNames,0);return i.forEach(function(a){for(var u=n.objectStore(a),f=u.keyPath,l=mr(fi(f),f||"",!0,!1,!!u.autoIncrement,f&&typeof f!="string",!0),h=[],b=0;b<u.indexNames.length;++b){var v=u.index(u.indexNames[b]);f=v.keyPath;var C=mr(v.name,f,!!v.unique,!!v.multiEntry,!1,f&&typeof f!="string",!1);h.push(C)}r[a]=gr(a,l,h)}),r}function pa(e,t,n){e.verno=t.version/10;var r=e._dbSchema=zn(e,t,n);e._storeNames=tt(t.objectStoreNames,0),Vn(e,[e._allTables],S(r),r)}function ha(e,t){var n=zn(e,e.idbdb,t),r=_r(n,e._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function Yn(e,t,n){for(var r=n.db.objectStoreNames,i=0;i<r.length;++i){var a=r[i],u=n.objectStore(a);e._hasGetAll="getAll"in u;for(var f=0;f<u.indexNames.length;++f){var l=u.indexNames[f],h=u.index(l).keyPath,b=typeof h=="string"?h:"["+tt(h).join("+")+"]";if(t[a]){var v=t[a].idxByName[b];v&&(v.name=l,delete t[a].idxByName[b],t[a].idxByName[l]=v)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&D.WorkerGlobalScope&&D instanceof D.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function hi(e){return e.split(",").map(function(t,n){var r,i=t.split(":"),a=(r=i[1])===null||r===void 0?void 0:r.trim();t=i[0].trim();var u=t.replace(/([&*]|\+\+)/g,""),f=/^\[/.test(u)?u.match(/^\[(.*)\]$/)[1].split("+"):u;return mr(u,f||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),m(f),n===0,a)})}var da=(function(){function e(){}return e.prototype._createTableSchema=function(t,n,r){return gr(t,n,r)},e.prototype._parseIndexSyntax=function(t){return hi(t)},e.prototype._parseStoresSpec=function(t,n){var r=this;S(t).forEach(function(i){if(t[i]!==null){var a=r._parseIndexSyntax(t[i]),u=a.shift();if(!u)throw new ne.Schema("Invalid schema for table "+i+": "+t[i]);if(u.unique=!0,u.multi)throw new ne.Schema("Primary key cannot be multiEntry*");a.forEach(function(l){if(l.auto)throw new ne.Schema("Only primary key can be marked as autoIncrement (++)");if(!l.keyPath)throw new ne.Schema("Index must have a name and cannot be an empty string")});var f=r._createTableSchema(i,u,a);n[i]=f}})},e.prototype.stores=function(t){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?Q(this._cfg.storesSource,t):t;var r=n._versions,i={},a={};return r.forEach(function(u){Q(i,u._cfg.storesSource),a=u._cfg.dbschema={},u._parseStoresSpec(i,a)}),n._dbSchema=a,wr(n,[n._allTables,n,n.Transaction.prototype]),Vn(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],S(a),a),n._storeNames=S(a),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=c(this._cfg.contentUpgrade||Se,t),this},e})();function ya(e){return En(da.prototype,function(n){this.db=e,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function Er(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Ht(Kn,{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function Or(e){return e&&typeof e.databases=="function"}function va(e){var t=e.indexedDB,n=e.IDBKeyRange;return Or(t)?Promise.resolve(t.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==Kn})}):Er(t,n).toCollection().primaryKeys()}function ma(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!Or(n)&&t!==Kn&&Er(n,r).put({name:t}).catch(Se)}function ga(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!Or(n)&&t!==Kn&&Er(n,r).delete(t).catch(Se)}function Ar(e){return Zt(function(){return O.letThrough=!0,e()})}function ba(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};t=setInterval(r,100),r()}).finally(function(){return clearInterval(t)})}var Tr;function xr(e){return!("from"in e)}var xt=function(e,t){if(this)Q(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var n=new xt;return e&&"d"in e&&Q(n,e),n}};le(xt.prototype,(Tr={add:function(e){return Cn(this,e),this},addKey:function(e){return Pn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return Pn(t,n,n)}),this},hasKey:function(e){var t=Jn(this).next(e).value;return t&&Ne(t.from,e)<=0&&Ne(t.to,e)>=0}},Tr[mt]=function(){return Jn(this)},Tr));function Pn(e,t,n){var r=Ne(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(xr(e))return Q(e,{from:t,to:n,d:1});var i=e.l,a=e.r;if(Ne(n,e.from)<0)return i?Pn(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},yi(e);if(Ne(t,e.to)>0)return a?Pn(a,t,n):e.r={from:t,to:n,d:1,l:null,r:null},yi(e);Ne(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),Ne(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var u=!e.r;i&&!e.l&&Cn(e,i),a&&u&&Cn(e,a)}}function Cn(e,t){function n(r,i){var a=i.from,u=i.to,f=i.l,l=i.r;Pn(r,a,u),f&&n(r,f),l&&n(r,l)}xr(t)||n(e,t)}function di(e,t){var n=Jn(t),r=n.next();if(r.done)return!1;for(var i=r.value,a=Jn(e),u=a.next(i.from),f=u.value;!r.done&&!u.done;){if(Ne(f.from,i.to)<=0&&Ne(f.to,i.from)>=0)return!0;Ne(i.from,f.from)<0?i=(r=n.next(f.from)).value:f=(u=a.next(i.from)).value}return!1}function Jn(e){var t=xr(e)?null:{s:0,n:e};return{next:function(n){for(var r=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&Ne(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||Ne(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function yi(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var a=i==="r"?"l":"r",u=y({},e),f=e[i];e.from=f.from,e.to=f.to,e[i]=f[i],u[i]=f[a],e[a]=u,u.d=vi(u)}e.d=vi(e)}function vi(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function Gn(e,t){return S(t).forEach(function(n){e[n]?Cn(e[n],t[n]):e[n]=Ve(t[n])}),e}function Pr(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&di(t[n],e[n])})}var pn={},Cr={},kr=!1;function Wn(e,t){Gn(Cr,e),kr||(kr=!0,setTimeout(function(){kr=!1;var n=Cr;Cr={},Ir(n,!1)},0))}function Ir(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var r=0,i=Object.values(pn);r<i.length;r++){var a=i[r];mi(a,e,n,t)}else for(var u in e){var f=/^idb\:\/\/(.*)\/(.*)\//.exec(u);if(f){var l=f[1],h=f[2],a=pn["idb://".concat(l,"/").concat(h)];a&&mi(a,e,n,t)}}n.forEach(function(b){return b()})}function mi(e,t,n,r){for(var i=[],a=0,u=Object.entries(e.queries.query);a<u.length;a++){for(var f=u[a],l=f[0],h=f[1],b=[],v=0,C=h;v<C.length;v++){var $=C[v];Pr(t,$.obsSet)?$.subscribers.forEach(function(B){return n.add(B)}):r&&b.push($)}r&&i.push([l,b])}if(r)for(var g=0,_=i;g<_.length;g++){var A=_[g],l=A[0],b=A[1];e.queries.query[l]=b}}function wa(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?dt(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,i=Math.round(e.verno*10),a=!1;function u(){if(t.openCanceller!==r)throw new ne.DatabaseClosed("db.open() was cancelled")}var f=t.dbReadyResolve,l=null,h=!1,b=function(){return new L(function(v,C){if(u(),!n)throw new ne.MissingAPI;var $=e.name,g=t.autoSchema||!i?n.open($):n.open($,i);if(!g)throw new ne.MissingAPI;g.onerror=zt(C),g.onblocked=Le(e._fireOnBlocked),g.onupgradeneeded=Le(function(_){if(l=g.transaction,t.autoSchema&&!e._options.allowEmptyDB){g.onerror=On,l.abort(),g.result.close();var A=n.deleteDatabase($);A.onsuccess=A.onerror=Le(function(){C(new ne.NoSuchDatabase("Database ".concat($," doesnt exist")))})}else{l.onerror=zt(C);var B=_.oldVersion>Math.pow(2,62)?0:_.oldVersion;h=B<1,e.idbdb=g.result,a&&sa(e,l),ua(e,B/10,l,C)}},C),g.onsuccess=Le(function(){l=null;var _=e.idbdb=g.result,A=tt(_.objectStoreNames);if(A.length>0)try{var B=_.transaction(ea(A),"readonly");if(t.autoSchema)pa(e,_,B);else if(Yn(e,e._dbSchema,B),!ha(e,B)&&!a)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),_.close(),i=_.version+1,a=!0,v(b());Un(e,B)}catch(j){}vn.push(e),_.onversionchange=Le(function(j){t.vcFired=!0,e.on("versionchange").fire(j)}),_.onclose=Le(function(){e.close({disableAutoOpen:!1})}),h&&ma(e._deps,$),v()},C)}).catch(function(v){switch(v?.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),b();break;case"VersionError":if(i>0)return i=0,b();break}return L.reject(v)})};return L.race([r,(typeof navigator>"u"?L.resolve():ba()).then(b)]).then(function(){return u(),t.onReadyBeingFired=[],L.resolve(Ar(function(){return e.on.ready.fire(e.vip)})).then(function v(){if(t.onReadyBeingFired.length>0){var C=t.onReadyBeingFired.reduce(c,Se);return t.onReadyBeingFired=[],L.resolve(Ar(function(){return C(e.vip)})).then(v)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(v){t.dbOpenError=v;try{l&&l.abort()}catch(C){}return r===t.openCanceller&&e._close(),dt(v)}).finally(function(){t.openComplete=!0,f()}).then(function(){if(h){var v={};e.tables.forEach(function(C){C.schema.indexes.forEach(function($){$.name&&(v["idb://".concat(e.name,"/").concat(C.name,"/").concat($.name)]=new xt(-1/0,[[[]]]))}),v["idb://".concat(e.name,"/").concat(C.name,"/")]=v["idb://".concat(e.name,"/").concat(C.name,"/:dels")]=new xt(-1/0,[[[]]])}),rn(An).fire(v),Ir(v,!0)}return e})}function Br(e){var t=function(u){return e.next(u)},n=function(u){return e.throw(u)},r=a(t),i=a(n);function a(u){return function(f){var l=u(f),h=l.value;return l.done?h:!h||typeof h.then!="function"?m(h)?Promise.all(h).then(r,i):r(h):h.then(r,i)}}return a(t)()}function _a(e,t,n){var r=arguments.length;if(r<2)throw new ne.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var a=I(i);return[e,a,n]}function gi(e,t,n,r,i){return L.resolve().then(function(){var a=O.transless||O,u=e._createTransaction(t,n,e._dbSchema,r);u.explicit=!0;var f={trans:u,transless:a};if(r)u.idbtrans=r.idbtrans;else try{u.create(),u.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(v){return v.name===pt.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return gi(e,t,n,null,i)})):dt(v)}var l=k(i);l&&yn();var h,b=L.follow(function(){if(h=i.call(u,u),h)if(l){var v=en.bind(null,null);h.then(v,v)}else typeof h.next=="function"&&typeof h.throw=="function"&&(h=Br(h))},f);return(h&&typeof h.then=="function"?L.resolve(h).then(function(v){return u.active?v:dt(new ne.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):b.then(function(){return h})).then(function(v){return r&&u._resolve(),u._completion.then(function(){return v})}).catch(function(v){return u._reject(v),dt(v)})})}function Hn(e,t,n){for(var r=m(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}function Sa(e){return y(y({},e),{table:function(t){var n=e.table(t),r=n.schema,i={},a=[];function u(_,A,B){var j=xn(_),F=i[j]=i[j]||[],V=_==null?0:typeof _=="string"?1:_.length,K=A>0,H=y(y({},B),{name:K?"".concat(j,"(virtual-from:").concat(B.name,")"):B.name,lowLevelIndex:B,isVirtual:K,keyTail:A,keyLength:V,extractKey:br(_),unique:!K&&B.unique});if(F.push(H),H.isPrimaryKey||a.push(H),V>1){var ee=V===2?_[0]:_.slice(0,V-1);u(ee,A+1,B)}return F.sort(function(X,he){return X.keyTail-he.keyTail}),H}var f=u(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[f];for(var l=0,h=r.indexes;l<h.length;l++){var b=h[l];u(b.keyPath,0,b)}function v(_){var A=i[xn(_)];return A&&A[0]}function C(_,A){return{type:_.type===1?2:_.type,lower:Hn(_.lower,_.lowerOpen?e.MAX_KEY:e.MIN_KEY,A),lowerOpen:!0,upper:Hn(_.upper,_.upperOpen?e.MIN_KEY:e.MAX_KEY,A),upperOpen:!0}}function $(_){var A=_.query.index;return A.isVirtual?y(y({},_),{query:{index:A.lowLevelIndex,range:C(_.query.range,A.keyTail)}}):_}var g=y(y({},n),{schema:y(y({},r),{primaryKey:f,indexes:a,getIndexByKeyPath:v}),count:function(_){return n.count($(_))},query:function(_){return n.query($(_))},openCursor:function(_){var A=_.query.index,B=A.keyTail,j=A.isVirtual,F=A.keyLength;if(!j)return n.openCursor(_);function V(K){function H(X){X!=null?K.continue(Hn(X,_.reverse?e.MAX_KEY:e.MIN_KEY,B)):_.unique?K.continue(K.key.slice(0,F).concat(_.reverse?e.MIN_KEY:e.MAX_KEY,B)):K.continue()}var ee=Object.create(K,{continue:{value:H},continuePrimaryKey:{value:function(X,he){K.continuePrimaryKey(Hn(X,e.MAX_KEY,B),he)}},primaryKey:{get:function(){return K.primaryKey}},key:{get:function(){var X=K.key;return F===1?X[0]:X.slice(0,F)}},value:{get:function(){return K.value}}});return ee}return n.openCursor($(_)).then(function(K){return K&&V(K)})}});return g}})}var Ea={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Sa};function Rr(e,t,n,r){return n=n||{},r=r||"",S(e).forEach(function(i){if(!z(t,i))n[r+i]=void 0;else{var a=e[i],u=t[i];if(typeof a=="object"&&typeof u=="object"&&a&&u){var f=Ze(a),l=Ze(u);f!==l?n[r+i]=t[i]:f==="Object"?Rr(a,u,n,r+i+"."):a!==u&&(n[r+i]=t[i])}else a!==u&&(n[r+i]=t[i])}}),S(t).forEach(function(i){z(e,i)||(n[r+i]=t[i])}),n}function Nr(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Oa={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return y(y({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey,i=y(y({},n),{mutate:function(a){var u=O.trans,f=u.table(t).hook,l=f.deleting,h=f.creating,b=f.updating;switch(a.type){case"add":if(h.fire===Se)break;return u._promise("readwrite",function(){return v(a)},!0);case"put":if(h.fire===Se&&b.fire===Se)break;return u._promise("readwrite",function(){return v(a)},!0);case"delete":if(l.fire===Se)break;return u._promise("readwrite",function(){return v(a)},!0);case"deleteRange":if(l.fire===Se)break;return u._promise("readwrite",function(){return C(a)},!0)}return n.mutate(a);function v(g){var _=O.trans,A=g.keys||Nr(r,g);if(!A)throw new Error("Keys missing");return g=g.type==="add"||g.type==="put"?y(y({},g),{keys:A}):y({},g),g.type!=="delete"&&(g.values=R([],g.values,!0)),g.keys&&(g.keys=R([],g.keys,!0)),Aa(n,g,A).then(function(B){var j=A.map(function(F,V){var K=B[V],H={onerror:null,onsuccess:null};if(g.type==="delete")l.fire.call(H,F,K,_);else if(g.type==="add"||K===void 0){var ee=h.fire.call(H,F,g.values[V],_);F==null&&ee!=null&&(F=ee,g.keys[V]=F,r.outbound||He(g.values[V],r.keyPath,F))}else{var X=Rr(K,g.values[V]),he=b.fire.call(H,X,F,K,_);if(he){var xe=g.values[V];Object.keys(he).forEach(function(te){z(xe,te)?xe[te]=he[te]:He(xe,te,he[te])})}}return H});return n.mutate(g).then(function(F){for(var V=F.failures,K=F.results,H=F.numFailures,ee=F.lastResult,X=0;X<A.length;++X){var he=K?K[X]:A[X],xe=j[X];he==null?xe.onerror&&xe.onerror(V[X]):xe.onsuccess&&xe.onsuccess(g.type==="put"&&B[X]?g.values[X]:he)}return{failures:V,results:K,numFailures:H,lastResult:ee}}).catch(function(F){return j.forEach(function(V){return V.onerror&&V.onerror(F)}),Promise.reject(F)})})}function C(g){return $(g.trans,g.range,1e4)}function $(g,_,A){return n.query({trans:g,values:!1,query:{index:r,range:_},limit:A}).then(function(B){var j=B.result;return v({type:"delete",keys:j,trans:g}).then(function(F){return F.numFailures>0?Promise.reject(F.failures[0]):j.length<A?{failures:[],numFailures:0,lastResult:void 0}:$(g,y(y({},_),{lower:j[j.length-1],lowerOpen:!0}),A)})})}}});return i}})}};function Aa(e,t,n){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}function bi(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],i=0,a=0;i<t.keys.length&&a<e.length;++i)Ne(t.keys[i],e[a])===0&&(r.push(n?st(t.values[i]):t.values[i]),++a);return r.length===e.length?r:null}catch(u){return null}}var Ta={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return y(y({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=bi(r.keys,r.trans._cache,r.cache==="clone");return i?L.resolve(i):n.getMany(r).then(function(a){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?st(a):a},a})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}};function wi(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function _i(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":return!1;case"getMany":return!1;case"count":return!1;case"openCursor":return!1}}var xa={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new xt(e.MIN_KEY,e.MAX_KEY);return y(y({},e),{transaction:function(r,i,a){if(O.subscr&&i!=="readonly")throw new ne.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(O.querier));return e.transaction(r,i,a)},table:function(r){var i=e.table(r),a=i.schema,u=a.primaryKey,f=a.indexes,l=u.extractKey,h=u.outbound,b=u.autoIncrement&&f.filter(function(g){return g.compound&&g.keyPath.includes(u.keyPath)}),v=y(y({},i),{mutate:function(g){var _,A,B=g.trans,j=g.mutatedParts||(g.mutatedParts={}),F=function(ve){var je="idb://".concat(t,"/").concat(r,"/").concat(ve);return j[je]||(j[je]=new xt)},V=F(""),K=F(":dels"),H=g.type,ee=g.type==="deleteRange"?[g.range]:g.type==="delete"?[g.keys]:g.values.length<50?[Nr(u,g).filter(function(ve){return ve}),g.values]:[],X=ee[0],he=ee[1],xe=g.trans._cache;if(m(X)){V.addKeys(X);var te=H==="delete"||X.length===he.length?bi(X,xe):null;te||K.addKeys(X),(te||he)&&Pa(F,a,te,he)}else if(X){var Ae={from:(_=X.lower)!==null&&_!==void 0?_:e.MIN_KEY,to:(A=X.upper)!==null&&A!==void 0?A:e.MAX_KEY};K.add(Ae),V.add(Ae)}else V.add(n),K.add(n),a.indexes.forEach(function(ve){return F(ve.name).add(n)});return i.mutate(g).then(function(ve){return X&&(g.type==="add"||g.type==="put")&&(V.addKeys(ve.results),b&&b.forEach(function(je){for(var fe=g.values.map(function(Rt){return je.extractKey(Rt)}),ft=je.keyPath.findIndex(function(Rt){return Rt===u.keyPath}),Pt=0,Yt=ve.results.length;Pt<Yt;++Pt)fe[Pt][ft]=ve.results[Pt];F(je.name).addKeys(fe)})),B.mutatedParts=Gn(B.mutatedParts||{},j),ve})}}),C=function(g){var _,A,B=g.query,j=B.index,F=B.range;return[j,new xt((_=F.lower)!==null&&_!==void 0?_:e.MIN_KEY,(A=F.upper)!==null&&A!==void 0?A:e.MAX_KEY)]},$={get:function(g){return[u,new xt(g.key)]},getMany:function(g){return[u,new xt().addKeys(g.keys)]},count:C,query:C,openCursor:C};return S($).forEach(function(g){v[g]=function(_){var A=O.subscr,B=!!A,j=wi(O,i)&&_i(g,_),F=j?_.obsSet={}:A;if(B){var V=function(te){var Ae="idb://".concat(t,"/").concat(r,"/").concat(te);return F[Ae]||(F[Ae]=new xt)},K=V(""),H=V(":dels"),ee=$[g](_),X=ee[0],he=ee[1];if(g==="query"&&X.isPrimaryKey&&!_.values?H.add(he):V(X.name||"").add(he),!X.isPrimaryKey)if(g==="count")H.add(n);else{var xe=g==="query"&&h&&_.values&&i.query(y(y({},_),{values:!1}));return i[g].apply(this,arguments).then(function(te){if(g==="query"){if(h&&_.values)return xe.then(function(fe){var ft=fe.result;return K.addKeys(ft),te});var Ae=_.values?te.result.map(l):te.result;_.values?K.addKeys(Ae):H.addKeys(Ae)}else if(g==="openCursor"){var ve=te,je=_.values;return ve&&Object.create(ve,{key:{get:function(){return H.addKey(ve.primaryKey),ve.key}},primaryKey:{get:function(){var fe=ve.primaryKey;return H.addKey(fe),fe}},value:{get:function(){return je&&K.addKey(ve.primaryKey),ve.value}}})}return te})}}return i[g].apply(this,arguments)}}),v}})}};function Pa(e,t,n,r){function i(a){var u=e(a.name||"");function f(h){return h!=null?a.extractKey(h):null}var l=function(h){return a.multiEntry&&m(h)?h.forEach(function(b){return u.addKey(b)}):u.addKey(h)};(n||r).forEach(function(h,b){var v=n&&f(n[b]),C=r&&f(r[b]);Ne(v,C)!==0&&(v!=null&&l(v),C!=null&&l(C))})}t.indexes.forEach(i)}function Si(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(n.numFailures===r)return null;var i=y({},t);return m(i.keys)&&(i.keys=i.keys.filter(function(a,u){return!(u in n.failures)})),"values"in i&&m(i.values)&&(i.values=i.values.filter(function(a,u){return!(u in n.failures)})),i}function Ca(e,t){return t.lower===void 0?!0:t.lowerOpen?Ne(e,t.lower)>0:Ne(e,t.lower)>=0}function ka(e,t){return t.upper===void 0?!0:t.upperOpen?Ne(e,t.upper)<0:Ne(e,t.upper)<=0}function Kr(e,t){return Ca(e,t)&&ka(e,t)}function Ei(e,t,n,r,i,a){if(!n||n.length===0)return e;var u=t.query.index,f=u.multiEntry,l=t.query.range,h=r.schema.primaryKey,b=h.extractKey,v=u.extractKey,C=(u.lowLevelIndex||u).extractKey,$=n.reduce(function(g,_){var A=g,B=[];if(_.type==="add"||_.type==="put")for(var j=new xt,F=_.values.length-1;F>=0;--F){var V=_.values[F],K=b(V);if(!j.hasKey(K)){var H=v(V);(f&&m(H)?H.some(function(te){return Kr(te,l)}):Kr(H,l))&&(j.addKey(K),B.push(V))}}switch(_.type){case"add":{var ee=new xt().addKeys(t.values?g.map(function(te){return b(te)}):g);A=g.concat(t.values?B.filter(function(te){var Ae=b(te);return ee.hasKey(Ae)?!1:(ee.addKey(Ae),!0)}):B.map(function(te){return b(te)}).filter(function(te){return ee.hasKey(te)?!1:(ee.addKey(te),!0)}));break}case"put":{var X=new xt().addKeys(_.values.map(function(te){return b(te)}));A=g.filter(function(te){return!X.hasKey(t.values?b(te):te)}).concat(t.values?B:B.map(function(te){return b(te)}));break}case"delete":var he=new xt().addKeys(_.keys);A=g.filter(function(te){return!he.hasKey(t.values?b(te):te)});break;case"deleteRange":var xe=_.range;A=g.filter(function(te){return!Kr(b(te),xe)});break}return A},e);return $===e?e:($.sort(function(g,_){return Ne(C(g),C(_))||Ne(b(g),b(_))}),t.limit&&t.limit<1/0&&($.length>t.limit?$.length=t.limit:e.length===t.limit&&$.length<t.limit&&(i.dirty=!0)),a?Object.freeze($):$)}function Oi(e,t){return Ne(e.lower,t.lower)===0&&Ne(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Ia(e,t,n,r){if(e===void 0)return t!==void 0?-1:0;if(t===void 0)return 1;var i=Ne(e,t);if(i===0){if(n&&r)return 0;if(n)return 1;if(r)return-1}return i}function Ba(e,t,n,r){if(e===void 0)return t!==void 0?1:0;if(t===void 0)return-1;var i=Ne(e,t);if(i===0){if(n&&r)return 0;if(n)return-1;if(r)return 1}return i}function Ra(e,t){return Ia(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&Ba(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function Na(e,t,n,r){var i=pn["idb://".concat(e,"/").concat(t)];if(!i)return[];var a=i.queries[n];if(!a)return[null,!1,i,null];var u=r.query?r.query.index.name:null,f=a[u||""];if(!f)return[null,!1,i,null];switch(n){case"query":var l=f.find(function(v){return v.req.limit===r.limit&&v.req.values===r.values&&Oi(v.req.query.range,r.query.range)});if(l)return[l,!0,i,f];var h=f.find(function(v){var C="limit"in v.req?v.req.limit:1/0;return C>=r.limit&&(r.values?v.req.values:!0)&&Ra(v.req.query.range,r.query.range)});return[h,!1,i,f];case"count":var b=f.find(function(v){return Oi(v.req.query.range,r.query.range)});return[b,!!b,i,f]}}function Ka(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){e.subscribers.delete(n),e.subscribers.size===0&&Da(e,t)})}function Da(e,t){setTimeout(function(){e.subscribers.size===0&&de(t,e)},3e3)}var ja={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name,n=y(y({},e),{transaction:function(r,i,a){var u=e.transaction(r,i,a);if(i==="readwrite"){var f=new AbortController,l=f.signal,h=function(b){return function(){if(f.abort(),i==="readwrite"){for(var v=new Set,C=0,$=r;C<$.length;C++){var g=$[C],_=pn["idb://".concat(t,"/").concat(g)];if(_){var A=e.table(g),B=_.optimisticOps.filter(function(je){return je.trans===u});if(u._explicit&&b&&u.mutatedParts)for(var j=0,F=Object.values(_.queries.query);j<F.length;j++)for(var V=F[j],K=0,H=V.slice();K<H.length;K++){var ee=H[K];Pr(ee.obsSet,u.mutatedParts)&&(de(V,ee),ee.subscribers.forEach(function(je){return v.add(je)}))}else if(B.length>0){_.optimisticOps=_.optimisticOps.filter(function(je){return je.trans!==u});for(var X=0,he=Object.values(_.queries.query);X<he.length;X++)for(var V=he[X],xe=0,te=V.slice();xe<te.length;xe++){var ee=te[xe];if(ee.res!=null&&u.mutatedParts)if(b&&!ee.dirty){var Ae=Object.isFrozen(ee.res),ve=Ei(ee.res,ee.req,B,A,ee,Ae);ee.dirty?(de(V,ee),ee.subscribers.forEach(function(ft){return v.add(ft)})):ve!==ee.res&&(ee.res=ve,ee.promise=L.resolve({result:ve}))}else ee.dirty&&de(V,ee),ee.subscribers.forEach(function(ft){return v.add(ft)})}}}}v.forEach(function(je){return je()})}}};u.addEventListener("abort",h(!1),{signal:l}),u.addEventListener("error",h(!1),{signal:l}),u.addEventListener("complete",h(!0),{signal:l})}return u},table:function(r){var i=e.table(r),a=i.schema.primaryKey,u=y(y({},i),{mutate:function(f){var l=O.trans;if(a.outbound||l.db._options.cache==="disabled"||l.explicit||l.idbtrans.mode!=="readwrite")return i.mutate(f);var h=pn["idb://".concat(t,"/").concat(r)];if(!h)return i.mutate(f);var b=i.mutate(f);return(f.type==="add"||f.type==="put")&&(f.values.length>=50||Nr(a,f).some(function(v){return v==null}))?b.then(function(v){var C=y(y({},f),{values:f.values.map(function(g,_){var A;if(v.failures[_])return g;var B=!((A=a.keyPath)===null||A===void 0)&&A.includes(".")?st(g):y({},g);return He(B,a.keyPath,v.results[_]),B})}),$=Si(h,C,v);h.optimisticOps.push($),queueMicrotask(function(){return f.mutatedParts&&Wn(f.mutatedParts)})}):(h.optimisticOps.push(f),f.mutatedParts&&Wn(f.mutatedParts),b.then(function(v){if(v.numFailures>0){de(h.optimisticOps,f);var C=Si(h,f,v);C&&h.optimisticOps.push(C),f.mutatedParts&&Wn(f.mutatedParts)}}),b.catch(function(){de(h.optimisticOps,f),f.mutatedParts&&Wn(f.mutatedParts)})),b},query:function(f){var l;if(!wi(O,i)||!_i("query",f))return i.query(f);var h=((l=O.trans)===null||l===void 0?void 0:l.db._options.cache)==="immutable",b=O,v=b.requery,C=b.signal,$=Na(t,r,"query",f),g=$[0],_=$[1],A=$[2],B=$[3];if(g&&_)g.obsSet=f.obsSet;else{var j=i.query(f).then(function(F){var V=F.result;if(g&&(g.res=V),h){for(var K=0,H=V.length;K<H;++K)Object.freeze(V[K]);Object.freeze(V)}else F.result=st(V);return F}).catch(function(F){return B&&g&&de(B,g),Promise.reject(F)});g={obsSet:f.obsSet,promise:j,subscribers:new Set,type:"query",req:f,dirty:!1},B?B.push(g):(B=[g],A||(A=pn["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),A.queries.query[f.query.index.name||""]=B)}return Ka(g,B,v,C),g.promise.then(function(F){return{result:Ei(F.result,f,A?.optimisticOps,i,g,h)}})}});return u}});return n}};function Qn(e,t){return new Proxy(e,{get:function(n,r,i){return r==="db"?t:Reflect.get(n,r,i)}})}var Ht=(function(){function e(t,n){var r=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=n=y({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var a=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var u={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Se,dbReadyPromise:null,cancelOpen:Se,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:n.autoOpen};u.dbReadyPromise=new L(function(l){u.dbReadyResolve=l}),u.openCanceller=new L(function(l,h){u.cancelOpen=h}),this._state=u,this.name=t,this.on=Sn(this,"populate","blocked","versionchange","close",{ready:[c,Se]}),this.once=function(l,h){var b=function(){for(var v=[],C=0;C<arguments.length;C++)v[C]=arguments[C];r.on(l).unsubscribe(b),h.apply(r,v)};return r.on(l,b)},this.on.ready.subscribe=re(this.on.ready.subscribe,function(l){return function(h,b){e.vip(function(){var v=r._state;if(v.openComplete)v.dbOpenError||L.resolve().then(h),b&&l(h);else if(v.onReadyBeingFired)v.onReadyBeingFired.push(h),b&&l(h);else{l(h);var C=r;b||l(function $(){C.on.ready.unsubscribe(h),C.on.ready.unsubscribe($)})}})}}),this.Collection=Yi(this),this.Table=Vi(this),this.Transaction=Zi(this),this.Version=ya(this),this.WhereClause=Xi(this),this.on("versionchange",function(l){l.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1})}),this.on("blocked",function(l){!l.newVersion||l.newVersion<l.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(l.oldVersion/10))}),this._maxKey=Tn(n.IDBKeyRange),this._createTransaction=function(l,h,b,v){return new r.Transaction(l,h,b,r._options.chromeTransactionDurability,v)},this._fireOnBlocked=function(l){r.on("blocked").fire(l),vn.filter(function(h){return h.name===r.name&&h!==r&&!h._state.vcFired}).map(function(h){return h.on("versionchange").fire(l)})},this.use(Ta),this.use(ja),this.use(xa),this.use(Ea),this.use(Oa);var f=new Proxy(this,{get:function(l,h,b){if(h==="_vip")return!0;if(h==="table")return function(C){return Qn(r.table(C),f)};var v=Reflect.get(l,h,b);return v instanceof ii?Qn(v,f):h==="tables"?v.map(function(C){return Qn(C,f)}):h==="_createTransaction"?function(){var C=v.apply(this,arguments);return Qn(C,f)}:v}});this.vip=f,a.forEach(function(l){return l(r)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new ne.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new ne.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var n=this._versions,r=n.filter(function(i){return i._cfg.version===t})[0];return r||(r=new this.Version(t),n.push(r),n.sort(oa),r.stores({}),this._state.autoSchema=!1,r)},e.prototype._whenReady=function(t){var n=this;return this.idbdb&&(this._state.openComplete||O.letThrough||this._vip)?t():new L(function(r,i){if(n._state.openComplete)return i(new ne.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._state.autoOpen){i(new ne.DatabaseClosed);return}n.open().catch(Se)}n._state.dbReadyPromise.then(r,i)}).then(t)},e.prototype.use=function(t){var n=t.stack,r=t.create,i=t.level,a=t.name;a&&this.unuse({stack:n,name:a});var u=this._middlewares[n]||(this._middlewares[n]=[]);return u.push({stack:n,create:r,level:i??10,name:a}),u.sort(function(f,l){return f.level-l.level}),this},e.prototype.unuse=function(t){var n=t.stack,r=t.name,i=t.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(a){return i?a.create!==i:r?a.name!==r:!1})),this},e.prototype.open=function(){var t=this;return cn(Z,function(){return wa(t)})},e.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var t=this._state,n=vn.indexOf(this);if(n>=0&&vn.splice(n,1),this.idbdb){try{this.idbdb.close()}catch(r){}this.idbdb=null}t.isBeingOpened||(t.dbReadyPromise=new L(function(r){t.dbReadyResolve=r}),t.openCanceller=new L(function(r,i){t.cancelOpen=i}))},e.prototype.close=function(t){var n=t===void 0?{disableAutoOpen:!0}:t,r=n.disableAutoOpen,i=this._state;r?(i.isBeingOpened&&i.cancelOpen(new ne.DatabaseClosed),this._close(),i.autoOpen=!1,i.dbOpenError=new ne.DatabaseClosed):(this._close(),i.autoOpen=this._options.autoOpen||i.isBeingOpened,i.openComplete=!1,i.dbOpenError=null)},e.prototype.delete=function(t){var n=this;t===void 0&&(t={disableAutoOpen:!0});var r=arguments.length>0&&typeof arguments[0]!="object",i=this._state;return new L(function(a,u){var f=function(){n.close(t);var l=n._deps.indexedDB.deleteDatabase(n.name);l.onsuccess=Le(function(){ga(n._deps,n.name),a()}),l.onerror=zt(u),l.onblocked=n._fireOnBlocked};if(r)throw new ne.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(f):f()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return S(this._allTables).map(function(n){return t._allTables[n]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=_a.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,n,r){var i=this,a=O.trans;(!a||a.db!==this||t.indexOf("!")!==-1)&&(a=null);var u=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var f,l;try{if(l=n.map(function(b){var v=b instanceof i.Table?b.name:b;if(typeof v!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return v}),t=="r"||t===pr)f=pr;else if(t=="rw"||t==hr)f=hr;else throw new ne.InvalidArgument("Invalid transaction mode: "+t);if(a){if(a.mode===pr&&f===hr)if(u)a=null;else throw new ne.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a&&l.forEach(function(b){if(a&&a.storeNames.indexOf(b)===-1)if(u)a=null;else throw new ne.SubTransaction("Table "+b+" not included in parent transaction.")}),u&&a&&!a.active&&(a=null)}}catch(b){return a?a._promise(null,function(v,C){C(b)}):dt(b)}var h=gi.bind(null,this,f,l,a,r);return a?a._promise(f,h,"lock"):O.trans?cn(O.transless,function(){return i._whenReady(h)}):this._whenReady(h)},e.prototype.table=function(t){if(!z(this._allTables,t))throw new ne.InvalidTable("Table ".concat(t," does not exist"));return this._allTables[t]},e})(),Fa=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ma=(function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,n,r){return this._subscribe(!t||typeof t=="function"?{next:t,error:n,complete:r}:t)},e.prototype[Fa]=function(){return this},e})(),Xn;try{Xn={indexedDB:D.indexedDB||D.mozIndexedDB||D.webkitIndexedDB||D.msIndexedDB,IDBKeyRange:D.IDBKeyRange||D.webkitIDBKeyRange}}catch(e){Xn={indexedDB:null,IDBKeyRange:null}}function Ai(e){var t=!1,n,r=new Ma(function(i){var a=k(e);function u(B){var j=ct();try{a&&yn();var F=Zt(e,B);return a&&(F=F.finally(en)),F}finally{j&&gt()}}var f=!1,l,h={},b={},v={get closed(){return f},unsubscribe:function(){f||(f=!0,l&&l.abort(),C&&rn.storagemutated.unsubscribe(_))}};i.start&&i.start(v);var C=!1,$=function(){return cr(A)};function g(){return Pr(b,h)}var _=function(B){Gn(h,B),g()&&$()},A=function(){if(!(f||!Xn.indexedDB)){h={};var B={};l&&l.abort(),l=new AbortController;var j={subscr:B,signal:l.signal,requery:$,querier:e,trans:null},F=u(j);Promise.resolve(F).then(function(V){t=!0,n=V,!(f||j.signal.aborted)&&(h={},b=B,!nt(b)&&!C&&(rn(An,_),C=!0),cr(function(){return!f&&i.next&&i.next(V)}))},function(V){t=!1,["DatabaseClosedError","AbortError"].includes(V?.name)||f||cr(function(){f||i.error&&i.error(V)})})}};return setTimeout($,0),v});return r.hasValue=function(){return t},r.getValue=function(){return n},r}var hn=Ht;le(hn,y(y({},Bt),{delete:function(e){var t=new hn(e,{addons:[]});return t.delete()},exists:function(e){return new hn(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return va(hn.dependencies).then(e)}catch(t){return dt(new ne.MissingAPI)}},defineClass:function(){function e(t){Q(this,t)}return e},ignoreTransaction:function(e){return O.trans?cn(O.transless,e):e()},vip:Ar,async:function(e){return function(){try{var t=Br(e.apply(this,arguments));return!t||typeof t.then!="function"?L.resolve(t):t}catch(n){return dt(n)}}},spawn:function(e,t,n){try{var r=Br(e.apply(n,t||[]));return!r||typeof r.then!="function"?L.resolve(r):r}catch(i){return dt(i)}},currentTransaction:{get:function(){return O.trans||null}},waitFor:function(e,t){var n=L.resolve(typeof e=="function"?hn.ignoreTransaction(e):e).timeout(t||6e4);return O.trans?O.trans.waitFor(n):n},Promise:L,debug:{get:function(){return o},set:function(e){s(e)}},derive:be,extend:Q,props:le,override:re,Events:Sn,on:rn,liveQuery:Ai,extendObservabilitySet:Gn,getByKeyPath:Pe,setByKeyPath:He,delByKeyPath:T,shallowClone:p,deepClone:st,getObjectDiff:Rr,cmp:Ne,asap:me,minKey:lr,addons:[],connections:vn,errnames:pt,dependencies:Xn,cache:pn,semVer:Xr,version:Xr.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,n*2)})})),hn.maxKey=Tn(hn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(rn(An,function(e){if(!an){var t;t=new CustomEvent(vr,{detail:e}),an=!0,dispatchEvent(t),an=!1}}),addEventListener(vr,function(e){var t=e.detail;an||Dr(t)}));function Dr(e){var t=an;try{an=!0,rn.storagemutated.fire(e),Ir(e,!0)}finally{an=t}}var an=!1,on,jr=function(){};typeof BroadcastChannel<"u"&&(jr=function(){on=new BroadcastChannel(vr),on.onmessage=function(e){return e.data&&Dr(e.data)}},jr(),typeof on.unref=="function"&&on.unref(),rn(An,function(e){an||on.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!Ht.disableBfCache&&e.persisted){o&&console.debug("Dexie: handling persisted pagehide"),on?.close();for(var t=0,n=vn;t<n.length;t++){var r=n[t];r.close({disableAutoOpen:!1})}}}),addEventListener("pageshow",function(e){!Ht.disableBfCache&&e.persisted&&(o&&console.debug("Dexie: handling persisted pageshow"),jr(),Dr({all:new xt(-1/0,[[]])}))}));function La(e){return new _n({add:e})}function Ua(e){return new _n({remove:e})}function Va(e,t){return new _n({replacePrefix:[e,t]})}L.rejectionMapper=Kt,s(o);var $a=Object.freeze({__proto__:null,Dexie:Ht,Entity:ei,PropModification:_n,RangeSet:xt,add:La,cmp:Ne,default:Ht,liveQuery:Ai,mergeRanges:Cn,rangesOverlap:di,remove:Ua,replacePrefix:Va});return y(Ht,$a,{default:Ht}),Ht})});var Ga=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Fr={randomUUID:Ga};var Mr,Wa=new Uint8Array(16);function Lr(){if(!Mr){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Mr=crypto.getRandomValues.bind(crypto)}return Mr(Wa)}var St=[];for(let x=0;x<256;++x)St.push((x+256).toString(16).slice(1));function xi(x,P=0){return(St[x[P+0]]+St[x[P+1]]+St[x[P+2]]+St[x[P+3]]+"-"+St[x[P+4]]+St[x[P+5]]+"-"+St[x[P+6]]+St[x[P+7]]+"-"+St[x[P+8]]+St[x[P+9]]+"-"+St[x[P+10]]+St[x[P+11]]+St[x[P+12]]+St[x[P+13]]+St[x[P+14]]+St[x[P+15]]).toLowerCase()}function Ha(x,P,y){x=x||{};let R=x.random??x.rng?.()??Lr();if(R.length<16)throw new Error("Random bytes length must be >= 16");if(R[6]=R[6]&15|64,R[8]=R[8]&63|128,P){if(y=y||0,y<0||y+16>P.length)throw new RangeError(`UUID byte range ${y}:${y+15} is out of buffer bounds`);for(let D=0;D<16;++D)P[y+D]=R[D];return P}return xi(R)}function Qa(x,P,y){return Fr.randomUUID&&!P&&!x?Fr.randomUUID():Ha(x,P,y)}var Ur=Qa;var nr=Ja(Pi(),1),Ci=Symbol.for("Dexie"),rr=globalThis[Ci]||(globalThis[Ci]=nr.default);if(nr.default.semVer!==rr.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${nr.default.semVer} and ${rr.semVer}`);var{liveQuery:ki,mergeRanges:wo,rangesOverlap:_o,RangeSet:So,cmp:Eo,Entity:Oo,PropModification:Ao,replacePrefix:To,add:xo,remove:Po,DexieYProvider:Co}=rr;var Et=rr;var ar=function(){return ar=Object.assign||function(P){for(var y,R=1,D=arguments.length;R<D;R++){y=arguments[R];for(var S in y)Object.prototype.hasOwnProperty.call(y,S)&&(P[S]=y[S])}return P},ar.apply(this,arguments)};function sn(x,P,y,R){function D(S){return S instanceof y?S:new y(function(m){m(S)})}return new(y||(y=Promise))(function(S,m){function Q(z){try{E(R.next(z))}catch(le){m(le)}}function oe(z){try{E(R.throw(z))}catch(le){m(le)}}function E(z){z.done?S(z.value):D(z.value).then(Q,oe)}E((R=R.apply(x,P||[])).next())})}function $t(x,P){var y={label:0,sent:function(){if(S[0]&1)throw S[1];return S[1]},trys:[],ops:[]},R,D,S,m;return m={next:Q(0),throw:Q(1),return:Q(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function Q(E){return function(z){return oe([E,z])}}function oe(E){if(R)throw new TypeError("Generator is already executing.");for(;y;)try{if(R=1,D&&(S=E[0]&2?D.return:E[0]?D.throw||((S=D.return)&&S.call(D),0):D.next)&&!(S=S.call(D,E[1])).done)return S;switch(D=0,S&&(E=[E[0]&2,S.value]),E[0]){case 0:case 1:S=E;break;case 4:return y.label++,{value:E[1],done:!1};case 5:y.label++,D=E[1],E=[0];continue;case 7:E=y.ops.pop(),y.trys.pop();continue;default:if(S=y.trys,!(S=S.length>0&&S[S.length-1])&&(E[0]===6||E[0]===2)){y=0;continue}if(E[0]===3&&(!S||E[1]>S[0]&&E[1]<S[3])){y.label=E[1];break}if(E[0]===6&&y.label<S[1]){y.label=S[1],S=E;break}if(S&&y.label<S[2]){y.label=S[2],y.ops.push(E);break}S[2]&&y.ops.pop(),y.trys.pop();continue}E=P.call(x,y)}catch(z){E=[6,z],D=0}finally{R=S=0}if(E[0]&5)throw E[1];return{value:E[0]?E[1]:void 0,done:!0}}}function Xa(x){var P=[x.schema.primKey].concat(x.schema.indexes);return P.map(function(y){return y.src}).join(",")}function qa(x){for(var P={},y=0,R=x.tables;y<R.length;y++){var D=R[y];P[D.name]=D.schema}return P}function Ii(x,P){return new Promise(function(y,R){var D=new FileReader;D.onabort=function(S){return R(new Error("file read aborted"))},D.onerror=function(S){return R(S.target.error)},D.onload=function(S){return y(S.target.result)},P==="binary"?D.readAsArrayBuffer(x):D.readAsText(x)})}function Bi(x,P){if(typeof FileReaderSync>"u")throw new Error("FileReaderSync missing. Reading blobs synchronously requires code to run from within a web worker. Use TSON.encapsulateAsync() to do it from the main thread.");var y=new FileReaderSync,R=P==="binary"?y.readAsArrayBuffer(x):y.readAsText(x);return R}var zr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jr(x,P){return P={exports:{}},x(P,P.exports),P.exports}var ur=Jr(function(x,P){(function(y,R){x.exports=R()})(zr,function(){function y(k){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?y=function(N){return typeof N}:y=function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},y(k)}function R(k,N,U,M,G,_e,Ie){try{var Ce=k[_e](Ie),ie=Ce.value}catch(pt){U(pt);return}Ce.done?N(ie):Promise.resolve(ie).then(M,G)}function D(k){return function(){var N=this,U=arguments;return new Promise(function(M,G){var _e=k.apply(N,U);function Ie(ie){R(_e,M,G,Ie,Ce,"next",ie)}function Ce(ie){R(_e,M,G,Ie,Ce,"throw",ie)}Ie(void 0)})}}function S(k,N){if(!(k instanceof N))throw new TypeError("Cannot call a class as a function")}function m(k,N){for(var U=0;U<N.length;U++){var M=N[U];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(k,M.key,M)}}function Q(k,N,U){return N&&m(k.prototype,N),U&&m(k,U),k}function oe(k,N,U){return N in k?Object.defineProperty(k,N,{value:U,enumerable:!0,configurable:!0,writable:!0}):k[N]=U,k}function E(k,N){var U=Object.keys(k);if(Object.getOwnPropertySymbols){var M=Object.getOwnPropertySymbols(k);N&&(M=M.filter(function(G){return Object.getOwnPropertyDescriptor(k,G).enumerable})),U.push.apply(U,M)}return U}function z(k){for(var N=1;N<arguments.length;N++){var U=arguments[N]!=null?arguments[N]:{};N%2?E(Object(U),!0).forEach(function(M){oe(k,M,U[M])}):Object.getOwnPropertyDescriptors?Object.defineProperties(k,Object.getOwnPropertyDescriptors(U)):E(Object(U)).forEach(function(M){Object.defineProperty(k,M,Object.getOwnPropertyDescriptor(U,M))})}return k}function le(k,N){return be(k)||Fe(k,N)||tt()}function qe(k){return Ue(k)||Ee(k)||vt()}function Ue(k){if(Array.isArray(k)){for(var N=0,U=new Array(k.length);N<k.length;N++)U[N]=k[N];return U}}function be(k){if(Array.isArray(k))return k}function Ee(k){if(Symbol.iterator in Object(k)||Object.prototype.toString.call(k)==="[object Arguments]")return Array.from(k)}function Fe(k,N){if(Symbol.iterator in Object(k)||Object.prototype.toString.call(k)==="[object Arguments]"){var U=[],M=!0,G=!1,_e=void 0;try{for(var Ie=k[Symbol.iterator](),Ce;!(M=(Ce=Ie.next()).done)&&(U.push(Ce.value),!(N&&U.length===N));M=!0);}catch(ie){G=!0,_e=ie}finally{try{!M&&Ie.return!=null&&Ie.return()}finally{if(G)throw _e}}return U}}function vt(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function tt(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var re=function k(N){S(this,k),this.p=new Promise(N)};re.__typeson__type__="TypesonPromise",typeof Symbol<"u"&&(re.prototype[Symbol.toStringTag]="TypesonPromise"),re.prototype.then=function(k,N){var U=this;return new re(function(M,G){U.p.then(function(_e){M(k?k(_e):_e)}).catch(function(_e){return N?N(_e):Promise.reject(_e)}).then(M,G)})},re.prototype.catch=function(k){return this.then(null,k)},re.resolve=function(k){return new re(function(N){N(k)})},re.reject=function(k){return new re(function(N,U){U(k)})},["all","race"].forEach(function(k){re[k]=function(N){return new re(function(U,M){Promise[k](N.map(function(G){return G&&G.constructor&&G.constructor.__typeson__type__==="TypesonPromise"?G.p:G})).then(U,M)})}});var lt={},me=lt.toString,Ye={}.hasOwnProperty,Pe=Object.getPrototypeOf,He=Ye.toString;function T(k,N){return Oe(k)&&typeof k.then=="function"&&(!N||typeof k.catch=="function")}function p(k){return me.call(k).slice(8,-1)}function Y(k,N){if(!k||y(k)!=="object")return!1;var U=Pe(k);if(!U)return N===null;var M=Ye.call(U,"constructor")&&U.constructor;return typeof M!="function"?N===null:N===M||N!==null&&He.call(M)===He.call(N)||typeof N=="function"&&typeof M.__typeson__type__=="string"&&M.__typeson__type__===N.__typeson__type__}function I(k){if(!k||p(k)!=="Object")return!1;var N=Pe(k);return N?Y(k,Object):!0}function Me(k){if(!k||p(k)!=="Object")return!1;var N=Pe(k);return N?Y(k,Object)||Me(N):!0}function Oe(k){return k&&y(k)==="object"}function Ve(k){return k.replace(/~/g,"~0").replace(/\./g,"~1")}function nt(k){return k.replace(/~1/g,".").replace(/~0/g,"~")}function rt(k,N){if(N==="")return k;var U=N.indexOf(".");if(U>-1){var M=k[nt(N.slice(0,U))];return M===void 0?void 0:rt(M,N.slice(U+1))}return k[nt(N)]}function st(k,N,U){if(N==="")return U;var M=N.indexOf(".");if(M>-1){var G=k[nt(N.slice(0,M))];return st(G,N.slice(M+1),U)}return k[nt(N)]=U,k}function yt(k){return k===null?"null":Array.isArray(k)?"array":y(k)}var Xe=Object.keys,Ze=Array.isArray,mt={}.hasOwnProperty,Nt=["type","replaced","iterateIn","iterateUnsetNumeric"];function de(k,N){if(k.keypath==="")return-1;var U=k.keypath.match(/\./g)||0,M=N.keypath.match(/\./g)||0;return U&&(U=U.length),M&&(M=M.length),U>M?-1:U<M?1:k.keypath<N.keypath?-1:k.keypath>N.keypath}var $e=(function(){function k(N){S(this,k),this.options=N,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return Q(k,[{key:"stringify",value:function(U,M,G,_e){_e=z({},this.options,{},_e,{stringification:!0});var Ie=this.encapsulate(U,null,_e);return Ze(Ie)?JSON.stringify(Ie[0],M,G):Ie.then(function(Ce){return JSON.stringify(Ce,M,G)})}},{key:"stringifySync",value:function(U,M,G,_e){return this.stringify(U,M,G,z({throwOnBadSyncType:!0},_e,{sync:!0}))}},{key:"stringifyAsync",value:function(U,M,G,_e){return this.stringify(U,M,G,z({throwOnBadSyncType:!0},_e,{sync:!1}))}},{key:"parse",value:function(U,M,G){return G=z({},this.options,{},G,{parse:!0}),this.revive(JSON.parse(U,M),G)}},{key:"parseSync",value:function(U,M,G){return this.parse(U,M,z({throwOnBadSyncType:!0},G,{sync:!0}))}},{key:"parseAsync",value:function(U,M,G){return this.parse(U,M,z({throwOnBadSyncType:!0},G,{sync:!1}))}},{key:"specialTypeNames",value:function(U,M){var G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return G.returnTypeNames=!0,this.encapsulate(U,M,G)}},{key:"rootTypeName",value:function(U,M){var G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return G.iterateNone=!0,this.encapsulate(U,M,G)}},{key:"encapsulate",value:function(U,M,G){G=z({sync:!0},this.options,{},G);var _e=G,Ie=_e.sync,Ce=this,ie={},pt=[],Ot=[],ne=[],It="cyclic"in G?G.cyclic:!0,Kt=G,Bt=Kt.encapsulateObserver,Se=Qe("",U,It,M||{},ne);function bt(ue){var c=Object.values(ie);if(G.iterateNone)return c.length?c[0]:k.getJSONType(ue);if(c.length){if(G.returnTypeNames)return qe(new Set(c));!ue||!I(ue)||mt.call(ue,"$types")?ue={$:ue,$types:{$:ie}}:ue.$types=ie}else Oe(ue)&&mt.call(ue,"$types")&&(ue={$:ue,$types:!0});return G.returnTypeNames?!1:ue}function ot(ue,c){return Re.apply(this,arguments)}function Re(){return Re=D(regeneratorRuntime.mark(function ue(c,o){var s;return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,Promise.all(o.map(function(J){return J[1].p}));case 2:return s=w.sent,w.next=5,Promise.all(s.map((function(){var J=D(regeneratorRuntime.mark(function W(se){var q,ye,we,Te,Je,ke,Be,Ge,Ke,ge,ht,Z,O,ce;return regeneratorRuntime.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(q=[],ye=o.splice(0,1),we=le(ye,1),Te=we[0],Je=le(Te,7),ke=Je[0],Be=Je[2],Ge=Je[3],Ke=Je[4],ge=Je[5],ht=Je[6],Z=Qe(ke,se,Be,Ge,q,!0,ht),O=Y(Z,re),!(ke&&O)){pe.next=11;break}return pe.next=8,Z.p;case 8:return ce=pe.sent,Ke[ge]=ce,pe.abrupt("return",ot(c,q));case 11:return ke?Ke[ge]=Z:O?c=Z.p:c=Z,pe.abrupt("return",ot(c,q));case 13:case"end":return pe.stop()}},W)}));return function(W){return J.apply(this,arguments)}})()));case 5:return w.abrupt("return",c);case 6:case"end":return w.stop()}},ue)})),Re.apply(this,arguments)}function ze(ue,c,o){Object.assign(ue,c);var s=Nt.map(function(d){var w=ue[d];return delete ue[d],w});o(),Nt.forEach(function(d,w){ue[d]=s[w]})}function Qe(ue,c,o,s,d,w,J){var W,se={},q=y(c),ye=Bt?function(O){var ce=J||s.type||k.getJSONType(c);Bt(Object.assign(O||se,{keypath:ue,value:c,cyclic:o,stateObj:s,promisesData:d,resolvingTypesonPromise:w,awaitingTypesonPromise:Y(c,re)},{type:ce}))}:null;if(["string","boolean","number","undefined"].includes(q))return c===void 0||q==="number"&&(isNaN(c)||c===-1/0||c===1/0)?(s.replaced?W=c:W=ut(ue,c,s,d,!1,w,ye),W!==c&&(se={replaced:W})):W=c,ye&&ye(),W;if(c===null)return ye&&ye(),c;if(o&&!s.iterateIn&&!s.iterateUnsetNumeric&&c&&y(c)==="object"){var we=pt.indexOf(c);if(we<0)o===!0&&(pt.push(c),Ot.push(ue));else return ie[ue]="#",ye&&ye({cyclicKeypath:Ot[we]}),"#"+Ot[we]}var Te=I(c),Je=Ze(c),ke=(Te||Je)&&(!Ce.plainObjectReplacers.length||s.replaced)||s.iterateIn?c:ut(ue,c,s,d,Te||Je,null,ye),Be;if(ke!==c?(W=ke,se={replaced:ke}):ue===""&&Y(c,re)?(d.push([ue,c,o,s,void 0,void 0,s.type]),W=c):Je&&s.iterateIn!=="object"||s.iterateIn==="array"?(Be=new Array(c.length),se={clone:Be}):!["function","symbol"].includes(y(c))&&!("toJSON"in c)&&!Y(c,re)&&!Y(c,Promise)&&!Y(c,ArrayBuffer)||Te||s.iterateIn==="object"?(Be={},s.addLength&&(Be.length=c.length),se={clone:Be}):W=c,ye&&ye(),G.iterateNone)return Be||W;if(!Be)return W;if(s.iterateIn){var Ge=function(ce){var ae={ownKeys:mt.call(c,ce)};ze(s,ae,function(){var pe=ue+(ue?".":"")+Ve(ce),L=Qe(pe,c[ce],!!o,s,d,w);Y(L,re)?d.push([pe,L,!!o,s,Be,ce,s.type]):L!==void 0&&(Be[ce]=L)})};for(var Ke in c)Ge(Ke);ye&&ye({endIterateIn:!0,end:!0})}else Xe(c).forEach(function(O){var ce=ue+(ue?".":"")+Ve(O),ae={ownKeys:!0};ze(s,ae,function(){var pe=Qe(ce,c[O],!!o,s,d,w);Y(pe,re)?d.push([ce,pe,!!o,s,Be,O,s.type]):pe!==void 0&&(Be[O]=pe)})}),ye&&ye({endIterateOwn:!0,end:!0});if(s.iterateUnsetNumeric){for(var ge=c.length,ht=function(ce){if(!(ce in c)){var ae=ue+(ue?".":"")+ce,pe={ownKeys:!1};ze(s,pe,function(){var L=Qe(ae,void 0,!!o,s,d,w);Y(L,re)?d.push([ae,L,!!o,s,Be,ce,s.type]):L!==void 0&&(Be[ce]=L)})}},Z=0;Z<ge;Z++)ht(Z);ye&&ye({endIterateUnsetNumeric:!0,end:!0})}return Be}function ut(ue,c,o,s,d,w,J){for(var W=d?Ce.plainObjectReplacers:Ce.nonplainObjectReplacers,se=W.length;se--;){var q=W[se];if(q.test(c,o)){var ye=q.type;if(Ce.revivers[ye]){var we=ie[ue];ie[ue]=we?[ye].concat(we):ye}if(Object.assign(o,{type:ye,replaced:!0}),(Ie||!q.replaceAsync)&&!q.replace)return J&&J({typeDetected:!0}),Qe(ue,c,It&&"readonly",o,s,w,ye);J&&J({replacing:!0});var Te=Ie||!q.replaceAsync?"replace":"replaceAsync";return Qe(ue,q[Te](c,o),It&&"readonly",o,s,w,ye)}}return c}return ne.length?Ie&&G.throwOnBadSyncType?(function(){throw new TypeError("Sync method requested but async result obtained")})():Promise.resolve(ot(Se,ne)).then(bt):!Ie&&G.throwOnBadSyncType?(function(){throw new TypeError("Async method requested but sync result obtained")})():G.stringification&&Ie?[bt(Se)]:Ie?bt(Se):Promise.resolve(bt(Se))}},{key:"encapsulateSync",value:function(U,M,G){return this.encapsulate(U,M,z({throwOnBadSyncType:!0},G,{sync:!0}))}},{key:"encapsulateAsync",value:function(U,M,G){return this.encapsulate(U,M,z({throwOnBadSyncType:!0},G,{sync:!1}))}},{key:"revive",value:function(U,M){var G=U&&U.$types;if(!G)return U;if(G===!0)return U.$;M=z({sync:!0},this.options,{},M);var _e=M,Ie=_e.sync,Ce=[],ie={},pt=!0;G.$&&I(G.$)&&(U=U.$,G=G.$,pt=!1);var Ot=this;function ne(Re,ze){var Qe=Ot.revivers[Re]||[],ut=le(Qe,1),ue=ut[0];if(!ue)throw new Error("Unregistered type: "+Re);return Ie&&!("revive"in ue)?ze:ue[Ie&&ue.revive?"revive":!Ie&&ue.reviveAsync?"reviveAsync":"revive"](ze,ie)}function It(){var Re=[];if(Object.entries(G).forEach(function(ze){var Qe=le(ze,2),ut=Qe[0],ue=Qe[1];ue!=="#"&&[].concat(ue).forEach(function(c){var o=Ot.revivers[c]||[null,{}],s=le(o,2),d=s[1].plain;d&&(Re.push({keypath:ut,type:c}),delete G[ut])})}),!!Re.length)return Re.sort(de).reduce(function ze(Qe,ut){var ue=ut.keypath,c=ut.type;if(T(Qe))return Qe.then(function(d){return ze(d,{keypath:ue,type:c})});var o=rt(U,ue);if(o=ne(c,o),Y(o,re))return o.then(function(d){var w=st(U,ue,d);w===d&&(U=w)});var s=st(U,ue,o);s===o&&(U=s)},void 0)}var Kt=[];function Bt(Re,ze,Qe,ut,ue){if(!(pt&&Re==="$types")){var c=G[Re],o=Ze(ze);if(o||I(ze)){var s=o?new Array(ze.length):{};for(Xe(ze).forEach(function(we){var Te=Bt(Re+(Re?".":"")+Ve(we),ze[we],Qe||s,s,we),Je=function(Be){return Y(Be,it)?s[we]=void 0:Be!==void 0&&(s[we]=Be),Be};Y(Te,re)?Kt.push(Te.then(function(ke){return Je(ke)})):Je(Te)}),ze=s;Ce.length;){var d=le(Ce[0],4),w=d[0],J=d[1],W=d[2],se=d[3],q=rt(w,J);if(q!==void 0)W[se]=q;else break;Ce.splice(0,1)}}if(!c)return ze;if(c==="#"){var ye=rt(Qe,ze.slice(1));return ye===void 0&&Ce.push([Qe,ze.slice(1),ut,ue]),ye}return[].concat(c).reduce(function we(Te,Je){return Y(Te,re)?Te.then(function(ke){return we(ke,Je)}):ne(Je,Te)},ze)}}function Se(Re){return Y(Re,it)?void 0:Re}var bt=It(),ot;return Y(bt,re)?ot=bt.then(function(){return U}):(ot=Bt("",U,null),Kt.length&&(ot=re.resolve(ot).then(function(Re){return re.all([Re].concat(Kt))}).then(function(Re){var ze=le(Re,1),Qe=ze[0];return Qe}))),T(ot)?Ie&&M.throwOnBadSyncType?(function(){throw new TypeError("Sync method requested but async result obtained")})():Y(ot,re)?ot.p.then(Se):ot:!Ie&&M.throwOnBadSyncType?(function(){throw new TypeError("Async method requested but sync result obtained")})():Ie?Se(ot):Promise.resolve(Se(ot))}},{key:"reviveSync",value:function(U,M){return this.revive(U,z({throwOnBadSyncType:!0},M,{sync:!0}))}},{key:"reviveAsync",value:function(U,M){return this.revive(U,z({throwOnBadSyncType:!0},M,{sync:!1}))}},{key:"register",value:function(U,M){return M=M||{},[].concat(U).forEach(function G(_e){var Ie=this;if(Ze(_e))return _e.map(function(Ce){return G.call(Ie,Ce)});_e&&Xe(_e).forEach(function(Ce){if(Ce==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(k.JSON_TYPES.includes(Ce))throw new TypeError("Plain JSON object types are reserved as type names");var ie=_e[Ce],pt=ie&&ie.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,Ot=pt.filter(function(Qe){return Qe.type===Ce});if(Ot.length&&(pt.splice(pt.indexOf(Ot[0]),1),delete this.revivers[Ce],delete this.types[Ce]),typeof ie=="function"){var ne=ie;ie={test:function(ut){return ut&&ut.constructor===ne},replace:function(ut){return z({},ut)},revive:function(ut){return Object.assign(Object.create(ne.prototype),ut)}}}else if(Ze(ie)){var It=ie,Kt=le(It,3),Bt=Kt[0],Se=Kt[1],bt=Kt[2];ie={test:Bt,replace:Se,revive:bt}}if(!(!ie||!ie.test)){var ot={type:Ce,test:ie.test.bind(ie)};ie.replace&&(ot.replace=ie.replace.bind(ie)),ie.replaceAsync&&(ot.replaceAsync=ie.replaceAsync.bind(ie));var Re=typeof M.fallback=="number"?M.fallback:M.fallback?0:1/0;if(ie.testPlainObjects?this.plainObjectReplacers.splice(Re,0,ot):this.nonplainObjectReplacers.splice(Re,0,ot),ie.revive||ie.reviveAsync){var ze={};ie.revive&&(ze.revive=ie.revive.bind(ie)),ie.reviveAsync&&(ze.reviveAsync=ie.reviveAsync.bind(ie)),this.revivers[Ce]=[ze,{plain:ie.testPlainObjects}]}this.types[Ce]=ie}},this)},this),this}}]),k})(),it=function k(){S(this,k)};return it.__typeson__type__="TypesonUndefined",$e.Undefined=it,$e.Promise=re,$e.isThenable=T,$e.toStringTag=p,$e.hasConstructorOf=Y,$e.isObject=Oe,$e.isPlainObject=I,$e.isUserObject=Me,$e.escapeKeyPathComponent=Ve,$e.unescapeKeyPathComponent=nt,$e.getByKeyPath=rt,$e.getJSONType=yt,$e.JSON_TYPES=["null","boolean","number","string","array","object"],$e})}),Za=Jr(function(x,P){(function(y,R){x.exports=R()})(zr,function(){function y(c){return(y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(c)}function R(c,o){if(!(c instanceof o))throw new TypeError("Cannot call a class as a function")}function D(c,o){for(var s=0;s<o.length;s++){var d=o[s];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}function S(c,o,s){return o in c?Object.defineProperty(c,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):c[o]=s,c}function m(c,o){var s=Object.keys(c);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(c);o&&(d=d.filter(function(w){return Object.getOwnPropertyDescriptor(c,w).enumerable})),s.push.apply(s,d)}return s}function Q(c){return(function(s){if(Array.isArray(s))return oe(s)})(c)||(function(s){if(typeof Symbol<"u"&&Symbol.iterator in Object(s))return Array.from(s)})(c)||(function(s,d){if(s){if(typeof s=="string")return oe(s,d);var w=Object.prototype.toString.call(s).slice(8,-1);if(w==="Object"&&s.constructor&&(w=s.constructor.name),w==="Map"||w==="Set")return Array.from(s);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return oe(s,d)}})(c)||(function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function oe(c,o){(o==null||o>c.length)&&(o=c.length);for(var s=0,d=new Array(o);s<o;s++)d[s]=c[s];return d}function E(c){return(E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(c)}function z(c,o){if(!(c instanceof o))throw new TypeError("Cannot call a class as a function")}function le(c,o){for(var s=0;s<o.length;s++){var d=o[s];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}function qe(c,o,s){return o in c?Object.defineProperty(c,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):c[o]=s,c}function Ue(c,o){var s=Object.keys(c);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(c);o&&(d=d.filter(function(w){return Object.getOwnPropertyDescriptor(c,w).enumerable})),s.push.apply(s,d)}return s}function be(c){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?Ue(Object(s),!0).forEach(function(d){qe(c,d,s[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(s)):Ue(Object(s)).forEach(function(d){Object.defineProperty(c,d,Object.getOwnPropertyDescriptor(s,d))})}return c}function Ee(c,o){return(function(d){if(Array.isArray(d))return d})(c)||(function(d,w){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(d)))){var J=[],W=!0,se=!1,q=void 0;try{for(var ye,we=d[Symbol.iterator]();!(W=(ye=we.next()).done)&&(J.push(ye.value),!w||J.length!==w);W=!0);}catch(Te){se=!0,q=Te}finally{try{W||we.return==null||we.return()}finally{if(se)throw q}}return J}})(c,o)||vt(c,o)||(function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function Fe(c){return(function(s){if(Array.isArray(s))return tt(s)})(c)||(function(s){if(typeof Symbol<"u"&&Symbol.iterator in Object(s))return Array.from(s)})(c)||vt(c)||(function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function vt(c,o){if(c){if(typeof c=="string")return tt(c,o);var s=Object.prototype.toString.call(c).slice(8,-1);return s==="Object"&&c.constructor&&(s=c.constructor.name),s==="Map"||s==="Set"?Array.from(c):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?tt(c,o):void 0}}function tt(c,o){(o==null||o>c.length)&&(o=c.length);for(var s=0,d=new Array(o);s<o;s++)d[s]=c[s];return d}var re=function c(o){z(this,c),this.p=new Promise(o)};re.__typeson__type__="TypesonPromise",typeof Symbol<"u"&&(re.prototype[Symbol.toStringTag]="TypesonPromise"),re.prototype.then=function(c,o){var s=this;return new re(function(d,w){s.p.then(function(J){d(c?c(J):J)}).catch(function(J){return o?o(J):Promise.reject(J)}).then(d,w)})},re.prototype.catch=function(c){return this.then(null,c)},re.resolve=function(c){return new re(function(o){o(c)})},re.reject=function(c){return new re(function(o,s){s(c)})},["all","race"].forEach(function(c){re[c]=function(o){return new re(function(s,d){Promise[c](o.map(function(w){return w&&w.constructor&&w.constructor.__typeson__type__==="TypesonPromise"?w.p:w})).then(s,d)})}});var lt={}.toString,me={}.hasOwnProperty,Ye=Object.getPrototypeOf,Pe=me.toString;function He(c,o){return I(c)&&typeof c.then=="function"&&(!o||typeof c.catch=="function")}function T(c){return lt.call(c).slice(8,-1)}function p(c,o){if(!c||E(c)!=="object")return!1;var s=Ye(c);if(!s)return o===null;var d=me.call(s,"constructor")&&s.constructor;return typeof d!="function"?o===null:o===d||o!==null&&Pe.call(d)===Pe.call(o)||typeof o=="function"&&typeof d.__typeson__type__=="string"&&d.__typeson__type__===o.__typeson__type__}function Y(c){return!(!c||T(c)!=="Object")&&(!Ye(c)||p(c,Object))}function I(c){return c&&E(c)==="object"}function Me(c){return c.replace(/~/g,"~0").replace(/\./g,"~1")}function Oe(c){return c.replace(/~1/g,".").replace(/~0/g,"~")}function Ve(c,o){if(o==="")return c;var s=o.indexOf(".");if(s>-1){var d=c[Oe(o.slice(0,s))];return d===void 0?void 0:Ve(d,o.slice(s+1))}return c[Oe(o)]}function nt(c,o,s){if(o==="")return s;var d=o.indexOf(".");return d>-1?nt(c[Oe(o.slice(0,d))],o.slice(d+1),s):(c[Oe(o)]=s,c)}function rt(c,o,s){return s?o?o(c):c:(c&&c.then||(c=Promise.resolve(c)),o?c.then(o):c)}var st=Object.keys,yt=Array.isArray,Xe={}.hasOwnProperty,Ze=["type","replaced","iterateIn","iterateUnsetNumeric"];function mt(c){return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];try{return Promise.resolve(c.apply(this,o))}catch(d){return Promise.reject(d)}}}function Nt(c,o){if(c.keypath==="")return-1;var s=c.keypath.match(/\./g)||0,d=o.keypath.match(/\./g)||0;return s&&(s=s.length),d&&(d=d.length),s>d?-1:s<d?1:c.keypath<o.keypath?-1:c.keypath>o.keypath}var de=(function(){function c(o){z(this,c),this.options=o,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return(function(s,d,w){return d&&le(s.prototype,d),w&&le(s,w),s})(c,[{key:"stringify",value:function(s,d,w,J){J=be(be(be({},this.options),J),{},{stringification:!0});var W=this.encapsulate(s,null,J);return yt(W)?JSON.stringify(W[0],d,w):W.then(function(se){return JSON.stringify(se,d,w)})}},{key:"stringifySync",value:function(s,d,w,J){return this.stringify(s,d,w,be(be({throwOnBadSyncType:!0},J),{},{sync:!0}))}},{key:"stringifyAsync",value:function(s,d,w,J){return this.stringify(s,d,w,be(be({throwOnBadSyncType:!0},J),{},{sync:!1}))}},{key:"parse",value:function(s,d,w){return w=be(be(be({},this.options),w),{},{parse:!0}),this.revive(JSON.parse(s,d),w)}},{key:"parseSync",value:function(s,d,w){return this.parse(s,d,be(be({throwOnBadSyncType:!0},w),{},{sync:!0}))}},{key:"parseAsync",value:function(s,d,w){return this.parse(s,d,be(be({throwOnBadSyncType:!0},w),{},{sync:!1}))}},{key:"specialTypeNames",value:function(s,d){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return w.returnTypeNames=!0,this.encapsulate(s,d,w)}},{key:"rootTypeName",value:function(s,d){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return w.iterateNone=!0,this.encapsulate(s,d,w)}},{key:"encapsulate",value:function(s,d,w){var J=mt(function(Z,O){return rt(Promise.all(O.map(function(ce){return ce[1].p})),function(ce){return rt(Promise.all(ce.map(mt(function(ae){var pe=!1,L=[],wt=Ee(O.splice(0,1),1),at=Ee(wt[0],7),_t=at[0],At=at[2],We=at[3],Tt=at[4],et=at[5],Ct=at[6],ct=ge(_t,ae,At,We,L,!0,Ct),gt=p(ct,re);return(function(wn,dn){var Xt=wn();return Xt&&Xt.then?Xt.then(dn):dn(Xt)})(function(){if(_t&&gt)return rt(ct.p,function(kt){return Tt[et]=kt,pe=!0,J(Z,L)})},function(kt){return pe?kt:(_t?Tt[et]=ct:Z=gt?ct.p:ct,J(Z,L))})}))),function(){return Z})})}),W=(w=be(be({sync:!0},this.options),w)).sync,se=this,q={},ye=[],we=[],Te=[],Je=!("cyclic"in w)||w.cyclic,ke=w.encapsulateObserver,Be=ge("",s,Je,d||{},Te);function Ge(Z){var O=Object.values(q);if(w.iterateNone)return O.length?O[0]:c.getJSONType(Z);if(O.length){if(w.returnTypeNames)return Fe(new Set(O));Z&&Y(Z)&&!Xe.call(Z,"$types")?Z.$types=q:Z={$:Z,$types:{$:q}}}else I(Z)&&Xe.call(Z,"$types")&&(Z={$:Z,$types:!0});return!w.returnTypeNames&&Z}function Ke(Z,O,ce){Object.assign(Z,O);var ae=Ze.map(function(pe){var L=Z[pe];return delete Z[pe],L});ce(),Ze.forEach(function(pe,L){Z[pe]=ae[L]})}function ge(Z,O,ce,ae,pe,L,wt){var at,_t={},At=E(O),We=ke?function(Le){var De=wt||ae.type||c.getJSONType(O);ke(Object.assign(Le||_t,{keypath:Z,value:O,cyclic:ce,stateObj:ae,promisesData:pe,resolvingTypesonPromise:L,awaitingTypesonPromise:p(O,re)},{type:De}))}:null;if(["string","boolean","number","undefined"].includes(At))return O===void 0||Number.isNaN(O)||O===Number.NEGATIVE_INFINITY||O===Number.POSITIVE_INFINITY?(at=ae.replaced?O:ht(Z,O,ae,pe,!1,L,We))!==O&&(_t={replaced:at}):at=O,We&&We(),at;if(O===null)return We&&We(),O;if(ce&&!ae.iterateIn&&!ae.iterateUnsetNumeric&&O&&E(O)==="object"){var Tt=ye.indexOf(O);if(!(Tt<0))return q[Z]="#",We&&We({cyclicKeypath:we[Tt]}),"#"+we[Tt];ce===!0&&(ye.push(O),we.push(Z))}var et,Ct=Y(O),ct=yt(O),gt=(Ct||ct)&&(!se.plainObjectReplacers.length||ae.replaced)||ae.iterateIn?O:ht(Z,O,ae,pe,Ct||ct,null,We);if(gt!==O?(at=gt,_t={replaced:gt}):Z===""&&p(O,re)?(pe.push([Z,O,ce,ae,void 0,void 0,ae.type]),at=O):ct&&ae.iterateIn!=="object"||ae.iterateIn==="array"?(et=new Array(O.length),_t={clone:et}):(["function","symbol"].includes(E(O))||"toJSON"in O||p(O,re)||p(O,Promise)||p(O,ArrayBuffer))&&!Ct&&ae.iterateIn!=="object"?at=O:(et={},ae.addLength&&(et.length=O.length),_t={clone:et}),We&&We(),w.iterateNone)return et||at;if(!et)return at;if(ae.iterateIn){var kt=function(De){var Ut={ownKeys:Xe.call(O,De)};Ke(ae,Ut,function(){var jt=Z+(Z?".":"")+Me(De),Gt=ge(jt,O[De],!!ce,ae,pe,L);p(Gt,re)?pe.push([jt,Gt,!!ce,ae,et,De,ae.type]):Gt!==void 0&&(et[De]=Gt)})};for(var wn in O)kt(wn);We&&We({endIterateIn:!0,end:!0})}else st(O).forEach(function(Le){var De=Z+(Z?".":"")+Me(Le);Ke(ae,{ownKeys:!0},function(){var Ut=ge(De,O[Le],!!ce,ae,pe,L);p(Ut,re)?pe.push([De,Ut,!!ce,ae,et,Le,ae.type]):Ut!==void 0&&(et[Le]=Ut)})}),We&&We({endIterateOwn:!0,end:!0});if(ae.iterateUnsetNumeric){for(var dn=O.length,Xt=function(De){if(!(De in O)){var Ut=Z+(Z?".":"")+De;Ke(ae,{ownKeys:!1},function(){var jt=ge(Ut,void 0,!!ce,ae,pe,L);p(jt,re)?pe.push([Ut,jt,!!ce,ae,et,De,ae.type]):jt!==void 0&&(et[De]=jt)})}},qt=0;qt<dn;qt++)Xt(qt);We&&We({endIterateUnsetNumeric:!0,end:!0})}return et}function ht(Z,O,ce,ae,pe,L,wt){for(var at=pe?se.plainObjectReplacers:se.nonplainObjectReplacers,_t=at.length;_t--;){var At=at[_t];if(At.test(O,ce)){var We=At.type;if(se.revivers[We]){var Tt=q[Z];q[Z]=Tt?[We].concat(Tt):We}return Object.assign(ce,{type:We,replaced:!0}),!W&&At.replaceAsync||At.replace?(wt&&wt({replacing:!0}),ge(Z,At[W||!At.replaceAsync?"replace":"replaceAsync"](O,ce),Je&&"readonly",ce,ae,L,We)):(wt&&wt({typeDetected:!0}),ge(Z,O,Je&&"readonly",ce,ae,L,We))}}return O}return Te.length?W&&w.throwOnBadSyncType?(function(){throw new TypeError("Sync method requested but async result obtained")})():Promise.resolve(J(Be,Te)).then(Ge):!W&&w.throwOnBadSyncType?(function(){throw new TypeError("Async method requested but sync result obtained")})():w.stringification&&W?[Ge(Be)]:W?Ge(Be):Promise.resolve(Ge(Be))}},{key:"encapsulateSync",value:function(s,d,w){return this.encapsulate(s,d,be(be({throwOnBadSyncType:!0},w),{},{sync:!0}))}},{key:"encapsulateAsync",value:function(s,d,w){return this.encapsulate(s,d,be(be({throwOnBadSyncType:!0},w),{},{sync:!1}))}},{key:"revive",value:function(s,d){var w=s&&s.$types;if(!w)return s;if(w===!0)return s.$;var J=(d=be(be({sync:!0},this.options),d)).sync,W=[],se={},q=!0;w.$&&Y(w.$)&&(s=s.$,w=w.$,q=!1);var ye=this;function we(Ge,Ke){var ge=Ee(ye.revivers[Ge]||[],1)[0];if(!ge)throw new Error("Unregistered type: "+Ge);return J&&!("revive"in ge)?Ke:ge[J&&ge.revive?"revive":!J&&ge.reviveAsync?"reviveAsync":"revive"](Ke,se)}var Te=[];function Je(Ge){return p(Ge,$e)?void 0:Ge}var ke,Be=(function(){var Ke=[];if(Object.entries(w).forEach(function(ge){var ht=Ee(ge,2),Z=ht[0],O=ht[1];O!=="#"&&[].concat(O).forEach(function(ce){Ee(ye.revivers[ce]||[null,{}],2)[1].plain&&(Ke.push({keypath:Z,type:ce}),delete w[Z])})}),Ke.length)return Ke.sort(Nt).reduce(function ge(ht,Z){var O=Z.keypath,ce=Z.type;if(He(ht))return ht.then(function(L){return ge(L,{keypath:O,type:ce})});var ae=Ve(s,O);if(p(ae=we(ce,ae),re))return ae.then(function(L){var wt=nt(s,O,L);wt===L&&(s=wt)});var pe=nt(s,O,ae);pe===ae&&(s=pe)},void 0)})();return p(Be,re)?ke=Be.then(function(){return s}):(ke=(function Ge(Ke,ge,ht,Z,O){if(!q||Ke!=="$types"){var ce=w[Ke],ae=yt(ge);if(ae||Y(ge)){var pe=ae?new Array(ge.length):{};for(st(ge).forEach(function(et){var Ct=Ge(Ke+(Ke?".":"")+Me(et),ge[et],ht||pe,pe,et),ct=function(kt){return p(kt,$e)?pe[et]=void 0:kt!==void 0&&(pe[et]=kt),kt};p(Ct,re)?Te.push(Ct.then(function(gt){return ct(gt)})):ct(Ct)}),ge=pe;W.length;){var L=Ee(W[0],4),wt=L[0],at=L[1],_t=L[2],At=L[3],We=Ve(wt,at);if(We===void 0)break;_t[At]=We,W.splice(0,1)}}if(!ce)return ge;if(ce==="#"){var Tt=Ve(ht,ge.slice(1));return Tt===void 0&&W.push([ht,ge.slice(1),Z,O]),Tt}return[].concat(ce).reduce(function et(Ct,ct){return p(Ct,re)?Ct.then(function(gt){return et(gt,ct)}):we(ct,Ct)},ge)}})("",s,null),Te.length&&(ke=re.resolve(ke).then(function(Ge){return re.all([Ge].concat(Te))}).then(function(Ge){return Ee(Ge,1)[0]}))),He(ke)?J&&d.throwOnBadSyncType?(function(){throw new TypeError("Sync method requested but async result obtained")})():p(ke,re)?ke.p.then(Je):ke:!J&&d.throwOnBadSyncType?(function(){throw new TypeError("Async method requested but sync result obtained")})():J?Je(ke):Promise.resolve(Je(ke))}},{key:"reviveSync",value:function(s,d){return this.revive(s,be(be({throwOnBadSyncType:!0},d),{},{sync:!0}))}},{key:"reviveAsync",value:function(s,d){return this.revive(s,be(be({throwOnBadSyncType:!0},d),{},{sync:!1}))}},{key:"register",value:function(s,d){return d=d||{},[].concat(s).forEach(function w(J){var W=this;if(yt(J))return J.map(function(se){return w.call(W,se)});J&&st(J).forEach(function(se){if(se==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(c.JSON_TYPES.includes(se))throw new TypeError("Plain JSON object types are reserved as type names");var q=J[se],ye=q&&q.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,we=ye.filter(function(Ke){return Ke.type===se});if(we.length&&(ye.splice(ye.indexOf(we[0]),1),delete this.revivers[se],delete this.types[se]),typeof q=="function"){var Te=q;q={test:function(ge){return ge&&ge.constructor===Te},replace:function(ge){return be({},ge)},revive:function(ge){return Object.assign(Object.create(Te.prototype),ge)}}}else if(yt(q)){var Je=Ee(q,3);q={test:Je[0],replace:Je[1],revive:Je[2]}}if(q&&q.test){var ke={type:se,test:q.test.bind(q)};q.replace&&(ke.replace=q.replace.bind(q)),q.replaceAsync&&(ke.replaceAsync=q.replaceAsync.bind(q));var Be=typeof d.fallback=="number"?d.fallback:d.fallback?0:Number.POSITIVE_INFINITY;if(q.testPlainObjects?this.plainObjectReplacers.splice(Be,0,ke):this.nonplainObjectReplacers.splice(Be,0,ke),q.revive||q.reviveAsync){var Ge={};q.revive&&(Ge.revive=q.revive.bind(q)),q.reviveAsync&&(Ge.reviveAsync=q.reviveAsync.bind(q)),this.revivers[se]=[Ge,{plain:q.testPlainObjects}]}this.types[se]=q}},this)},this),this}}]),c})(),$e=function c(){z(this,c)};$e.__typeson__type__="TypesonUndefined",de.Undefined=$e,de.Promise=re,de.isThenable=He,de.toStringTag=T,de.hasConstructorOf=p,de.isObject=I,de.isPlainObject=Y,de.isUserObject=function c(o){if(!o||T(o)!=="Object")return!1;var s=Ye(o);return!s||p(o,Object)||c(s)},de.escapeKeyPathComponent=Me,de.unescapeKeyPathComponent=Oe,de.getByKeyPath=Ve,de.getJSONType=function(o){return o===null?"null":Array.isArray(o)?"array":E(o)},de.JSON_TYPES=["null","boolean","number","string","array","object"];for(var it={userObject:{test:function(o,s){return de.isUserObject(o)},replace:function(o){return(function(d){for(var w=1;w<arguments.length;w++){var J=arguments[w]!=null?arguments[w]:{};w%2?m(Object(J),!0).forEach(function(W){S(d,W,J[W])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(J)):m(Object(J)).forEach(function(W){Object.defineProperty(d,W,Object.getOwnPropertyDescriptor(J,W))})}return d})({},o)},revive:function(o){return o}}},k=[{arrayNonindexKeys:{testPlainObjects:!0,test:function(o,s){return!!Array.isArray(o)&&(Object.keys(o).some(function(d){return String(Number.parseInt(d))!==d})&&(s.iterateIn="object",s.addLength=!0),!0)},replace:function(o,s){return s.iterateUnsetNumeric=!0,o},revive:function(o){if(Array.isArray(o))return o;var s=[];return Object.keys(o).forEach(function(d){var w=o[d];s[d]=w}),s}}},{sparseUndefined:{test:function(o,s){return o===void 0&&s.ownKeys===!1},replace:function(o){return 0},revive:function(o){}}}],N={undef:{test:function(o,s){return o===void 0&&(s.ownKeys||!("ownKeys"in s))},replace:function(o){return 0},revive:function(o){return new de.Undefined}}},U={StringObject:{test:function(o){return de.toStringTag(o)==="String"&&y(o)==="object"},replace:function(o){return String(o)},revive:function(o){return new String(o)}},BooleanObject:{test:function(o){return de.toStringTag(o)==="Boolean"&&y(o)==="object"},replace:function(o){return!!o},revive:function(o){return new Boolean(o)}},NumberObject:{test:function(o){return de.toStringTag(o)==="Number"&&y(o)==="object"},replace:function(o){return Number(o)},revive:function(o){return new Number(o)}}},M=[{nan:{test:function(o){return Number.isNaN(o)},replace:function(o){return"NaN"},revive:function(o){return Number.NaN}}},{infinity:{test:function(o){return o===Number.POSITIVE_INFINITY},replace:function(o){return"Infinity"},revive:function(o){return Number.POSITIVE_INFINITY}}},{negativeInfinity:{test:function(o){return o===Number.NEGATIVE_INFINITY},replace:function(o){return"-Infinity"},revive:function(o){return Number.NEGATIVE_INFINITY}}}],G={date:{test:function(o){return de.toStringTag(o)==="Date"},replace:function(o){var s=o.getTime();return Number.isNaN(s)?"NaN":s},revive:function(o){return o==="NaN"?new Date(Number.NaN):new Date(o)}}},_e={regexp:{test:function(o){return de.toStringTag(o)==="RegExp"},replace:function(o){return{source:o.source,flags:(o.global?"g":"")+(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.sticky?"y":"")+(o.unicode?"u":"")}},revive:function(o){var s=o.source,d=o.flags;return new RegExp(s,d)}}},Ie={map:{test:function(o){return de.toStringTag(o)==="Map"},replace:function(o){return Q(o.entries())},revive:function(o){return new Map(o)}}},Ce={set:{test:function(o){return de.toStringTag(o)==="Set"},replace:function(o){return Q(o.values())},revive:function(o){return new Set(o)}}},ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",pt=new Uint8Array(256),Ot=0;Ot<ie.length;Ot++)pt[ie.charCodeAt(Ot)]=Ot;var ne=function(o,s,d){d==null&&(d=o.byteLength);for(var w=new Uint8Array(o,s||0,d),J=w.length,W="",se=0;se<J;se+=3)W+=ie[w[se]>>2],W+=ie[(3&w[se])<<4|w[se+1]>>4],W+=ie[(15&w[se+1])<<2|w[se+2]>>6],W+=ie[63&w[se+2]];return J%3==2?W=W.slice(0,-1)+"=":J%3==1&&(W=W.slice(0,-2)+"=="),W},It=function(o){var s,d,w,J,W=o.length,se=.75*o.length,q=0;o[o.length-1]==="="&&(se--,o[o.length-2]==="="&&se--);for(var ye=new ArrayBuffer(se),we=new Uint8Array(ye),Te=0;Te<W;Te+=4)s=pt[o.charCodeAt(Te)],d=pt[o.charCodeAt(Te+1)],w=pt[o.charCodeAt(Te+2)],J=pt[o.charCodeAt(Te+3)],we[q++]=s<<2|d>>4,we[q++]=(15&d)<<4|w>>2,we[q++]=(3&w)<<6|63&J;return ye},Kt={arraybuffer:{test:function(o){return de.toStringTag(o)==="ArrayBuffer"},replace:function(o,s){s.buffers||(s.buffers=[]);var d=s.buffers.indexOf(o);return d>-1?{index:d}:(s.buffers.push(o),ne(o))},revive:function(o,s){if(s.buffers||(s.buffers=[]),y(o)==="object")return s.buffers[o.index];var d=It(o);return s.buffers.push(d),d}}},Bt=typeof self>"u"?zr:self,Se={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(c){var o=c,s=Bt[o];s&&(Se[c.toLowerCase()]={test:function(w){return de.toStringTag(w)===o},replace:function(w,J){var W=w.buffer,se=w.byteOffset,q=w.length;J.buffers||(J.buffers=[]);var ye=J.buffers.indexOf(W);return ye>-1?{index:ye,byteOffset:se,length:q}:(J.buffers.push(W),{encoded:ne(W),byteOffset:se,length:q})},revive:function(w,J){J.buffers||(J.buffers=[]);var W,se=w.byteOffset,q=w.length,ye=w.encoded,we=w.index;return"index"in w?W=J.buffers[we]:(W=It(ye),J.buffers.push(W)),new s(W,se,q)}})});var bt={dataview:{test:function(o){return de.toStringTag(o)==="DataView"},replace:function(o,s){var d=o.buffer,w=o.byteOffset,J=o.byteLength;s.buffers||(s.buffers=[]);var W=s.buffers.indexOf(d);return W>-1?{index:W,byteOffset:w,byteLength:J}:(s.buffers.push(d),{encoded:ne(d),byteOffset:w,byteLength:J})},revive:function(o,s){s.buffers||(s.buffers=[]);var d,w=o.byteOffset,J=o.byteLength,W=o.encoded,se=o.index;return"index"in o?d=s.buffers[se]:(d=It(W),s.buffers.push(d)),new DataView(d,w,J)}}},ot={IntlCollator:{test:function(o){return de.hasConstructorOf(o,Intl.Collator)},replace:function(o){return o.resolvedOptions()},revive:function(o){return new Intl.Collator(o.locale,o)}},IntlDateTimeFormat:{test:function(o){return de.hasConstructorOf(o,Intl.DateTimeFormat)},replace:function(o){return o.resolvedOptions()},revive:function(o){return new Intl.DateTimeFormat(o.locale,o)}},IntlNumberFormat:{test:function(o){return de.hasConstructorOf(o,Intl.NumberFormat)},replace:function(o){return o.resolvedOptions()},revive:function(o){return new Intl.NumberFormat(o.locale,o)}}};function Re(c){for(var o=new Uint8Array(c.length),s=0;s<c.length;s++)o[s]=c.charCodeAt(s);return o.buffer}var ze={file:{test:function(o){return de.toStringTag(o)==="File"},replace:function(o){var s=new XMLHttpRequest;if(s.overrideMimeType("text/plain; charset=x-user-defined"),s.open("GET",URL.createObjectURL(o),!1),s.send(),s.status!==200&&s.status!==0)throw new Error("Bad File access: "+s.status);return{type:o.type,stringContents:s.responseText,name:o.name,lastModified:o.lastModified}},revive:function(o){var s=o.name,d=o.type,w=o.stringContents,J=o.lastModified;return new File([Re(w)],s,{type:d,lastModified:J})},replaceAsync:function(o){return new de.Promise(function(s,d){var w=new FileReader;w.addEventListener("load",function(){s({type:o.type,stringContents:w.result,name:o.name,lastModified:o.lastModified})}),w.addEventListener("error",function(){d(w.error)}),w.readAsBinaryString(o)})}}},Qe={bigint:{test:function(o){return typeof o=="bigint"},replace:function(o){return String(o)},revive:function(o){return BigInt(o)}}},ut={bigintObject:{test:function(o){return y(o)==="object"&&de.hasConstructorOf(o,BigInt)},replace:function(o){return String(o)},revive:function(o){return new Object(BigInt(o))}}},ue={cryptokey:{test:function(o){return de.toStringTag(o)==="CryptoKey"&&o.extractable},replaceAsync:function(o){return new de.Promise(function(s,d){crypto.subtle.exportKey("jwk",o).catch(function(w){d(w)}).then(function(w){s({jwk:w,algorithm:o.algorithm,usages:o.usages})})})},revive:function(o){var s=o.jwk,d=o.algorithm,w=o.usages;return crypto.subtle.importKey("jwk",s,d,!0,w)}}};return[it,N,k,U,M,G,_e,{imagedata:{test:function(o){return de.toStringTag(o)==="ImageData"},replace:function(o){return{array:Q(o.data),width:o.width,height:o.height}},revive:function(o){return new ImageData(new Uint8ClampedArray(o.array),o.width,o.height)}}},{imagebitmap:{test:function(o){return de.toStringTag(o)==="ImageBitmap"||o&&o.dataset&&o.dataset.toStringTag==="ImageBitmap"},replace:function(o){var s=document.createElement("canvas");return s.getContext("2d").drawImage(o,0,0),s.toDataURL()},revive:function(o){var s=document.createElement("canvas"),d=s.getContext("2d"),w=document.createElement("img");return w.addEventListener("load",function(){d.drawImage(w,0,0)}),w.src=o,s},reviveAsync:function(o){var s=document.createElement("canvas"),d=s.getContext("2d"),w=document.createElement("img");return w.addEventListener("load",function(){d.drawImage(w,0,0)}),w.src=o,createImageBitmap(s)}}},ze,{file:ze.file,filelist:{test:function(o){return de.toStringTag(o)==="FileList"},replace:function(o){for(var s=[],d=0;d<o.length;d++)s[d]=o.item(d);return s},revive:function(o){return new((function(){function s(){R(this,s),this._files=arguments[0],this.length=this._files.length}return(function(w,J,W){return J&&D(w.prototype,J),W&&D(w,W),w})(s,[{key:"item",value:function(w){return this._files[w]}},{key:Symbol.toStringTag,get:function(){return"FileList"}}]),s})())(o)}}},{blob:{test:function(o){return de.toStringTag(o)==="Blob"},replace:function(o){var s=new XMLHttpRequest;if(s.overrideMimeType("text/plain; charset=x-user-defined"),s.open("GET",URL.createObjectURL(o),!1),s.send(),s.status!==200&&s.status!==0)throw new Error("Bad Blob access: "+s.status);return{type:o.type,stringContents:s.responseText}},revive:function(o){var s=o.type,d=o.stringContents;return new Blob([Re(d)],{type:s})},replaceAsync:function(o){return new de.Promise(function(s,d){var w=new FileReader;w.addEventListener("load",function(){s({type:o.type,stringContents:w.result})}),w.addEventListener("error",function(){d(w.error)}),w.readAsBinaryString(o)})}}}].concat(typeof Map=="function"?Ie:[],typeof Set=="function"?Ce:[],typeof ArrayBuffer=="function"?Kt:[],typeof Uint8Array=="function"?Se:[],typeof DataView=="function"?bt:[],typeof Intl<"u"?ot:[],typeof crypto<"u"?ue:[],typeof BigInt<"u"?[Qe,ut]:[])})}),bn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Bn=new Uint8Array(256);for(In=0;In<bn.length;In++)Bn[bn.codePointAt(In)]=In;var In,Yr=function(P,y,R){R==null&&(R=P.byteLength);for(var D=new Uint8Array(P,y||0,R),S=D.length,m="",Q=0;Q<S;Q+=3)m+=bn[D[Q]>>2],m+=bn[(D[Q]&3)<<4|D[Q+1]>>4],m+=bn[(D[Q+1]&15)<<2|D[Q+2]>>6],m+=bn[D[Q+2]&63];return S%3===2?m=m.slice(0,-1)+"=":S%3===1&&(m=m.slice(0,-2)+"=="),m},Ri=function(P){var y=P.length,R=P.length*.75,D=0,S,m,Q,oe;P[P.length-1]==="="&&(R--,P[P.length-2]==="="&&R--);for(var E=new ArrayBuffer(R),z=new Uint8Array(E),le=0;le<y;le+=4)S=Bn[P.codePointAt(le)],m=Bn[P.codePointAt(le+1)],Q=Bn[P.codePointAt(le+2)],oe=Bn[P.codePointAt(le+3)],z[D++]=S<<2|m>>4,z[D++]=(m&15)<<4|Q>>2,z[D++]=(Q&3)<<6|oe&63;return E},eo=typeof self>"u"?global:self,Ni={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(x){var P=x,y=eo[P];y&&(Ni[x.toLowerCase()+"2"]={test:function(R){return ur.toStringTag(R)===P},replace:function(R){var D=R.buffer,S=R.byteOffset,m=R.length;return{buffer:D,byteOffset:S,length:m}},revive:function(R){var D=R.buffer,S=R.byteOffset,m=R.length;return new y(D,S,m)}})});var to={arraybuffer:{test:function(x){return ur.toStringTag(x)==="ArrayBuffer"},replace:function(x){return Yr(x,0,x.byteLength)},revive:function(x){var P=Ri(x);return P}}},Mt=new ur().register(Za),no="FileReaderSync"in self,or=[],ir=0;Mt.register([to,Ni,{blob2:{test:function(x){return ur.toStringTag(x)==="Blob"},replace:function(x){if(x.isClosed)throw new Error("The Blob is closed");if(no){var P=Bi(x,"binary"),y=Yr(P,0,P.byteLength);return{type:x.type,data:y}}else{or.push(x);var R={type:x.type,data:{start:ir,end:ir+x.size}};return ir+=x.size,R}},finalize:function(x,P){x.data=Yr(P,0,P.byteLength)},revive:function(x){var P=x.type,y=x.data;return new Blob([Ri(y)],{type:P})}}}]);Mt.mustFinalize=function(){return or.length>0};Mt.finalize=function(x){return sn(void 0,void 0,void 0,function(){var P,y,R,D,S,m,Q,oe,E,z,le,qe;return $t(this,function(Ue){switch(Ue.label){case 0:return[4,Ii(new Blob(or),"binary")];case 1:if(P=Ue.sent(),x){for(y=0,R=x;y<R.length;y++)if(D=R[y],D.$types){S=D.$types,m=S.$,m&&(S=S.$);for(Q in S)oe=S[Q],E=Mt.types[oe],E&&E.finalize&&(z=Et.getByKeyPath(D,m?"$."+Q:Q),E.finalize(z,P.slice((le=z.data)===null||le===void 0?void 0:le.start,(qe=z.data)===null||qe===void 0?void 0:qe.end)))}}return or=[],ir=0,[2]}})})};var ro=2e3;function Gr(x,P){return sn(this,void 0,void 0,function(){function y(){return sn(this,void 0,void 0,function(){var le,qe,Ue,be,Ee,Fe,vt,tt,re,lt;return $t(this,function(me){switch(me.label){case 0:return[4,Promise.all(D.map(function(Ye){return Ye.count()}))];case 1:le=me.sent(),le.forEach(function(Ye,Pe){return m[Pe].rowCount=Ye}),z.totalRows=le.reduce(function(Ye,Pe){return Ye+Pe}),qe=JSON.stringify(oe,void 0,Q?2:void 0),Ue=qe.lastIndexOf("]"),be=qe.substring(0,Ue),S.push(be),Ee=P.filter,Fe=P.transform,vt=function(Ye){var Pe,He,T,p,Y,I,Me,Oe,Ve,nt,rt,st;return $t(this,function(yt){switch(yt.label){case 0:Pe=x.table(Ye),He=Pe.schema.primKey,T=!!He.keyPath,p=P.numRowsPerChunk||ro,Y=T?{tableName:Pe.name,inbound:!0,rows:[]}:{tableName:Pe.name,inbound:!1,rows:[]},I=JSON.stringify(Y,void 0,Q?2:void 0),Q&&(I=I.split(`
`).join(`
    `)),Me=I.lastIndexOf("]"),S.push(I.substring(0,Me)),Oe=null,Ve=0,nt=!0,rt=function(){var Xe,Ze,mt,Nt,de,N,$e,it,k,N;return $t(this,function(U){switch(U.label){case 0:return E&&Et.ignoreTransaction(function(){return E(z)}),Xe=Oe==null?Pe.limit(p):Pe.where(":id").above(Oe).limit(p),[4,Xe.toArray()];case 1:return Ze=U.sent(),Ze.length===0?[2,"break"]:(Oe!=null&&Ve>0&&(S.push(","),Q&&S.push(`
      `)),nt=Ze.length===p,T?(mt=Ee?Ze.filter(function(M){return Ee(Ye,M)}):Ze,Nt=Fe?mt.map(function(M){return Fe(Ye,M).value}):mt,de=Nt.map(function(M){return Mt.encapsulate(M)}),Mt.mustFinalize()?[4,Et.waitFor(Mt.finalize(de))]:[3,3]):[3,4]);case 2:U.sent(),U.label=3;case 3:return N=JSON.stringify(de,void 0,Q?2:void 0),Q&&(N=N.split(`
`).join(`
      `)),S.push(new Blob([N.substring(1,N.length-1)])),Ve=Nt.length,Oe=Ze.length>0?Et.getByKeyPath(Ze[Ze.length-1],He.keyPath):null,[3,8];case 4:return[4,Xe.primaryKeys()];case 5:return $e=U.sent(),it=$e.map(function(M,G){return[M,Ze[G]]}),Ee&&(it=it.filter(function(M){var G=M[0],_e=M[1];return Ee(Ye,_e,G)})),Fe&&(it=it.map(function(M){var G=M[0],_e=M[1],Ie=Fe(Ye,_e,G);return[Ie.key,Ie.value]})),k=it.map(function(M){return Mt.encapsulate(M)}),Mt.mustFinalize()?[4,Et.waitFor(Mt.finalize(k))]:[3,7];case 6:U.sent(),U.label=7;case 7:N=JSON.stringify(k,void 0,Q?2:void 0),Q&&(N=N.split(`
`).join(`
      `)),S.push(new Blob([N.substring(1,N.length-1)])),Ve=it.length,Oe=$e.length>0?$e[$e.length-1]:null,U.label=8;case 8:return z.completedRows+=Ze.length,[2]}})},yt.label=1;case 1:return nt?[5,rt()]:[3,3];case 2:return st=yt.sent(),st==="break"?[3,3]:[3,1];case 3:return S.push(I.substr(Me)),z.completedTables+=1,z.completedTables<z.totalTables&&S.push(","),[2]}})},tt=0,re=m,me.label=2;case 2:return tt<re.length?(lt=re[tt].name,[5,vt(lt)]):[3,5];case 3:me.sent(),me.label=4;case 4:return tt++,[3,2];case 5:return S.push(qe.substr(Ue)),z.done=!0,E&&Et.ignoreTransaction(function(){return E(z)}),[2]}})})}var R,D,S,m,Q,oe,E,z;return $t(this,function(le){switch(le.label){case 0:P=P||{},R=P.skipTables?P.skipTables:[],D=x.tables.filter(function(qe){return!R.includes(qe.name)}),S=[],m=D.map(function(qe){return{name:qe.name,schema:Xa(qe),rowCount:0}}),Q=P.prettyJson,oe={formatName:"dexie",formatVersion:1,data:{databaseName:x.name,databaseVersion:x.verno,tables:m,data:[]}},E=P.progressCallback,z={done:!1,completedRows:0,completedTables:0,totalRows:NaN,totalTables:m.length},le.label=1;case 1:return le.trys.push([1,,6,7]),P.noTransaction?[4,y()]:[3,3];case 2:return le.sent(),[3,5];case 3:return[4,x.transaction("r",x.tables,y)];case 4:le.sent(),le.label=5;case 5:return[3,7];case 6:return Mt.finalize(),[7];case 7:return[2,new Blob(S,{type:"text/json"})]}})})}var io=1,ao={Stream:function(){}},oo=Jr(function(x,P){(function(y){var R=typeof process=="object"&&process.env?process.env:self;y.parser=function(T){return new Ue(T)},y.CParser=Ue,y.CStream=Ee,y.createStream=be,y.MAX_BUFFER_LENGTH=10*1024*1024,y.DEBUG=R.CDEBUG==="debug",y.INFO=R.CDEBUG==="debug"||R.CDEBUG==="info",y.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var D={textNode:void 0,numberNode:""},S=y.EVENTS.filter(function(T){return T!=="error"&&T!=="end"}),m=0,Q;y.STATE={BEGIN:m++,VALUE:m++,OPEN_OBJECT:m++,CLOSE_OBJECT:m++,OPEN_ARRAY:m++,CLOSE_ARRAY:m++,TEXT_ESCAPE:m++,STRING:m++,BACKSLASH:m++,END:m++,OPEN_KEY:m++,CLOSE_KEY:m++,TRUE:m++,TRUE2:m++,TRUE3:m++,FALSE:m++,FALSE2:m++,FALSE3:m++,FALSE4:m++,NULL:m++,NULL2:m++,NULL3:m++,NUMBER_DECIMAL_POINT:m++,NUMBER_DIGIT:m++};for(var oe in y.STATE)y.STATE[y.STATE[oe]]=oe;m=y.STATE;let E={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125};Object.create||(Object.create=function(T){function p(){this.__proto__=T}return p.prototype=T,new p}),Object.getPrototypeOf||(Object.getPrototypeOf=function(T){return T.__proto__}),Object.keys||(Object.keys=function(T){var p=[];for(var Y in T)T.hasOwnProperty(Y)&&p.push(Y);return p});function z(T){var p=Math.max(y.MAX_BUFFER_LENGTH,10),Y=0;for(var I in D){var Me=T[I]===void 0?0:T[I].length;Me>p&&(I==="text"?closeText(T):me(T,"Max buffer length exceeded: "+I)),Y=Math.max(Y,Me)}T.bufferCheckPosition=y.MAX_BUFFER_LENGTH-Y+T.position}function le(T){for(var p in D)T[p]=D[p]}var qe=/[\\"\n]/g;function Ue(T){if(!(this instanceof Ue))return new Ue(T);var p=this;le(p),p.bufferCheckPosition=y.MAX_BUFFER_LENGTH,p.q=p.c=p.p="",p.opt=T||{},p.closed=p.closedRoot=p.sawRoot=!1,p.tag=p.error=null,p.state=m.BEGIN,p.stack=new Array,p.position=p.column=0,p.line=1,p.slashed=!1,p.unicodeI=0,p.unicodeS=null,p.depth=0,Fe(p,"onready")}Ue.prototype={end:function(){Ye(this)},write:He,resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{Q=ao.Stream}catch(T){Q=function(){}}function be(T){return new Ee(T)}function Ee(T){if(!(this instanceof Ee))return new Ee(T);this._parser=new Ue(T),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string="";var p=this;Q.apply(p),this._parser.onend=function(){p.emit("end")},this._parser.onerror=function(Y){p.emit("error",Y),p._parser.error=null},S.forEach(function(Y){Object.defineProperty(p,"on"+Y,{get:function(){return p._parser["on"+Y]},set:function(I){if(!I)return p.removeAllListeners(Y),p._parser["on"+Y]=I,I;p.on(Y,I)},enumerable:!0,configurable:!1})})}Ee.prototype=Object.create(Q.prototype,{constructor:{value:Ee}}),Ee.prototype.write=function(T){T=new Buffer(T);for(var p=0;p<T.length;p++){var Y=T[p];if(this.bytes_remaining>0){for(var I=0;I<this.bytes_remaining;I++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+I]=T[I];this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,p=p+I-1,this._parser.write(this.string),this.emit("data",this.string);continue}if(this.bytes_remaining===0&&Y>=128)if(Y>=194&&Y<=223&&(this.bytes_in_sequence=2),Y>=224&&Y<=239&&(this.bytes_in_sequence=3),Y>=240&&Y<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+p>T.length){for(var Me=0;Me<=T.length-1-p;Me++)this.temp_buffs[this.bytes_in_sequence][Me]=T[p+Me];return this.bytes_remaining=p+this.bytes_in_sequence-T.length,!0}else{this.string=T.slice(p,p+this.bytes_in_sequence).toString(),p=p+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string);continue}for(var Oe=p;Oe<T.length&&!(T[Oe]>=128);Oe++);this.string=T.slice(p,Oe).toString(),this._parser.write(this.string),this.emit("data",this.string),p=Oe-1}},Ee.prototype.end=function(T){return T&&T.length&&this._parser.write(T.toString()),this._parser.end(),!0},Ee.prototype.on=function(T,p){var Y=this;return!Y._parser["on"+T]&&S.indexOf(T)!==-1&&(Y._parser["on"+T]=function(){var I=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);I.splice(0,0,T),Y.emit.apply(Y,I)}),Q.prototype.on.call(Y,T,p)},Ee.prototype.destroy=function(){le(this._parser),this.emit("close")};function Fe(T,p,Y){y.INFO&&console.log("-- emit",p,Y),T[p]&&T[p](Y)}function vt(T,p,Y){tt(T),Fe(T,p,Y)}function tt(T,p){T.textNode=lt(T.opt,T.textNode),T.textNode!==void 0&&Fe(T,p||"onvalue",T.textNode),T.textNode=void 0}function re(T){T.numberNode&&Fe(T,"onvalue",parseFloat(T.numberNode)),T.numberNode=""}function lt(T,p){return p===void 0||(T.trim&&(p=p.trim()),T.normalize&&(p=p.replace(/\s+/g," "))),p}function me(T,p){return tt(T),p+=`
Line: `+T.line+`
Column: `+T.column+`
Char: `+T.c,p=new Error(p),T.error=p,Fe(T,"onerror",p),T}function Ye(T){return(T.state!==m.VALUE||T.depth!==0)&&me(T,"Unexpected end"),tt(T),T.c="",T.closed=!0,Fe(T,"onend"),Ue.call(T,T.opt),T}function Pe(T){return T===E.carriageReturn||T===E.lineFeed||T===E.space||T===E.tab}function He(T){var p=this;if(this.error)throw this.error;if(p.closed)return me(p,"Cannot write after close. Assign an onready handler.");if(T===null)return Ye(p);var Y=0,I=T.charCodeAt(0),Me=p.p;for(y.DEBUG&&console.log("write -> ["+T+"]");I&&(Me=I,p.c=I=T.charCodeAt(Y++),Me!==I?p.p=Me:Me=p.p,!!I);)switch(y.DEBUG&&console.log(Y,I,y.STATE[p.state]),p.position++,I===E.lineFeed?(p.line++,p.column=0):p.column++,p.state){case m.BEGIN:I===E.openBrace?p.state=m.OPEN_OBJECT:I===E.openBracket?p.state=m.OPEN_ARRAY:Pe(I)||me(p,"Non-whitespace before {[.");continue;case m.OPEN_KEY:case m.OPEN_OBJECT:if(Pe(I))continue;if(p.state===m.OPEN_KEY)p.stack.push(m.CLOSE_KEY);else if(I===E.closeBrace){Fe(p,"onopenobject"),this.depth++,Fe(p,"oncloseobject"),this.depth--,p.state=p.stack.pop()||m.VALUE;continue}else p.stack.push(m.CLOSE_OBJECT);I===E.doubleQuote?p.state=m.STRING:me(p,'Malformed object key should start with "');continue;case m.CLOSE_KEY:case m.CLOSE_OBJECT:if(Pe(I))continue;p.state,m.CLOSE_KEY,I===E.colon?(p.state===m.CLOSE_OBJECT?(p.stack.push(m.CLOSE_OBJECT),tt(p,"onopenobject"),this.depth++):tt(p,"onkey"),p.state=m.VALUE):I===E.closeBrace?(vt(p,"oncloseobject"),this.depth--,p.state=p.stack.pop()||m.VALUE):I===E.comma?(p.state===m.CLOSE_OBJECT&&p.stack.push(m.CLOSE_OBJECT),tt(p),p.state=m.OPEN_KEY):me(p,"Bad object");continue;case m.OPEN_ARRAY:case m.VALUE:if(Pe(I))continue;if(p.state===m.OPEN_ARRAY)if(Fe(p,"onopenarray"),this.depth++,p.state=m.VALUE,I===E.closeBracket){Fe(p,"onclosearray"),this.depth--,p.state=p.stack.pop()||m.VALUE;continue}else p.stack.push(m.CLOSE_ARRAY);I===E.doubleQuote?p.state=m.STRING:I===E.openBrace?p.state=m.OPEN_OBJECT:I===E.openBracket?p.state=m.OPEN_ARRAY:I===E.t?p.state=m.TRUE:I===E.f?p.state=m.FALSE:I===E.n?p.state=m.NULL:I===E.minus?p.numberNode+="-":E._0<=I&&I<=E._9?(p.numberNode+=String.fromCharCode(I),p.state=m.NUMBER_DIGIT):me(p,"Bad value");continue;case m.CLOSE_ARRAY:if(I===E.comma)p.stack.push(m.CLOSE_ARRAY),tt(p,"onvalue"),p.state=m.VALUE;else if(I===E.closeBracket)vt(p,"onclosearray"),this.depth--,p.state=p.stack.pop()||m.VALUE;else{if(Pe(I))continue;me(p,"Bad array")}continue;case m.STRING:p.textNode===void 0&&(p.textNode="");var Oe=Y-1,Ve=p.slashed,nt=p.unicodeI;e:for(;;){for(y.DEBUG&&console.log(Y,I,y.STATE[p.state],Ve);nt>0;)if(p.unicodeS+=String.fromCharCode(I),I=T.charCodeAt(Y++),p.position++,nt===4?(p.textNode+=String.fromCharCode(parseInt(p.unicodeS,16)),nt=0,Oe=Y-1):nt++,!I)break e;if(I===E.doubleQuote&&!Ve){p.state=p.stack.pop()||m.VALUE,p.textNode+=T.substring(Oe,Y-1),p.position+=Y-1-Oe;break}if(I===E.backslash&&!Ve&&(Ve=!0,p.textNode+=T.substring(Oe,Y-1),p.position+=Y-1-Oe,I=T.charCodeAt(Y++),p.position++,!I))break;if(Ve){if(Ve=!1,I===E.n?p.textNode+=`
`:I===E.r?p.textNode+="\r":I===E.t?p.textNode+="	":I===E.f?p.textNode+="\f":I===E.b?p.textNode+="\b":I===E.u?(nt=1,p.unicodeS=""):p.textNode+=String.fromCharCode(I),I=T.charCodeAt(Y++),p.position++,Oe=Y-1,I)continue;break}qe.lastIndex=Y;var rt=qe.exec(T);if(rt===null){Y=T.length+1,p.textNode+=T.substring(Oe,Y-1),p.position+=Y-1-Oe;break}if(Y=rt.index+1,I=T.charCodeAt(rt.index),!I){p.textNode+=T.substring(Oe,Y-1),p.position+=Y-1-Oe;break}}p.slashed=Ve,p.unicodeI=nt;continue;case m.TRUE:I===E.r?p.state=m.TRUE2:me(p,"Invalid true started with t"+I);continue;case m.TRUE2:I===E.u?p.state=m.TRUE3:me(p,"Invalid true started with tr"+I);continue;case m.TRUE3:I===E.e?(Fe(p,"onvalue",!0),p.state=p.stack.pop()||m.VALUE):me(p,"Invalid true started with tru"+I);continue;case m.FALSE:I===E.a?p.state=m.FALSE2:me(p,"Invalid false started with f"+I);continue;case m.FALSE2:I===E.l?p.state=m.FALSE3:me(p,"Invalid false started with fa"+I);continue;case m.FALSE3:I===E.s?p.state=m.FALSE4:me(p,"Invalid false started with fal"+I);continue;case m.FALSE4:I===E.e?(Fe(p,"onvalue",!1),p.state=p.stack.pop()||m.VALUE):me(p,"Invalid false started with fals"+I);continue;case m.NULL:I===E.u?p.state=m.NULL2:me(p,"Invalid null started with n"+I);continue;case m.NULL2:I===E.l?p.state=m.NULL3:me(p,"Invalid null started with nu"+I);continue;case m.NULL3:I===E.l?(Fe(p,"onvalue",null),p.state=p.stack.pop()||m.VALUE):me(p,"Invalid null started with nul"+I);continue;case m.NUMBER_DECIMAL_POINT:I===E.period?(p.numberNode+=".",p.state=m.NUMBER_DIGIT):me(p,"Leading zero not followed by .");continue;case m.NUMBER_DIGIT:E._0<=I&&I<=E._9?p.numberNode+=String.fromCharCode(I):I===E.period?(p.numberNode.indexOf(".")!==-1&&me(p,"Invalid number has two dots"),p.numberNode+="."):I===E.e||I===E.E?((p.numberNode.indexOf("e")!==-1||p.numberNode.indexOf("E")!==-1)&&me(p,"Invalid number has two exponential"),p.numberNode+="e"):I===E.plus||I===E.minus?(Me===E.e||Me===E.E||me(p,"Invalid symbol in number"),p.numberNode+=String.fromCharCode(I)):(re(p),Y--,p.state=p.stack.pop()||m.VALUE);continue;default:me(p,"Unknown state: "+p.state)}return p.position>=p.bufferCheckPosition&&z(p),p}})(P)});function uo(x){var P=0,y=so(!0),R={pullAsync:function(D){return sn(this,void 0,void 0,function(){var S,m,Q;return $t(this,function(oe){switch(oe.label){case 0:return S=x.slice(P,P+D),P+=D,[4,Ii(S,"text")];case 1:return m=oe.sent(),Q=y.write(m),R.result=Q||{},[2,Q]}})})},pullSync:function(D){var S=x.slice(P,P+D);P+=D;var m=Bi(S,"text"),Q=y.write(m);return R.result=Q||{},Q},done:function(){return y.done()},eof:function(){return P>=x.size},result:{}};return R}function so(x){var P=oo.parser(),y=0,R,D=[],S,m,Q=!1,oe=!1;return P.onopenobject=function(E){var z={};z.incomplete=!0,R||(R=z),S&&(D.push([m,S,oe]),x&&(oe?S.push(z):S[m]=z)),S=z,m=E,oe=!1,++y},P.onkey=function(E){return m=E},P.onvalue=function(E){return oe?S.push(E):S[m]=E},P.oncloseobject=function(){var E;if(delete S.incomplete,m=null,--y===0)Q=!0;else{var z=S;E=D.pop(),m=E[0],S=E[1],oe=E[2],x||(oe?S.push(z):S[m]=z)}},P.onopenarray=function(){var E=[];E.incomplete=!0,R||(R=E),S&&(D.push([m,S,oe]),x&&(oe?S.push(E):S[m]=E)),S=E,oe=!0,m=null,++y},P.onclosearray=function(){var E;if(delete S.incomplete,m=null,--y===0)Q=!0;else{var z=S;E=D.pop(),m=E[0],S=E[1],oe=E[2],x||(oe?S.push(z):S[m]=z)}},{write:function(E){return P.write(E),R},done:function(){return Q}}}var Ki=1024;function co(x,P){return sn(this,void 0,void 0,function(){var y,R,D,S;return $t(this,function(m){switch(m.label){case 0:return P=P||{},y=P.chunkSizeBytes||Ki*1024,[4,Di(x,y)];case 1:return R=m.sent(),D=R.result.data,S=new Et(P.name!==void 0?P.name:D.databaseName),S.version(D.databaseVersion).stores(qa(D)),[4,sr(S,R,P.name!==void 0?ar(ar({},P),{acceptNameDiff:!0}):P)];case 2:return m.sent(),[2,S]}})})}function sr(x,P,y){return sn(this,void 0,void 0,function(){function R(){return sn(this,void 0,void 0,function(){var Ee,Fe,vt,tt,re;return $t(this,function(lt){switch(lt.label){case 0:Ee=function(me){var Ye,Pe,He,T,p,Y,I,Me,Oe,Ve,nt,rt,st;return $t(this,function(yt){switch(yt.label){case 0:if(E.includes(me.tableName))return[2,"continue"];if(!me.rows)return[2,"break"];if(!me.rows.incomplete&&me.rows.length===0)return[2,"continue"];if(z&&Et.ignoreTransaction(function(){return z(le)}),Ye=me.tableName,Pe=x.table(Ye),He=oe.tables.filter(function(Xe){return Xe.name===Ye})[0].schema,!Pe){if(y.acceptMissingTables)return[2,"continue"];throw new Error("Exported table ".concat(me.tableName," is missing in installed database"))}if(!y.acceptChangedPrimaryKey&&He.split(",")[0]!=Pe.schema.primKey.src)throw new Error("Primary key differs for table ".concat(me.tableName,". "));for(T=me.rows,p=[],Y=0;Y<T.length&&(I=T[Y],!I.incomplete);Y++)p.push(Mt.revive(I));return Me=y.filter,Oe=y.transform,Ve=Me?me.inbound?p.filter(function(Xe){return Me(Ye,Xe)}):p.filter(function(Xe){var Ze=Xe[0],mt=Xe[1];return Me(Ye,mt,Ze)}):p,Oe&&(Ve=Ve.map(me.inbound?function(Xe){return Oe(Ye,Xe).value}:function(Xe){var Ze=Xe[0],mt=Xe[1],Nt=Oe(Ye,mt,Ze);return[Nt.key,Nt.value]})),nt=me.inbound?[void 0,Ve]:[Ve.map(function(Xe){return Xe[0]}),p.map(function(Xe){return Xe[1]})],rt=nt[0],st=nt[1],y.overwriteValues?[4,Pe.bulkPut(st,rt)]:[3,2];case 1:return yt.sent(),[3,4];case 2:return[4,Pe.bulkAdd(st,rt)];case 3:yt.sent(),yt.label=4;case 4:return le.completedRows+=p.length,p.incomplete||(le.completedTables+=1),T.splice(0,p.length),[2]}})},Fe=0,vt=oe.data,lt.label=1;case 1:return Fe<vt.length?(tt=vt[Fe],[5,Ee(tt)]):[3,4];case 2:if(re=lt.sent(),re==="break")return[3,4];lt.label=3;case 3:return Fe++,[3,1];case 4:for(;oe.data.length>0&&oe.data[0].rows&&!oe.data[0].rows.incomplete;)oe.data.splice(0,1);return!S.done()&&!S.eof()?Q?(S.pullSync(D),[3,7]):[3,5]:[3,8];case 5:return[4,Et.waitFor(S.pullAsync(D))];case 6:lt.sent(),lt.label=7;case 7:return[3,9];case 8:return[3,10];case 9:return[3,0];case 10:return[2]}})})}var D,S,m,Q,oe,E,z,le,qe,Ue,be;return $t(this,function(Ee){switch(Ee.label){case 0:return y=y||{},D=y.chunkSizeBytes||Ki*1024,[4,Di(P,D)];case 1:if(S=Ee.sent(),m=S.result,Q="FileReaderSync"in self,oe=m.data,E=y.skipTables?y.skipTables:[],!y.acceptNameDiff&&x.name!==oe.databaseName)throw new Error("Name differs. Current database name is ".concat(x.name," but export is ").concat(oe.databaseName));if(!y.acceptVersionDiff&&x.verno!==oe.databaseVersion)throw new Error("Database version differs. Current database is in version ".concat(x.verno," but export is ").concat(oe.databaseVersion));if(z=y.progressCallback,le={done:!1,completedRows:0,completedTables:0,totalRows:oe.tables.reduce(function(Fe,vt){return Fe+vt.rowCount},0),totalTables:oe.tables.length},z&&Et.ignoreTransaction(function(){return z(le)}),!y.clearTablesBeforeImport)return[3,5];qe=0,Ue=x.tables,Ee.label=2;case 2:return qe<Ue.length?(be=Ue[qe],E.includes(be.name)?[3,4]:[4,be.clear()]):[3,5];case 3:Ee.sent(),Ee.label=4;case 4:return qe++,[3,2];case 5:return y.noTransaction?[4,R()]:[3,7];case 6:return Ee.sent(),[3,9];case 7:return[4,x.transaction("rw",x.tables,R)];case 8:Ee.sent(),Ee.label=9;case 9:return le.done=!0,z&&Et.ignoreTransaction(function(){return z(le)}),[2]}})})}function Di(x,P){return sn(this,void 0,void 0,function(){var y,R;return $t(this,function(D){switch(D.label){case 0:y="slice"in x?uo(x):x,D.label=1;case 1:return y.eof()?[3,3]:[4,y.pullAsync(P)];case 2:return D.sent(),y.result.data&&y.result.data.data?[3,3]:[3,1];case 3:if(R=y.result,!R||R.formatName!="dexie")throw new Error("Given file is not a dexie export");if(R.formatVersion>io)throw new Error("Format version ".concat(R.formatVersion," not supported"));if(!R.data)throw new Error("No data in export file");if(!R.data.databaseName)throw new Error("Missing databaseName in export file");if(!R.data.databaseVersion)throw new Error("Missing databaseVersion in export file");if(!R.data.tables)throw new Error("Missing tables in export file");return[2,y]}})})}Et.prototype.export=function(x){return Gr(this,x)};Et.prototype.import=function(x,P){return sr(this,x,P)};Et.import=function(x,P){return co(x,P)};var Wr=class extends Et{constructor(){super(tr.db.NAME),this.version(1).stores({stocks:"&id, &scripCode.nse"});let P=[];this.on("ready",()=>Qt(this,null,function*(){let y=yield this.stocks.toArray();P=yield Promise.all(y.map(R=>Qt(this,null,function*(){if(R.scripCode.isin)return R;{let D=yield fetch(tr.api.STOCK_QUOTE+R.vendorCode.etm);if(D.ok){let S=yield D.json(),m=S.nseScripCode?S.nseScripCode.toUpperCase().endsWith("EQ")?S.nseScripCode.slice(0,-2):S.nseScripCode:"",Q=yield fetch(tr.api.STOCK_SEARCH_SECONDARY+(m||S.bseScripCode||"")),oe;if(Q.ok){let{result:E}=yield Q.json();E.length>0&&(oe=E.find(z=>z.isinid&&z.isinid===S.isinCode||z.nseid&&z.nseid===m||z.bseid&&z.bseid===S.bseScripCode))}return er(Zn({},R),{scripCode:{isin:S.isinCode||"",nse:m,bse:S.bseScripCode||""},vendorCode:{etm:{primary:S.companyId,chart:(S.nseScripCode&&S.nse?S.nse.symbol:S.bse?.symbol)||""},mc:{primary:oe?.id||""}}})}else return R}}))),this.stocks.clear(),this.stocks.bulkAdd(P)})),this.version(2).stores({stocks:"&id, &scripCode.isin"})}},Lt=new Wr;var Vo=(()=>{class x{constructor(){this.stocks$=ki(()=>Lt.stocks.toArray())}addOrUpdate(y,R){return Qt(this,null,function*(){let D=yield Lt.stocks.get({"scripCode.isin":y.scripCode.isin});D?.id?yield Lt.stocks.update(D.id,{transactions:[...D.transactions,R]}):(y=er(Zn({},y),{id:Ur(),transactions:[R]}),yield Lt.stocks.add(y,y.id))})}delete(y){return Qt(this,null,function*(){yield Lt.stocks.delete(y)})}importDb(y,R){return Qt(this,null,function*(){yield Lt.delete(),yield Lt.open(),yield sr(Lt,y,{progressCallback:R})})}exportDb(y){return Qt(this,null,function*(){return yield Gr(Lt,{progressCallback:y})})}deleteDb(){return Qt(this,null,function*(){yield Lt.delete(),yield Lt.open()})}static{this.\u0275fac=function(R){return new(R||x)}}static{this.\u0275prov=Ti({token:x,factory:x.\u0275fac,providedIn:"root"})}}return x})();export{Ur as a,Vo as b};
