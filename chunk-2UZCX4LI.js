import{a as Yt}from"./chunk-HY3UCQ3V.js";import{a as Vt,b as $t,c as Di,d as Ui,e as tt,fa as ai}from"./chunk-PPE7DTG5.js";var si=Di((Ar,kr)=>{"use strict";(function(K,E){typeof Ar=="object"&&typeof kr<"u"?kr.exports=E():typeof define=="function"&&define.amd?define(E):(K=typeof globalThis<"u"?globalThis:K||self).Dexie=E()})(Ar,function(){"use strict";var K=function(e,n){return(K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])})(e,n)},E=function(){return(E=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function T(e,n,t){if(t||arguments.length===2)for(var r,i=0,a=n.length;i<a;i++)!r&&i in n||((r=r||Array.prototype.slice.call(n,0,i))[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))}var D=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,L=Object.keys,A=Array.isArray;function g(e,n){return typeof n!="object"||L(n).forEach(function(t){e[t]=n[t]}),e}typeof Promise>"u"||D.Promise||(D.Promise=Promise);var te=Object.getPrototypeOf,se={}.hasOwnProperty;function k(e,n){return se.call(e,n)}function W(e,n){typeof n=="function"&&(n=n(te(e))),(typeof Reflect>"u"?L:Reflect.ownKeys)(n).forEach(function(t){Ge(e,t,n[t])})}var he=Object.defineProperty;function Ge(e,n,t,r){he(e,n,g(t&&k(t,"get")&&typeof t.get=="function"?{get:t.get,set:t.set,configurable:!0}:{value:t,configurable:!0,writable:!0},r))}function Xe(e){return{from:function(n){return e.prototype=Object.create(n.prototype),Ge(e.prototype,"constructor",e),{extend:W.bind(null,e.prototype)}}}}var Oe=Object.getOwnPropertyDescriptor,ge=[].slice;function Ce(e,n,t){return ge.call(e,n,t)}function vn(e,n){return n(e)}function Ze(e){if(!e)throw new Error("Assertion Failed")}function re(e){D.setImmediate?setImmediate(e):setTimeout(e,0)}function rn(e,n){if(typeof n=="string"&&k(e,n))return e[n];if(!n)return e;if(typeof n!="string"){for(var t=[],r=0,i=n.length;r<i;++r){var a=rn(e,n[r]);t.push(a)}return t}var c=n.indexOf(".");if(c!==-1){var p=e[n.substr(0,c)];return p==null?void 0:rn(p,n.substr(c+1))}}function oe(e,n,t){if(e&&n!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof n!="string"&&"length"in n){Ze(typeof t!="string"&&"length"in t);for(var r=0,i=n.length;r<i;++r)oe(e,n[r],t[r])}else{var a,c,p=n.indexOf(".");p!==-1?(a=n.substr(0,p),(c=n.substr(p+1))===""?t===void 0?A(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=t:oe(p=!(p=e[a])||!k(e,a)?e[a]={}:p,c,t)):t===void 0?A(e)&&!isNaN(parseInt(n))?e.splice(n,1):delete e[n]:e[n]=t}}function Le(e){var n,t={};for(n in e)k(e,n)&&(t[n]=e[n]);return t}var Ye=[].concat;function bn(e){return Ye.apply([],e)}var et="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(bn([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(n){return n+e+"Array"})}))).filter(function(e){return D[e]}),I=new Set(et.map(function(e){return D[e]})),l=null;function V(e){return l=new WeakMap,e=function n(t){if(!t||typeof t!="object")return t;var r=l.get(t);if(r)return r;if(A(t)){r=[],l.set(t,r);for(var i=0,a=t.length;i<a;++i)r.push(n(t[i]))}else if(I.has(t.constructor))r=t;else{var c,p=te(t);for(c in r=p===Object.prototype?{}:Object.create(p),l.set(t,r),t)k(t,c)&&(r[c]=n(t[c]))}return r}(e),l=null,e}var R={}.toString;function Ne(e){return R.call(e).slice(8,-1)}var ve=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Je=typeof ve=="symbol"?function(e){var n;return e!=null&&(n=e[ve])&&n.apply(e)}:function(){return null};function qe(e,n){return n=e.indexOf(n),0<=n&&e.splice(n,1),0<=n}var en={};function un(e){var n,t,r,i;if(arguments.length===1){if(A(e))return e.slice();if(this===en&&typeof e=="string")return[e];if(i=Je(e)){for(t=[];!(r=i.next()).done;)t.push(r.value);return t}if(e==null)return[e];if(typeof(n=e.length)!="number")return[e];for(t=new Array(n);n--;)t[n]=e[n];return t}for(n=arguments.length,t=new Array(n);n--;)t[n]=arguments[n];return t}var dn=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},On=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Jn=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(On),He={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ze(e,n){this.name=e,this.message=n}function wn(e,n){return e+". Errors: "+Object.keys(n).map(function(t){return n[t].toString()}).filter(function(t,r,i){return i.indexOf(t)===r}).join(`
`)}function En(e,n,t,r){this.failures=n,this.failedKeys=r,this.successCount=t,this.message=wn(e,n)}function pe(e,n){this.name="BulkError",this.failures=Object.keys(n).map(function(t){return n[t]}),this.failuresByPos=n,this.message=wn(e,this.failures)}Xe(ze).from(Error).extend({toString:function(){return this.name+": "+this.message}}),Xe(En).from(ze),Xe(pe).from(ze);var Qe=Jn.reduce(function(e,n){return e[n]=n+"Error",e},{}),An=ze,_=Jn.reduce(function(e,n){var t=n+"Error";function r(i,a){this.name=t,i?typeof i=="string"?(this.message="".concat(i).concat(a?`
 `+a:""),this.inner=a||null):typeof i=="object"&&(this.message="".concat(i.name," ").concat(i.message),this.inner=i):(this.message=He[n]||t,this.inner=null)}return Xe(r).from(An),e[n]=r,e},{});_.Syntax=SyntaxError,_.Type=TypeError,_.Range=RangeError;var F=On.reduce(function(e,n){return e[n+"Error"]=_[n],e},{}),q=Jn.reduce(function(e,n){return["Syntax","Type","Range"].indexOf(n)===-1&&(e[n+"Error"]=_[n]),e},{});function j(){}function H(e){return e}function Se(e,n){return e==null||e===H?n:function(t){return n(e(t))}}function me(e,n){return function(){e.apply(this,arguments),n.apply(this,arguments)}}function Te(e,n){return e===j?n:function(){var t=e.apply(this,arguments);t!==void 0&&(arguments[0]=t);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=n.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?me(r,this.onsuccess):r),i&&(this.onerror=this.onerror?me(i,this.onerror):i),a!==void 0?a:t}}function ue(e,n){return e===j?n:function(){e.apply(this,arguments);var t=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,n.apply(this,arguments),t&&(this.onsuccess=this.onsuccess?me(t,this.onsuccess):t),r&&(this.onerror=this.onerror?me(r,this.onerror):r)}}function mn(e,n){return e===j?n:function(t){var r=e.apply(this,arguments);g(t,r);var i=this.onsuccess,a=this.onerror;return this.onsuccess=null,this.onerror=null,t=n.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?me(i,this.onsuccess):i),a&&(this.onerror=this.onerror?me(a,this.onerror):a),r===void 0?t===void 0?void 0:t:g(r,t)}}function kn(e,n){return e===j?n:function(){return n.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function _n(e,n){return e===j?n:function(){var t=e.apply(this,arguments);if(t&&typeof t.then=="function"){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return t.then(function(){return n.apply(r,a)})}return n.apply(this,arguments)}}q.ModifyError=En,q.DexieError=ze,q.BulkError=pe;var cn=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Fn(e){cn=e}var In={},Tn=100,et=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,te(e),e];var n=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[n,te(n),e]}(),On=et[0],Jn=et[1],et=et[2],Jn=Jn&&Jn.then,nn=On&&On.constructor,Me=!!et,Pe=function(e,n){w.push([e,n]),tn&&(queueMicrotask(je),tn=!1)},Ve=!0,tn=!0,ie=[],s=[],o=H,u={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:j,pgp:!1,env:{},finalize:j},f=u,w=[],G=0,Q=[];function B(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var n=this._PSD=f;if(typeof e!="function"){if(e!==In)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&we(this,this._value))}this._state=null,this._value=null,++n.ref,function t(r,i){try{i(function(a){if(r._state===null){if(a===r)throw new TypeError("A promise cannot be resolved with itself.");var c=r._lib&&Re();a&&typeof a.then=="function"?t(r,function(p,v){a instanceof B?a._then(p,v):a.then(p,v)}):(r._state=!0,r._value=a,xe(r)),c&&De()}},we.bind(null,r))}catch(a){we(r,a)}}(this,e)}var ne={get:function(){var e=f,n=_e;function t(r,i){var a=this,c=!e.global&&(e!==f||n!==_e),p=c&&!pn(),v=new B(function(d,O){Ke(a,new ce(qn(r,e,c,p),qn(i,e,c,p),d,O,e))});return this._consoleTask&&(v._consoleTask=this._consoleTask),v}return t.prototype=In,t},set:function(e){Ge(this,"then",e&&e.prototype===In?ne:{get:function(){return e},set:ne.set})}};function ce(e,n,t,r,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof n=="function"?n:null,this.resolve=t,this.reject=r,this.psd=i}function we(e,n){var t,r;s.push(n),e._state===null&&(t=e._lib&&Re(),n=o(n),e._state=!1,e._value=n,r=e,ie.some(function(i){return i._value===r._value})||ie.push(r),xe(e),t&&De())}function xe(e){var n=e._listeners;e._listeners=[];for(var t=0,r=n.length;t<r;++t)Ke(e,n[t]);var i=e._PSD;--i.ref||i.finalize(),G===0&&(++G,Pe(function(){--G==0&&de()},[]))}function Ke(e,n){if(e._state!==null){var t=e._state?n.onFulfilled:n.onRejected;if(t===null)return(e._state?n.resolve:n.reject)(e._value);++n.psd.ref,++G,Pe(Ie,[t,e,n])}else e._listeners.push(n)}function Ie(e,n,t){try{var r,i=n._value;!n._state&&s.length&&(s=[]),r=cn&&n._consoleTask?n._consoleTask.run(function(){return e(i)}):e(i),n._state||s.indexOf(i)!==-1||function(a){for(var c=ie.length;c;)if(ie[--c]._value===a._value)return ie.splice(c,1)}(n),t.resolve(r)}catch(a){t.reject(a)}finally{--G==0&&de(),--t.psd.ref||t.psd.finalize()}}function je(){sn(u,function(){Re()&&De()})}function Re(){var e=Ve;return tn=Ve=!1,e}function De(){var e,n,t;do for(;0<w.length;)for(e=w,w=[],t=e.length,n=0;n<t;++n){var r=e[n];r[0].apply(null,r[1])}while(0<w.length);tn=Ve=!0}function de(){var e=ie;ie=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var n=Q.slice(0),t=n.length;t;)n[--t]()}function ln(e){return new B(In,!1,e)}function z(e,n){var t=f;return function(){var r=Re(),i=f;try{return Be(t,!0),e.apply(this,arguments)}catch(a){n&&n(a)}finally{Be(i,!1),r&&De()}}}W(B.prototype,{then:ne,_then:function(e,n){Ke(this,new ce(null,null,e,n,f))},catch:function(e){if(arguments.length===1)return this.then(null,e);var n=e,t=arguments[1];return typeof n=="function"?this.then(null,function(r){return(r instanceof n?t:ln)(r)}):this.then(null,function(r){return(r&&r.name===n?t:ln)(r)})},finally:function(e){return this.then(function(n){return B.resolve(e()).then(function(){return n})},function(n){return B.resolve(e()).then(function(){return ln(n)})})},timeout:function(e,n){var t=this;return e<1/0?new B(function(r,i){var a=setTimeout(function(){return i(new _.Timeout(n))},e);t.then(r,i).finally(clearTimeout.bind(null,a))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Ge(B.prototype,Symbol.toStringTag,"Dexie.Promise"),u.env=Pn(),W(B,{all:function(){var e=un.apply(null,arguments).map(Ue);return new B(function(n,t){e.length===0&&n([]);var r=e.length;e.forEach(function(i,a){return B.resolve(i).then(function(c){e[a]=c,--r||n(e)},t)})})},resolve:function(e){return e instanceof B?e:e&&typeof e.then=="function"?new B(function(n,t){e.then(n,t)}):new B(In,!0,e)},reject:ln,race:function(){var e=un.apply(null,arguments).map(Ue);return new B(function(n,t){e.map(function(r){return B.resolve(r).then(n,t)})})},PSD:{get:function(){return f},set:function(e){return f=e}},totalEchoes:{get:function(){return _e}},newPSD:We,usePSD:sn,scheduler:{get:function(){return Pe},set:function(e){Pe=e}},rejectionMapper:{get:function(){return o},set:function(e){o=e}},follow:function(e,n){return new B(function(t,r){return We(function(i,a){var c=f;c.unhandleds=[],c.onunhandled=a,c.finalize=me(function(){var p,v=this;p=function(){v.unhandleds.length===0?i():a(v.unhandleds[0])},Q.push(function d(){p(),Q.splice(Q.indexOf(d),1)}),++G,Pe(function(){--G==0&&de()},[])},c.finalize),e()},n,t,r)})}}),nn&&(nn.allSettled&&Ge(B,"allSettled",function(){var e=un.apply(null,arguments).map(Ue);return new B(function(n){e.length===0&&n([]);var t=e.length,r=new Array(t);e.forEach(function(i,a){return B.resolve(i).then(function(c){return r[a]={status:"fulfilled",value:c}},function(c){return r[a]={status:"rejected",reason:c}}).then(function(){return--t||n(r)})})})}),nn.any&&typeof AggregateError<"u"&&Ge(B,"any",function(){var e=un.apply(null,arguments).map(Ue);return new B(function(n,t){e.length===0&&t(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(a,c){return B.resolve(a).then(function(p){return n(p)},function(p){i[c]=p,--r||t(new AggregateError(i))})})})}));var M={awaits:0,echoes:0,id:0},le=0,ae=[],fe=0,_e=0,Bn=0;function We(e,n,t,r){var i=f,a=Object.create(i);return a.parent=i,a.ref=0,a.global=!1,a.id=++Bn,u.env,a.env=Me?{Promise:B,PromiseProp:{value:B,configurable:!0,writable:!0},all:B.all,race:B.race,allSettled:B.allSettled,any:B.any,resolve:B.resolve,reject:B.reject}:{},n&&g(a,n),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()},r=sn(a,e,t,r),a.ref===0&&a.finalize(),r}function fn(){return M.id||(M.id=++le),++M.awaits,M.echoes+=Tn,M.id}function pn(){return!!M.awaits&&(--M.awaits==0&&(M.id=0),M.echoes=M.awaits*Tn,!0)}function Ue(e){return M.echoes&&e&&e.constructor===nn?(fn(),e.then(function(n){return pn(),n},function(n){return pn(),on(n)})):e}function Ln(){var e=ae[ae.length-1];ae.pop(),Be(e,!1)}function Be(e,n){var t,r=f;(n?!M.echoes||fe++&&e===f:!fe||--fe&&e===f)||queueMicrotask(n?function(i){++_e,M.echoes&&--M.echoes!=0||(M.echoes=M.awaits=M.id=0),ae.push(f),Be(i,!0)}.bind(null,e):Ln),e!==f&&(f=e,r===u&&(u.env=Pn()),Me&&(t=u.env.Promise,n=e.env,(r.global||e.global)&&(Object.defineProperty(D,"Promise",n.PromiseProp),t.all=n.all,t.race=n.race,t.resolve=n.resolve,t.reject=n.reject,n.allSettled&&(t.allSettled=n.allSettled),n.any&&(t.any=n.any))))}function Pn(){var e=D.Promise;return Me?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(D,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function sn(e,n,t,r,i){var a=f;try{return Be(e,!0),n(t,r,i)}finally{Be(a,!1)}}function qn(e,n,t,r){return typeof e!="function"?e:function(){var i=f;t&&fn(),Be(n,!0);try{return e.apply(this,arguments)}finally{Be(i,!1),r&&queueMicrotask(pn)}}}function Kn(e){Promise===nn&&M.echoes===0?fe===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+Jn).indexOf("[native code]")===-1&&(fn=pn=j);var on=B.reject,$n="\uFFFF",Cn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",lt="String expected.",Rn=[],yn="__dbnames",Mn="readonly",Wn="readwrite";function Yn(e,n){return e?n?function(){return e.apply(this,arguments)&&n.apply(this,arguments)}:e:n}var Br={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function At(e){return typeof e!="string"||/\./.test(e)?function(n){return n}:function(n){return n[e]===void 0&&e in n&&delete(n=V(n))[e],n}}function Kr(){throw _.Type()}function Fe(e,n){try{var t=Rr(e),r=Rr(n);if(t!==r)return t==="Array"?1:r==="Array"?-1:t==="binary"?1:r==="binary"?-1:t==="string"?1:r==="string"?-1:t==="Date"?1:r!=="Date"?NaN:-1;switch(t){case"number":case"Date":case"string":return n<e?1:e<n?-1:0;case"binary":return function(i,a){for(var c=i.length,p=a.length,v=c<p?c:p,d=0;d<v;++d)if(i[d]!==a[d])return i[d]<a[d]?-1:1;return c===p?0:c<p?-1:1}(Dr(e),Dr(n));case"Array":return function(i,a){for(var c=i.length,p=a.length,v=c<p?c:p,d=0;d<v;++d){var O=Fe(i[d],a[d]);if(O!==0)return O}return c===p?0:c<p?-1:1}(e,n)}}catch{}return NaN}function Rr(e){var n=typeof e;return n!="object"?n:ArrayBuffer.isView(e)?"binary":(e=Ne(e),e==="ArrayBuffer"?"binary":e)}function Dr(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var Ur=(an.prototype._trans=function(e,n,t){var r=this._tx||f.trans,i=this.name,a=cn&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function c(d,O,h){if(!h.schema[i])throw new _.NotFound("Table "+i+" not part of transaction");return n(h.idbtrans,h)}var p=Re();try{var v=r&&r.db._novip===this.db._novip?r===f.trans?r._promise(e,c,t):We(function(){return r._promise(e,c,t)},{trans:r,transless:f.transless||f}):function d(O,h,S,y){if(O.idbdb&&(O._state.openComplete||f.letThrough||O._vip)){var b=O._createTransaction(h,S,O._dbSchema);try{b.create(),O._state.PR1398_maxLoop=3}catch(x){return x.name===Qe.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return d(O,h,S,y)})):on(x)}return b._promise(h,function(x,m){return We(function(){return f.trans=b,y(x,m,b)})}).then(function(x){if(h==="readwrite")try{b.idbtrans.commit()}catch{}return h==="readonly"?x:b._completion.then(function(){return x})})}if(O._state.openComplete)return on(new _.DatabaseClosed(O._state.dbOpenError));if(!O._state.isBeingOpened){if(!O._state.autoOpen)return on(new _.DatabaseClosed);O.open().catch(j)}return O._state.dbReadyPromise.then(function(){return d(O,h,S,y)})}(this.db,e,[this.name],c);return a&&(v._consoleTask=a,v=v.catch(function(d){return console.trace(d),on(d)})),v}finally{p&&De()}},an.prototype.get=function(e,n){var t=this;return e&&e.constructor===Object?this.where(e).first(n):e==null?on(new _.Type("Invalid argument to Table.get()")):this._trans("readonly",function(r){return t.core.get({trans:r,key:e}).then(function(i){return t.hook.reading.fire(i)})}).then(n)},an.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(A(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var n=L(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);var t=this.schema.indexes.concat(this.schema.primKey).filter(function(v){if(v.compound&&n.every(function(O){return 0<=v.keyPath.indexOf(O)})){for(var d=0;d<n.length;++d)if(n.indexOf(v.keyPath[d])===-1)return!1;return!0}return!1}).sort(function(v,d){return v.keyPath.length-d.keyPath.length})[0];if(t&&this.db._maxKey!==$n){var c=t.keyPath.slice(0,n.length);return this.where(c).equals(c.map(function(d){return e[d]}))}!t&&cn&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(n.join("+"),"]"));var r=this.schema.idxByName,i=this.db._deps.indexedDB;function a(v,d){return i.cmp(v,d)===0}var p=n.reduce(function(S,d){var O=S[0],h=S[1],S=r[d],y=e[d];return[O||S,O||!S?Yn(h,S&&S.multi?function(b){return b=rn(b,d),A(b)&&b.some(function(x){return a(y,x)})}:function(b){return a(y,rn(b,d))}):h]},[null,null]),c=p[0],p=p[1];return c?this.where(c.name).equals(e[c.keyPath]).filter(p):t?this.filter(p):this.where(n).equals("")},an.prototype.filter=function(e){return this.toCollection().and(e)},an.prototype.count=function(e){return this.toCollection().count(e)},an.prototype.offset=function(e){return this.toCollection().offset(e)},an.prototype.limit=function(e){return this.toCollection().limit(e)},an.prototype.each=function(e){return this.toCollection().each(e)},an.prototype.toArray=function(e){return this.toCollection().toArray(e)},an.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},an.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,A(e)?"[".concat(e.join("+"),"]"):e))},an.prototype.reverse=function(){return this.toCollection().reverse()},an.prototype.mapToClass=function(e){var n,t=this.db,r=this.name;function i(){return n!==null&&n.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof Kr&&(function(v,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");function O(){this.constructor=v}K(v,d),v.prototype=d===null?Object.create(d):(O.prototype=d.prototype,new O)}(i,n=e),Object.defineProperty(i.prototype,"db",{get:function(){return t},enumerable:!1,configurable:!0}),i.prototype.table=function(){return r},e=i);for(var a=new Set,c=e.prototype;c;c=te(c))Object.getOwnPropertyNames(c).forEach(function(v){return a.add(v)});function p(v){if(!v)return v;var d,O=Object.create(e.prototype);for(d in v)if(!a.has(d))try{O[d]=v[d]}catch{}return O}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=p,this.hook("reading",p),e},an.prototype.defineClass=function(){return this.mapToClass(function(e){g(this,e)})},an.prototype.add=function(e,n){var t=this,r=this.schema.primKey,i=r.auto,a=r.keyPath,c=e;return a&&i&&(c=At(a)(e)),this._trans("readwrite",function(p){return t.core.mutate({trans:p,type:"add",keys:n!=null?[n]:null,values:[c]})}).then(function(p){return p.numFailures?B.reject(p.failures[0]):p.lastResult}).then(function(p){if(a)try{oe(e,a,p)}catch{}return p})},an.prototype.update=function(e,n){return typeof e!="object"||A(e)?this.where(":id").equals(e).modify(n):(e=rn(e,this.schema.primKey.keyPath),e===void 0?on(new _.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(n))},an.prototype.put=function(e,n){var t=this,r=this.schema.primKey,i=r.auto,a=r.keyPath,c=e;return a&&i&&(c=At(a)(e)),this._trans("readwrite",function(p){return t.core.mutate({trans:p,type:"put",values:[c],keys:n!=null?[n]:null})}).then(function(p){return p.numFailures?B.reject(p.failures[0]):p.lastResult}).then(function(p){if(a)try{oe(e,a,p)}catch{}return p})},an.prototype.delete=function(e){var n=this;return this._trans("readwrite",function(t){return n.core.mutate({trans:t,type:"delete",keys:[e]})}).then(function(t){return t.numFailures?B.reject(t.failures[0]):void 0})},an.prototype.clear=function(){var e=this;return this._trans("readwrite",function(n){return e.core.mutate({trans:n,type:"deleteRange",range:Br})}).then(function(n){return n.numFailures?B.reject(n.failures[0]):void 0})},an.prototype.bulkGet=function(e){var n=this;return this._trans("readonly",function(t){return n.core.getMany({keys:e,trans:t}).then(function(r){return r.map(function(i){return n.hook.reading.fire(i)})})})},an.prototype.bulkAdd=function(e,n,t){var r=this,i=Array.isArray(n)?n:void 0,a=(t=t||(i?void 0:n))?t.allKeys:void 0;return this._trans("readwrite",function(c){var d=r.schema.primKey,p=d.auto,d=d.keyPath;if(d&&i)throw new _.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new _.InvalidArgument("Arguments objects and keys must have the same length");var v=e.length,d=d&&p?e.map(At(d)):e;return r.core.mutate({trans:c,type:"add",keys:i,values:d,wantResults:a}).then(function(b){var h=b.numFailures,S=b.results,y=b.lastResult,b=b.failures;if(h===0)return a?S:y;throw new pe("".concat(r.name,".bulkAdd(): ").concat(h," of ").concat(v," operations failed"),b)})})},an.prototype.bulkPut=function(e,n,t){var r=this,i=Array.isArray(n)?n:void 0,a=(t=t||(i?void 0:n))?t.allKeys:void 0;return this._trans("readwrite",function(c){var d=r.schema.primKey,p=d.auto,d=d.keyPath;if(d&&i)throw new _.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new _.InvalidArgument("Arguments objects and keys must have the same length");var v=e.length,d=d&&p?e.map(At(d)):e;return r.core.mutate({trans:c,type:"put",keys:i,values:d,wantResults:a}).then(function(b){var h=b.numFailures,S=b.results,y=b.lastResult,b=b.failures;if(h===0)return a?S:y;throw new pe("".concat(r.name,".bulkPut(): ").concat(h," of ").concat(v," operations failed"),b)})})},an.prototype.bulkUpdate=function(e){var n=this,t=this.core,r=e.map(function(c){return c.key}),i=e.map(function(c){return c.changes}),a=[];return this._trans("readwrite",function(c){return t.getMany({trans:c,keys:r,cache:"clone"}).then(function(p){var v=[],d=[];e.forEach(function(h,S){var y=h.key,b=h.changes,x=p[S];if(x){for(var m=0,P=Object.keys(b);m<P.length;m++){var C=P[m],N=b[C];if(C===n.schema.primKey.keyPath){if(Fe(N,y)!==0)throw new _.Constraint("Cannot update primary key in bulkUpdate()")}else oe(x,C,N)}a.push(S),v.push(y),d.push(x)}});var O=v.length;return t.mutate({trans:c,type:"put",keys:v,values:d,updates:{keys:r,changeSpecs:i}}).then(function(h){var S=h.numFailures,y=h.failures;if(S===0)return O;for(var b=0,x=Object.keys(y);b<x.length;b++){var m,P=x[b],C=a[Number(P)];C!=null&&(m=y[P],delete y[P],y[C]=m)}throw new pe("".concat(n.name,".bulkUpdate(): ").concat(S," of ").concat(O," operations failed"),y)})})})},an.prototype.bulkDelete=function(e){var n=this,t=e.length;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:e})}).then(function(c){var i=c.numFailures,a=c.lastResult,c=c.failures;if(i===0)return a;throw new pe("".concat(n.name,".bulkDelete(): ").concat(i," of ").concat(t," operations failed"),c)})},an);function an(){}function yt(e){function n(c,p){if(p){for(var v=arguments.length,d=new Array(v-1);--v;)d[v-1]=arguments[v];return t[c].subscribe.apply(null,d),e}if(typeof c=="string")return t[c]}var t={};n.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return n;function a(c,p,v){if(typeof c!="object"){var d;p=p||kn;var O={subscribers:[],fire:v=v||j,subscribe:function(h){O.subscribers.indexOf(h)===-1&&(O.subscribers.push(h),O.fire=p(O.fire,h))},unsubscribe:function(h){O.subscribers=O.subscribers.filter(function(S){return S!==h}),O.fire=O.subscribers.reduce(p,v)}};return t[c]=n[c]=O}L(d=c).forEach(function(h){var S=d[h];if(A(S))a(h,d[h][0],d[h][1]);else{if(S!=="asap")throw new _.InvalidArgument("Invalid event config");var y=a(h,H,function(){for(var b=arguments.length,x=new Array(b);b--;)x[b]=arguments[b];y.subscribers.forEach(function(m){re(function(){m.apply(null,x)})})})}})}}function vt(e,n){return Xe(n).from({prototype:e}),n}function ft(e,n){return!(e.filter||e.algorithm||e.or)&&(n?e.justLimit:!e.replayFilter)}function Xt(e,n){e.filter=Yn(e.filter,n)}function Zt(e,n,t){var r=e.replayFilter;e.replayFilter=r?function(){return Yn(r(),n())}:n,e.justLimit=t&&!r}function kt(e,n){if(e.isPrimKey)return n.primaryKey;var t=n.getIndexByKeyPath(e.index);if(!t)throw new _.Schema("KeyPath "+e.index+" on object store "+n.name+" is not indexed");return t}function Fr(e,n,t){var r=kt(e,n.schema);return n.openCursor({trans:t,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function Tt(e,n,t,r){var i=e.replayFilter?Yn(e.filter,e.replayFilter()):e.filter;if(e.or){var a={},c=function(p,v,d){var O,h;i&&!i(v,d,function(S){return v.stop(S)},function(S){return v.fail(S)})||((h=""+(O=v.primaryKey))=="[object ArrayBuffer]"&&(h=""+new Uint8Array(O)),k(a,h)||(a[h]=!0,n(p,v,d)))};return Promise.all([e.or._iterate(c,t),Lr(Fr(e,r,t),e.algorithm,c,!e.keysOnly&&e.valueMapper)])}return Lr(Fr(e,r,t),Yn(e.algorithm,i),n,!e.keysOnly&&e.valueMapper)}function Lr(e,n,t,r){var i=z(r?function(a,c,p){return t(r(a),c,p)}:t);return e.then(function(a){if(a)return a.start(function(){var c=function(){return a.continue()};n&&!n(a,function(p){return c=p},function(p){a.stop(p),c=j},function(p){a.fail(p),c=j})||i(a.value,a,function(p){return c=p}),c()})})}var et=Symbol(),mt=(qr.prototype.execute=function(e){if(this.add!==void 0){var n=this.add;if(A(n))return T(T([],A(e)?e:[],!0),n,!0).sort();if(typeof n=="number")return(Number(e)||0)+n;if(typeof n=="bigint")try{return BigInt(e)+n}catch{return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(this.remove!==void 0){var t=this.remove;if(A(t))return A(e)?e.filter(function(r){return!t.includes(r)}).sort():[];if(typeof t=="number")return Number(e)-t;if(typeof t=="bigint")try{return BigInt(e)-t}catch{return BigInt(0)-t}throw new TypeError("Invalid subtrahend ".concat(t))}return n=(n=this.replacePrefix)===null||n===void 0?void 0:n[0],n&&typeof e=="string"&&e.startsWith(n)?this.replacePrefix[1]+e.substring(n.length):e},qr);function qr(e){Object.assign(this,e)}var mi=($e.prototype._read=function(e,n){var t=this._ctx;return t.error?t.table._trans(null,on.bind(null,t.error)):t.table._trans("readonly",e).then(n)},$e.prototype._write=function(e){var n=this._ctx;return n.error?n.table._trans(null,on.bind(null,n.error)):n.table._trans("readwrite",e,"locked")},$e.prototype._addAlgorithm=function(e){var n=this._ctx;n.algorithm=Yn(n.algorithm,e)},$e.prototype._iterate=function(e,n){return Tt(this._ctx,e,n,this._ctx.table.core)},$e.prototype.clone=function(e){var n=Object.create(this.constructor.prototype),t=Object.create(this._ctx);return e&&g(t,e),n._ctx=t,n},$e.prototype.raw=function(){return this._ctx.valueMapper=null,this},$e.prototype.each=function(e){var n=this._ctx;return this._read(function(t){return Tt(n,e,t,n.table.core)})},$e.prototype.count=function(e){var n=this;return this._read(function(t){var r=n._ctx,i=r.table.core;if(ft(r,!0))return i.count({trans:t,query:{index:kt(r,i.schema),range:r.range}}).then(function(c){return Math.min(c,r.limit)});var a=0;return Tt(r,function(){return++a,!1},t,i).then(function(){return a})}).then(e)},$e.prototype.sortBy=function(e,n){var t=e.split(".").reverse(),r=t[0],i=t.length-1;function a(v,d){return d?a(v[t[d]],d-1):v[r]}var c=this._ctx.dir==="next"?1:-1;function p(v,d){return v=a(v,i),d=a(d,i),v<d?-c:d<v?c:0}return this.toArray(function(v){return v.sort(p)}).then(n)},$e.prototype.toArray=function(e){var n=this;return this._read(function(t){var r=n._ctx;if(r.dir==="next"&&ft(r,!0)&&0<r.limit){var i=r.valueMapper,a=kt(r,r.table.core.schema);return r.table.core.query({trans:t,limit:r.limit,values:!0,query:{index:a,range:r.range}}).then(function(p){return p=p.result,i?p.map(i):p})}var c=[];return Tt(r,function(p){return c.push(p)},t,r.table.core).then(function(){return c})},e)},$e.prototype.offset=function(e){var n=this._ctx;return e<=0||(n.offset+=e,ft(n)?Zt(n,function(){var t=e;return function(r,i){return t===0||(t===1?--t:i(function(){r.advance(t),t=0}),!1)}}):Zt(n,function(){var t=e;return function(){return--t<0}})),this},$e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Zt(this._ctx,function(){var n=e;return function(t,r,i){return--n<=0&&r(i),0<=n}},!0),this},$e.prototype.until=function(e,n){return Xt(this._ctx,function(t,r,i){return!e(t.value)||(r(i),n)}),this},$e.prototype.first=function(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)},$e.prototype.last=function(e){return this.reverse().first(e)},$e.prototype.filter=function(e){var n;return Xt(this._ctx,function(t){return e(t.value)}),(n=this._ctx).isMatch=Yn(n.isMatch,e),this},$e.prototype.and=function(e){return this.filter(e)},$e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},$e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},$e.prototype.desc=function(){return this.reverse()},$e.prototype.eachKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(t,r){e(r.key,r)})},$e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},$e.prototype.eachPrimaryKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(t,r){e(r.primaryKey,r)})},$e.prototype.keys=function(e){var n=this._ctx;n.keysOnly=!n.isMatch;var t=[];return this.each(function(r,i){t.push(i.key)}).then(function(){return t}).then(e)},$e.prototype.primaryKeys=function(e){var n=this._ctx;if(n.dir==="next"&&ft(n,!0)&&0<n.limit)return this._read(function(r){var i=kt(n,n.table.core.schema);return n.table.core.query({trans:r,values:!1,limit:n.limit,query:{index:i,range:n.range}})}).then(function(r){return r.result}).then(e);n.keysOnly=!n.isMatch;var t=[];return this.each(function(r,i){t.push(i.primaryKey)}).then(function(){return t}).then(e)},$e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},$e.prototype.firstKey=function(e){return this.limit(1).keys(function(n){return n[0]}).then(e)},$e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},$e.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var n={};return Xt(this._ctx,function(i){var r=i.primaryKey.toString(),i=k(n,r);return n[r]=!0,!i}),this},$e.prototype.modify=function(e){var n=this,t=this._ctx;return this._write(function(r){var i,a,c;c=typeof e=="function"?e:(i=L(e),a=i.length,function(m){for(var P=!1,C=0;C<a;++C){var N=i[C],U=e[N],Y=rn(m,N);U instanceof mt?(oe(m,N,U.execute(Y)),P=!0):Y!==U&&(oe(m,N,U),P=!0)}return P});function p(m,N){var C=N.failures,N=N.numFailures;b+=m-N;for(var U=0,Y=L(C);U<Y.length;U++){var Z=Y[U];y.push(C[Z])}}var v=t.table.core,d=v.schema.primaryKey,O=d.outbound,h=d.extractKey,S=n.db._options.modifyChunkSize||200,y=[],b=0,x=[];return n.clone().primaryKeys().then(function(m){function P(N){var U=Math.min(S,m.length-N);return v.getMany({trans:r,keys:m.slice(N,N+U),cache:"immutable"}).then(function(Y){for(var Z=[],J=[],X=O?[]:null,ee=[],$=0;$<U;++$){var ye=Y[$],be={value:V(ye),primKey:m[N+$]};c.call(be,be.value,be)!==!1&&(be.value==null?ee.push(m[N+$]):O||Fe(h(ye),h(be.value))===0?(J.push(be.value),O&&X.push(m[N+$])):(ee.push(m[N+$]),Z.push(be.value)))}return Promise.resolve(0<Z.length&&v.mutate({trans:r,type:"add",values:Z}).then(function(ke){for(var Ee in ke.failures)ee.splice(parseInt(Ee),1);p(Z.length,ke)})).then(function(){return(0<J.length||C&&typeof e=="object")&&v.mutate({trans:r,type:"put",keys:X,values:J,criteria:C,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<N}).then(function(ke){return p(J.length,ke)})}).then(function(){return(0<ee.length||C&&e===er)&&v.mutate({trans:r,type:"delete",keys:ee,criteria:C,isAdditionalChunk:0<N}).then(function(ke){return p(ee.length,ke)})}).then(function(){return m.length>N+U&&P(N+S)})})}var C=ft(t)&&t.limit===1/0&&(typeof e!="function"||e===er)&&{index:t.index,range:t.range};return P(0).then(function(){if(0<y.length)throw new En("Error modifying one or more objects",y,b,x);return m.length})})})},$e.prototype.delete=function(){var e=this._ctx,n=e.range;return ft(e)&&(e.isPrimKey||n.type===3)?this._write(function(t){var r=e.table.core.schema.primaryKey,i=n;return e.table.core.count({trans:t,query:{index:r,range:i}}).then(function(a){return e.table.core.mutate({trans:t,type:"deleteRange",range:i}).then(function(c){var p=c.failures;if(c.lastResult,c.results,c=c.numFailures,c)throw new En("Could not delete some values",Object.keys(p).map(function(v){return p[v]}),a-c);return a-c})})}):this.modify(er)},$e);function $e(){}var er=function(e,n){return n.value=null};function bi(e,n){return e<n?-1:e===n?0:1}function gi(e,n){return n<e?-1:e===n?0:1}function Vn(e,n,t){return e=e instanceof Vr?new e.Collection(e):e,e._ctx.error=new(t||TypeError)(n),e}function pt(e){return new e.Collection(e,function(){return Mr("")}).limit(0)}function Pt(e,n,t,r){var i,a,c,p,v,d,O,h=t.length;if(!t.every(function(b){return typeof b=="string"}))return Vn(e,lt);function S(b){i=b==="next"?function(m){return m.toUpperCase()}:function(m){return m.toLowerCase()},a=b==="next"?function(m){return m.toLowerCase()}:function(m){return m.toUpperCase()},c=b==="next"?bi:gi;var x=t.map(function(m){return{lower:a(m),upper:i(m)}}).sort(function(m,P){return c(m.lower,P.lower)});p=x.map(function(m){return m.upper}),v=x.map(function(m){return m.lower}),O=(d=b)==="next"?"":r}S("next"),e=new e.Collection(e,function(){return rt(p[0],v[h-1]+r)}),e._ondirectionchange=function(b){S(b)};var y=0;return e._addAlgorithm(function(b,x,m){var P=b.key;if(typeof P!="string")return!1;var C=a(P);if(n(C,v,y))return!0;for(var N=null,U=y;U<h;++U){var Y=function(Z,J,X,ee,$,ye){for(var be=Math.min(Z.length,ee.length),ke=-1,Ee=0;Ee<be;++Ee){var Hn=J[Ee];if(Hn!==ee[Ee])return $(Z[Ee],X[Ee])<0?Z.substr(0,Ee)+X[Ee]+X.substr(Ee+1):$(Z[Ee],ee[Ee])<0?Z.substr(0,Ee)+ee[Ee]+X.substr(Ee+1):0<=ke?Z.substr(0,ke)+J[ke]+X.substr(ke+1):null;$(Z[Ee],Hn)<0&&(ke=Ee)}return be<ee.length&&ye==="next"?Z+X.substr(Z.length):be<Z.length&&ye==="prev"?Z.substr(0,X.length):ke<0?null:Z.substr(0,ke)+ee[ke]+X.substr(ke+1)}(P,C,p[U],v[U],c,d);Y===null&&N===null?y=U+1:(N===null||0<c(N,Y))&&(N=Y)}return x(N!==null?function(){b.continue(N+O)}:m),!1}),e}function rt(e,n,t,r){return{type:2,lower:e,upper:n,lowerOpen:t,upperOpen:r}}function Mr(e){return{type:1,lower:e,upper:e}}var Vr=(Object.defineProperty(gn.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),gn.prototype.between=function(e,n,t,r){t=t!==!1,r=r===!0;try{return 0<this._cmp(e,n)||this._cmp(e,n)===0&&(t||r)&&(!t||!r)?pt(this):new this.Collection(this,function(){return rt(e,n,!t,!r)})}catch{return Vn(this,Cn)}},gn.prototype.equals=function(e){return e==null?Vn(this,Cn):new this.Collection(this,function(){return Mr(e)})},gn.prototype.above=function(e){return e==null?Vn(this,Cn):new this.Collection(this,function(){return rt(e,void 0,!0)})},gn.prototype.aboveOrEqual=function(e){return e==null?Vn(this,Cn):new this.Collection(this,function(){return rt(e,void 0,!1)})},gn.prototype.below=function(e){return e==null?Vn(this,Cn):new this.Collection(this,function(){return rt(void 0,e,!1,!0)})},gn.prototype.belowOrEqual=function(e){return e==null?Vn(this,Cn):new this.Collection(this,function(){return rt(void 0,e)})},gn.prototype.startsWith=function(e){return typeof e!="string"?Vn(this,lt):this.between(e,e+$n,!0,!0)},gn.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):Pt(this,function(n,t){return n.indexOf(t[0])===0},[e],$n)},gn.prototype.equalsIgnoreCase=function(e){return Pt(this,function(n,t){return n===t[0]},[e],"")},gn.prototype.anyOfIgnoreCase=function(){var e=un.apply(en,arguments);return e.length===0?pt(this):Pt(this,function(n,t){return t.indexOf(n)!==-1},e,"")},gn.prototype.startsWithAnyOfIgnoreCase=function(){var e=un.apply(en,arguments);return e.length===0?pt(this):Pt(this,function(n,t){return t.some(function(r){return n.indexOf(r)===0})},e,$n)},gn.prototype.anyOf=function(){var e=this,n=un.apply(en,arguments),t=this._cmp;try{n.sort(t)}catch{return Vn(this,Cn)}if(n.length===0)return pt(this);var r=new this.Collection(this,function(){return rt(n[0],n[n.length-1])});r._ondirectionchange=function(a){t=a==="next"?e._ascending:e._descending,n.sort(t)};var i=0;return r._addAlgorithm(function(a,c,p){for(var v=a.key;0<t(v,n[i]);)if(++i===n.length)return c(p),!1;return t(v,n[i])===0||(c(function(){a.continue(n[i])}),!1)}),r},gn.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},gn.prototype.noneOf=function(){var e=un.apply(en,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Vn(this,Cn)}var n=e.reduce(function(t,r){return t?t.concat([[t[t.length-1][1],r]]):[[-1/0,r]]},null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},gn.prototype.inAnyRange=function(P,n){var t=this,r=this._cmp,i=this._ascending,a=this._descending,c=this._min,p=this._max;if(P.length===0)return pt(this);if(!P.every(function(C){return C[0]!==void 0&&C[1]!==void 0&&i(C[0],C[1])<=0}))return Vn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",_.InvalidArgument);var v=!n||n.includeLowers!==!1,d=n&&n.includeUppers===!0,O,h=i;function S(C,N){return h(C[0],N[0])}try{(O=P.reduce(function(C,N){for(var U=0,Y=C.length;U<Y;++U){var Z=C[U];if(r(N[0],Z[1])<0&&0<r(N[1],Z[0])){Z[0]=c(Z[0],N[0]),Z[1]=p(Z[1],N[1]);break}}return U===Y&&C.push(N),C},[])).sort(S)}catch{return Vn(this,Cn)}var y=0,b=d?function(C){return 0<i(C,O[y][1])}:function(C){return 0<=i(C,O[y][1])},x=v?function(C){return 0<a(C,O[y][0])}:function(C){return 0<=a(C,O[y][0])},m=b,P=new this.Collection(this,function(){return rt(O[0][0],O[O.length-1][1],!v,!d)});return P._ondirectionchange=function(C){h=C==="next"?(m=b,i):(m=x,a),O.sort(S)},P._addAlgorithm(function(C,N,U){for(var Y,Z=C.key;m(Z);)if(++y===O.length)return N(U),!1;return!b(Y=Z)&&!x(Y)||(t._cmp(Z,O[y][1])===0||t._cmp(Z,O[y][0])===0||N(function(){h===i?C.continue(O[y][0]):C.continue(O[y][1])}),!1)}),P},gn.prototype.startsWithAnyOf=function(){var e=un.apply(en,arguments);return e.every(function(n){return typeof n=="string"})?e.length===0?pt(this):this.inAnyRange(e.map(function(n){return[n,n+$n]})):Vn(this,"startsWithAnyOf() only works with strings")},gn);function gn(){}function Xn(e){return z(function(n){return bt(n),e(n.target.error),!1})}function bt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var gt="storagemutated",nr="x-storagemutated-1",it=yt(null,gt),wi=(Zn.prototype._lock=function(){return Ze(!f.global),++this._reculock,this._reculock!==1||f.global||(f.lockOwnerFor=this),this},Zn.prototype._unlock=function(){if(Ze(!f.global),--this._reculock==0)for(f.global||(f.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{sn(e[1],e[0])}catch{}}return this},Zn.prototype._locked=function(){return this._reculock&&f.lockOwnerFor!==this},Zn.prototype.create=function(e){var n=this;if(!this.mode)return this;var t=this.db.idbdb,r=this.db._state.dbOpenError;if(Ze(!this.idbtrans),!e&&!t)switch(r&&r.name){case"DatabaseClosedError":throw new _.DatabaseClosed(r);case"MissingAPIError":throw new _.MissingAPI(r.message,r);default:throw new _.OpenFailed(r)}if(!this.active)throw new _.TransactionInactive;return Ze(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||t).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=z(function(i){bt(i),n._reject(e.error)}),e.onabort=z(function(i){bt(i),n.active&&n._reject(new _.Abort(e.error)),n.active=!1,n.on("abort").fire(i)}),e.oncomplete=z(function(){n.active=!1,n._resolve(),"mutatedParts"in e&&it.storagemutated.fire(e.mutatedParts)}),this},Zn.prototype._promise=function(e,n,t){var r=this;if(e==="readwrite"&&this.mode!=="readwrite")return on(new _.ReadOnly("Transaction is readonly"));if(!this.active)return on(new _.TransactionInactive);if(this._locked())return new B(function(a,c){r._blockedFuncs.push([function(){r._promise(e,n,t).then(a,c)},f])});if(t)return We(function(){var a=new B(function(c,p){r._lock();var v=n(c,p,r);v&&v.then&&v.then(c,p)});return a.finally(function(){return r._unlock()}),a._lib=!0,a});var i=new B(function(a,c){var p=n(a,c,r);p&&p.then&&p.then(a,c)});return i._lib=!0,i},Zn.prototype._root=function(){return this.parent?this.parent._root():this},Zn.prototype.waitFor=function(e){var n,t=this._root(),r=B.resolve(e);t._waitingFor?t._waitingFor=t._waitingFor.then(function(){return r}):(t._waitingFor=r,t._waitingQueue=[],n=t.idbtrans.objectStore(t.storeNames[0]),function a(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(n.get(-1/0).onsuccess=a)}());var i=t._waitingFor;return new B(function(a,c){r.then(function(p){return t._waitingQueue.push(z(a.bind(null,p)))},function(p){return t._waitingQueue.push(z(c.bind(null,p)))}).finally(function(){t._waitingFor===i&&(t._waitingFor=null)})})},Zn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new _.Abort))},Zn.prototype.table=function(e){var n=this._memoizedTables||(this._memoizedTables={});if(k(n,e))return n[e];var t=this.schema[e];if(!t)throw new _.NotFound("Table "+e+" not part of transaction");return t=new this.db.Table(e,t,this),t.core=this.db.core.table(e),n[e]=t},Zn);function Zn(){}function tr(e,n,t,r,i,a,c){return{name:e,keyPath:n,unique:t,multi:r,auto:i,compound:a,src:(t&&!c?"&":"")+(r?"*":"")+(i?"++":"")+$r(n)}}function $r(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function rr(e,n,t){return{name:e,primKey:n,indexes:t,mappedClass:null,idxByName:(r=function(i){return[i.name,i]},t.reduce(function(i,a,c){return c=r(a,c),c&&(i[c[0]]=c[1]),i},{}))};var r}var wt=function(e){try{return e.only([[]]),wt=function(){return[[]]},[[]]}catch{return wt=function(){return $n},$n}};function ir(e){return e==null?function(){}:typeof e=="string"?(n=e).split(".").length===1?function(t){return t[n]}:function(t){return rn(t,n)}:function(t){return rn(t,e)};var n}function Yr(e){return[].slice.call(e)}var _i=0;function _t(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Oi(e,n,v){function r(m){if(m.type===3)return null;if(m.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var y=m.lower,b=m.upper,x=m.lowerOpen,m=m.upperOpen;return y===void 0?b===void 0?null:n.upperBound(b,!!m):b===void 0?n.lowerBound(y,!!x):n.bound(y,b,!!x,!!m)}function i(S){var y,b=S.name;return{name:b,schema:S,mutate:function(x){var m=x.trans,P=x.type,C=x.keys,N=x.values,U=x.range;return new Promise(function(Y,Z){Y=z(Y);var J=m.objectStore(b),X=J.keyPath==null,ee=P==="put"||P==="add";if(!ee&&P!=="delete"&&P!=="deleteRange")throw new Error("Invalid operation type: "+P);var $,ye=(C||N||{length:1}).length;if(C&&N&&C.length!==N.length)throw new Error("Given keys array must have same length as given values array.");if(ye===0)return Y({numFailures:0,failures:{},results:[],lastResult:void 0});function be(Un){++Hn,bt(Un)}var ke=[],Ee=[],Hn=0;if(P==="deleteRange"){if(U.type===4)return Y({numFailures:Hn,failures:Ee,results:[],lastResult:void 0});U.type===3?ke.push($=J.clear()):ke.push($=J.delete(r(U)))}else{var X=ee?X?[N,C]:[N,null]:[C,null],Ae=X[0],Nn=X[1];if(ee)for(var jn=0;jn<ye;++jn)ke.push($=Nn&&Nn[jn]!==void 0?J[P](Ae[jn],Nn[jn]):J[P](Ae[jn])),$.onerror=be;else for(jn=0;jn<ye;++jn)ke.push($=J[P](Ae[jn])),$.onerror=be}function Mt(Un){Un=Un.target.result,ke.forEach(function(ct,Or){return ct.error!=null&&(Ee[Or]=ct.error)}),Y({numFailures:Hn,failures:Ee,results:P==="delete"?C:ke.map(function(ct){return ct.result}),lastResult:Un})}$.onerror=function(Un){be(Un),Mt(Un)},$.onsuccess=Mt})},getMany:function(x){var m=x.trans,P=x.keys;return new Promise(function(C,N){C=z(C);for(var U,Y=m.objectStore(b),Z=P.length,J=new Array(Z),X=0,ee=0,$=function(ke){ke=ke.target,J[ke._pos]=ke.result,++ee===X&&C(J)},ye=Xn(N),be=0;be<Z;++be)P[be]!=null&&((U=Y.get(P[be]))._pos=be,U.onsuccess=$,U.onerror=ye,++X);X===0&&C(J)})},get:function(x){var m=x.trans,P=x.key;return new Promise(function(C,N){C=z(C);var U=m.objectStore(b).get(P);U.onsuccess=function(Y){return C(Y.target.result)},U.onerror=Xn(N)})},query:(y=d,function(x){return new Promise(function(m,P){m=z(m);var C,N,U,X=x.trans,Y=x.values,Z=x.limit,$=x.query,J=Z===1/0?void 0:Z,ee=$.index,$=$.range,X=X.objectStore(b),ee=ee.isPrimaryKey?X:X.index(ee.name),$=r($);if(Z===0)return m({result:[]});y?((J=Y?ee.getAll($,J):ee.getAllKeys($,J)).onsuccess=function(ye){return m({result:ye.target.result})},J.onerror=Xn(P)):(C=0,N=!Y&&"openKeyCursor"in ee?ee.openKeyCursor($):ee.openCursor($),U=[],N.onsuccess=function(ye){var be=N.result;return be?(U.push(Y?be.value:be.primaryKey),++C===Z?m({result:U}):void be.continue()):m({result:U})},N.onerror=Xn(P))})}),openCursor:function(x){var m=x.trans,P=x.values,C=x.query,N=x.reverse,U=x.unique;return new Promise(function(Y,Z){Y=z(Y);var ee=C.index,J=C.range,X=m.objectStore(b),X=ee.isPrimaryKey?X:X.index(ee.name),ee=N?U?"prevunique":"prev":U?"nextunique":"next",$=!P&&"openKeyCursor"in X?X.openKeyCursor(r(J),ee):X.openCursor(r(J),ee);$.onerror=Xn(Z),$.onsuccess=z(function(ye){var be,ke,Ee,Hn,Ae=$.result;Ae?(Ae.___id=++_i,Ae.done=!1,be=Ae.continue.bind(Ae),ke=(ke=Ae.continuePrimaryKey)&&ke.bind(Ae),Ee=Ae.advance.bind(Ae),Hn=function(){throw new Error("Cursor not stopped")},Ae.trans=m,Ae.stop=Ae.continue=Ae.continuePrimaryKey=Ae.advance=function(){throw new Error("Cursor not started")},Ae.fail=z(Z),Ae.next=function(){var Nn=this,jn=1;return this.start(function(){return jn--?Nn.continue():Nn.stop()}).then(function(){return Nn})},Ae.start=function(Nn){function jn(){if($.result)try{Nn()}catch(Un){Ae.fail(Un)}else Ae.done=!0,Ae.start=function(){throw new Error("Cursor behind last entry")},Ae.stop()}var Mt=new Promise(function(Un,ct){Un=z(Un),$.onerror=Xn(ct),Ae.fail=ct,Ae.stop=function(Or){Ae.stop=Ae.continue=Ae.continuePrimaryKey=Ae.advance=Hn,Un(Or)}});return $.onsuccess=z(function(Un){$.onsuccess=jn,jn()}),Ae.continue=be,Ae.continuePrimaryKey=ke,Ae.advance=Ee,jn(),Mt},Y(Ae)):Y(null)},Z)})},count:function(x){var m=x.query,P=x.trans,C=m.index,N=m.range;return new Promise(function(U,Y){var Z=P.objectStore(b),J=C.isPrimaryKey?Z:Z.index(C.name),Z=r(N),J=Z?J.count(Z):J.count();J.onsuccess=z(function(X){return U(X.target.result)}),J.onerror=Xn(Y)})}}}var a,c,p,O=(c=v,p=Yr((a=e).objectStoreNames),{schema:{name:a.name,tables:p.map(function(S){return c.objectStore(S)}).map(function(S){var y=S.keyPath,m=S.autoIncrement,b=A(y),x={},m={name:S.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:y==null,compound:b,keyPath:y,autoIncrement:m,unique:!0,extractKey:ir(y)},indexes:Yr(S.indexNames).map(function(P){return S.index(P)}).map(function(U){var C=U.name,N=U.unique,Y=U.multiEntry,U=U.keyPath,Y={name:C,compound:A(U),keyPath:U,unique:N,multiEntry:Y,extractKey:ir(U)};return x[_t(U)]=Y}),getIndexByKeyPath:function(P){return x[_t(P)]}};return x[":id"]=m.primaryKey,y!=null&&(x[_t(y)]=m.primaryKey),m})},hasGetAll:0<p.length&&"getAll"in c.objectStore(p[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),v=O.schema,d=O.hasGetAll,O=v.tables.map(i),h={};return O.forEach(function(S){return h[S.name]=S}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(S){if(!h[S])throw new Error("Table '".concat(S,"' not found"));return h[S]},MIN_KEY:-1/0,MAX_KEY:wt(n),schema:v}}function Si(e,n,t,r){var i=t.IDBKeyRange;return t.indexedDB,{dbcore:(r=Oi(n,i,r),e.dbcore.reduce(function(a,c){return c=c.create,E(E({},a),c(a))},r))}}function Ct(e,r){var t=r.db,r=Si(e._middlewares,t,e._deps,r);e.core=r.dbcore,e.tables.forEach(function(i){var a=i.name;e.core.schema.tables.some(function(c){return c.name===a})&&(i.core=e.core.table(a),e[a]instanceof e.Table&&(e[a].core=i.core))})}function Nt(e,n,t,r){t.forEach(function(i){var a=r[i];n.forEach(function(c){var p=function v(d,O){return Oe(d,O)||(d=te(d))&&v(d,O)}(c,i);(!p||"value"in p&&p.value===void 0)&&(c===e.Transaction.prototype||c instanceof e.Transaction?Ge(c,i,{get:function(){return this.table(i)},set:function(v){he(this,i,{value:v,writable:!0,configurable:!0,enumerable:!0})}}):c[i]=new e.Table(i,a))})})}function or(e,n){n.forEach(function(t){for(var r in t)t[r]instanceof e.Table&&delete t[r]})}function xi(e,n){return e._cfg.version-n._cfg.version}function Ei(e,n,t,r){var i=e._dbSchema;t.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=rr("$meta",Gr("")[0],[]),e._storeNames.push("$meta"));var a=e._createTransaction("readwrite",e._storeNames,i);a.create(t),a._completion.catch(r);var c=a._reject.bind(a),p=f.transless||f;We(function(){return f.trans=a,f.transless=p,n!==0?(Ct(e,t),d=n,((v=a).storeNames.includes("$meta")?v.table("$meta").get("version").then(function(O){return O??d}):B.resolve(d)).then(function(O){return S=O,y=a,b=t,x=[],O=(h=e)._versions,m=h._dbSchema=It(0,h.idbdb,b),(O=O.filter(function(P){return P._cfg.version>=S})).length!==0?(O.forEach(function(P){x.push(function(){var C=m,N=P._cfg.dbschema;Bt(h,C,b),Bt(h,N,b),m=h._dbSchema=N;var U=ar(C,N);U.add.forEach(function(ee){ur(b,ee[0],ee[1].primKey,ee[1].indexes)}),U.change.forEach(function(ee){if(ee.recreate)throw new _.Upgrade("Not yet support for changing primary key");var $=b.objectStore(ee.name);ee.add.forEach(function(ye){return jt($,ye)}),ee.change.forEach(function(ye){$.deleteIndex(ye.name),jt($,ye)}),ee.del.forEach(function(ye){return $.deleteIndex(ye)})});var Y=P._cfg.contentUpgrade;if(Y&&P._cfg.version>S){Ct(h,b),y._memoizedTables={};var Z=Le(N);U.del.forEach(function(ee){Z[ee]=C[ee]}),or(h,[h.Transaction.prototype]),Nt(h,[h.Transaction.prototype],L(Z),Z),y.schema=Z;var J,X=dn(Y);return X&&fn(),U=B.follow(function(){var ee;(J=Y(y))&&X&&(ee=pn.bind(null,null),J.then(ee,ee))}),J&&typeof J.then=="function"?B.resolve(J):U.then(function(){return J})}}),x.push(function(C){var N,U,Y=P._cfg.dbschema;N=Y,U=C,[].slice.call(U.db.objectStoreNames).forEach(function(Z){return N[Z]==null&&U.db.deleteObjectStore(Z)}),or(h,[h.Transaction.prototype]),Nt(h,[h.Transaction.prototype],h._storeNames,h._dbSchema),y.schema=h._dbSchema}),x.push(function(C){h.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(h.idbdb.version/10)===P._cfg.version?(h.idbdb.deleteObjectStore("$meta"),delete h._dbSchema.$meta,h._storeNames=h._storeNames.filter(function(N){return N!=="$meta"})):C.objectStore("$meta").put(P._cfg.version,"version"))})}),function P(){return x.length?B.resolve(x.shift()(y.idbtrans)).then(P):B.resolve()}().then(function(){Jr(m,b)})):B.resolve();var h,S,y,b,x,m}).catch(c)):(L(i).forEach(function(O){ur(t,O,i[O].primKey,i[O].indexes)}),Ct(e,t),void B.follow(function(){return e.on.populate.fire(a)}).catch(c));var v,d})}function Ai(e,n){Jr(e._dbSchema,n),n.db.version%10!=0||n.objectStoreNames.contains("$meta")||n.db.createObjectStore("$meta").add(Math.ceil(n.db.version/10-1),"version");var t=It(0,e.idbdb,n);Bt(e,e._dbSchema,n);for(var r=0,i=ar(t,e._dbSchema).change;r<i.length;r++){var a=function(c){if(c.change.length||c.recreate)return console.warn("Unable to patch indexes of table ".concat(c.name," because it has changes on the type of index or primary key.")),{value:void 0};var p=n.objectStore(c.name);c.add.forEach(function(v){cn&&console.debug("Dexie upgrade patch: Creating missing index ".concat(c.name,".").concat(v.src)),jt(p,v)})}(i[r]);if(typeof a=="object")return a.value}}function ar(e,n){var t,r={del:[],add:[],change:[]};for(t in e)n[t]||r.del.push(t);for(t in n){var i=e[t],a=n[t];if(i){var c={name:t,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto)c.recreate=!0,r.change.push(c);else{var p=i.idxByName,v=a.idxByName,d=void 0;for(d in p)v[d]||c.del.push(d);for(d in v){var O=p[d],h=v[d];O?O.src!==h.src&&c.change.push(h):c.add.push(h)}(0<c.del.length||0<c.add.length||0<c.change.length)&&r.change.push(c)}}else r.add.push([t,a])}return r}function ur(e,n,t,r){var i=e.db.createObjectStore(n,t.keyPath?{keyPath:t.keyPath,autoIncrement:t.auto}:{autoIncrement:t.auto});return r.forEach(function(a){return jt(i,a)}),i}function Jr(e,n){L(e).forEach(function(t){n.db.objectStoreNames.contains(t)||(cn&&console.debug("Dexie: Creating missing table",t),ur(n,t,e[t].primKey,e[t].indexes))})}function jt(e,n){e.createIndex(n.name,n.keyPath,{unique:n.unique,multiEntry:n.multi})}function It(e,n,t){var r={};return Ce(n.objectStoreNames,0).forEach(function(i){for(var a=t.objectStore(i),c=tr($r(d=a.keyPath),d||"",!0,!1,!!a.autoIncrement,d&&typeof d!="string",!0),p=[],v=0;v<a.indexNames.length;++v){var O=a.index(a.indexNames[v]),d=O.keyPath,O=tr(O.name,d,!!O.unique,!!O.multiEntry,!1,d&&typeof d!="string",!1);p.push(O)}r[i]=rr(i,c,p)}),r}function Bt(e,n,t){for(var r=t.db.objectStoreNames,i=0;i<r.length;++i){var a=r[i],c=t.objectStore(a);e._hasGetAll="getAll"in c;for(var p=0;p<c.indexNames.length;++p){var v=c.indexNames[p],d=c.index(v).keyPath,O=typeof d=="string"?d:"["+Ce(d).join("+")+"]";!n[a]||(d=n[a].idxByName[O])&&(d.name=v,delete n[a].idxByName[O],n[a].idxByName[v]=d)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&D.WorkerGlobalScope&&D instanceof D.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Gr(e){return e.split(",").map(function(n,t){var r=(n=n.trim()).replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return tr(r,i||null,/\&/.test(n),/\*/.test(n),/\+\+/.test(n),A(i),t===0)})}var ki=(Kt.prototype._parseStoresSpec=function(e,n){L(e).forEach(function(t){if(e[t]!==null){var r=Gr(e[t]),i=r.shift();if(i.unique=!0,i.multi)throw new _.Schema("Primary key cannot be multi-valued");r.forEach(function(a){if(a.auto)throw new _.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new _.Schema("Index must have a name and cannot be an empty string")}),n[t]=rr(t,i,r)}})},Kt.prototype.stores=function(t){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?g(this._cfg.storesSource,t):t;var t=n._versions,r={},i={};return t.forEach(function(a){g(r,a._cfg.storesSource),i=a._cfg.dbschema={},a._parseStoresSpec(r,i)}),n._dbSchema=i,or(n,[n._allTables,n,n.Transaction.prototype]),Nt(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],L(i),i),n._storeNames=L(i),this},Kt.prototype.upgrade=function(e){return this._cfg.contentUpgrade=_n(this._cfg.contentUpgrade||j,e),this},Kt);function Kt(){}function sr(e,n){var t=e._dbNamesDB;return t||(t=e._dbNamesDB=new nt(yn,{addons:[],indexedDB:e,IDBKeyRange:n})).version(1).stores({dbnames:"name"}),t.table("dbnames")}function cr(e){return e&&typeof e.databases=="function"}function lr(e){return We(function(){return f.letThrough=!0,e()})}function fr(e){return!("from"in e)}var Dn=function(e,n){if(!this){var t=new Dn;return e&&"d"in e&&g(t,e),t}g(this,arguments.length?{d:1,from:e,to:1<arguments.length?n:e}:{d:0})};function Ot(e,n,t){var r=Fe(n,t);if(!isNaN(r)){if(0<r)throw RangeError();if(fr(e))return g(e,{from:n,to:t,d:1});var i=e.l,r=e.r;if(Fe(t,e.from)<0)return i?Ot(i,n,t):e.l={from:n,to:t,d:1,l:null,r:null},Wr(e);if(0<Fe(n,e.to))return r?Ot(r,n,t):e.r={from:n,to:t,d:1,l:null,r:null},Wr(e);Fe(n,e.from)<0&&(e.from=n,e.l=null,e.d=r?r.d+1:1),0<Fe(t,e.to)&&(e.to=t,e.r=null,e.d=e.l?e.l.d+1:1),t=!e.r,i&&!e.l&&St(e,i),r&&t&&St(e,r)}}function St(e,n){fr(n)||function t(r,v){var a=v.from,c=v.to,p=v.l,v=v.r;Ot(r,a,c),p&&t(r,p),v&&t(r,v)}(e,n)}function zr(e,n){var t=Rt(n),r=t.next();if(r.done)return!1;for(var i=r.value,a=Rt(e),c=a.next(i.from),p=c.value;!r.done&&!c.done;){if(Fe(p.from,i.to)<=0&&0<=Fe(p.to,i.from))return!0;Fe(i.from,p.from)<0?i=(r=t.next(p.from)).value:p=(c=a.next(i.from)).value}return!1}function Rt(e){var n=fr(e)?null:{s:0,n:e};return{next:function(t){for(var r=0<arguments.length;n;)switch(n.s){case 0:if(n.s=1,r)for(;n.n.l&&Fe(t,n.n.from)<0;)n={up:n,n:n.n.l,s:1};else for(;n.n.l;)n={up:n,n:n.n.l,s:1};case 1:if(n.s=2,!r||Fe(t,n.n.to)<=0)return{value:n.n,done:!1};case 2:if(n.n.r){n.s=3,n={up:n,n:n.n.r,s:0};continue}case 3:n=n.up}return{done:!0}}}}function Wr(e){var n,t,r=(((n=e.r)===null||n===void 0?void 0:n.d)||0)-(((t=e.l)===null||t===void 0?void 0:t.d)||0),i=1<r?"r":r<-1?"l":"";i&&(n=i=="r"?"l":"r",t=E({},e),r=e[i],e.from=r.from,e.to=r.to,e[i]=r[i],t[i]=r[n],(e[n]=t).d=Hr(t)),e.d=Hr(e)}function Hr(t){var n=t.r,t=t.l;return(n?t?Math.max(n.d,t.d):n.d:t?t.d:0)+1}function Dt(e,n){return L(n).forEach(function(t){e[t]?St(e[t],n[t]):e[t]=function r(i){var a,c,p={};for(a in i)k(i,a)&&(c=i[a],p[a]=!c||typeof c!="object"||I.has(c.constructor)?c:r(c));return p}(n[t])}),e}function pr(e,n){return e.all||n.all||Object.keys(e).some(function(t){return n[t]&&zr(n[t],e[t])})}W(Dn.prototype,((Jn={add:function(e){return St(this,e),this},addKey:function(e){return Ot(this,e,e),this},addKeys:function(e){var n=this;return e.forEach(function(t){return Ot(n,t,t)}),this},hasKey:function(e){var n=Rt(this).next(e).value;return n&&Fe(n.from,e)<=0&&0<=Fe(n.to,e)}})[ve]=function(){return Rt(this)},Jn));var ut={},hr={},dr=!1;function Ut(e){Dt(hr,e),dr||(dr=!0,setTimeout(function(){dr=!1,yr(hr,!(hr={}))},0))}function yr(e,n){n===void 0&&(n=!1);var t=new Set;if(e.all)for(var r=0,i=Object.values(ut);r<i.length;r++)Qr(c=i[r],e,t,n);else for(var a in e){var c,p=/^idb\:\/\/(.*)\/(.*)\//.exec(a);p&&(a=p[1],p=p[2],(c=ut["idb://".concat(a,"/").concat(p)])&&Qr(c,e,t,n))}t.forEach(function(v){return v()})}function Qr(e,n,t,r){for(var i=[],a=0,c=Object.entries(e.queries.query);a<c.length;a++){for(var p=c[a],v=p[0],d=[],O=0,h=p[1];O<h.length;O++){var S=h[O];pr(n,S.obsSet)?S.subscribers.forEach(function(m){return t.add(m)}):r&&d.push(S)}r&&i.push([v,d])}if(r)for(var y=0,b=i;y<b.length;y++){var x=b[y],v=x[0],d=x[1];e.queries.query[v]=d}}function Ti(e){var n=e._state,t=e._deps.indexedDB;if(n.isBeingOpened||e.idbdb)return n.dbReadyPromise.then(function(){return n.dbOpenError?on(n.dbOpenError):e});n.isBeingOpened=!0,n.dbOpenError=null,n.openComplete=!1;var r=n.openCanceller,i=Math.round(10*e.verno),a=!1;function c(){if(n.openCanceller!==r)throw new _.DatabaseClosed("db.open() was cancelled")}function p(){return new B(function(S,y){if(c(),!t)throw new _.MissingAPI;var b=e.name,x=n.autoSchema||!i?t.open(b):t.open(b,i);if(!x)throw new _.MissingAPI;x.onerror=Xn(y),x.onblocked=z(e._fireOnBlocked),x.onupgradeneeded=z(function(m){var P;O=x.transaction,n.autoSchema&&!e._options.allowEmptyDB?(x.onerror=bt,O.abort(),x.result.close(),(P=t.deleteDatabase(b)).onsuccess=P.onerror=z(function(){y(new _.NoSuchDatabase("Database ".concat(b," doesnt exist")))})):(O.onerror=Xn(y),m=m.oldVersion>Math.pow(2,62)?0:m.oldVersion,h=m<1,e.idbdb=x.result,a&&Ai(e,O),Ei(e,m/10,O,y))},y),x.onsuccess=z(function(){O=null;var m,P,C,N,U,Y=e.idbdb=x.result,Z=Ce(Y.objectStoreNames);if(0<Z.length)try{var J=Y.transaction((N=Z).length===1?N[0]:N,"readonly");if(n.autoSchema)P=Y,C=J,(m=e).verno=P.version/10,C=m._dbSchema=It(0,P,C),m._storeNames=Ce(P.objectStoreNames,0),Nt(m,[m._allTables],L(C),C);else if(Bt(e,e._dbSchema,J),((U=ar(It(0,(U=e).idbdb,J),U._dbSchema)).add.length||U.change.some(function(X){return X.add.length||X.change.length}))&&!a)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Y.close(),i=Y.version+1,a=!0,S(p());Ct(e,J)}catch{}Rn.push(e),Y.onversionchange=z(function(X){n.vcFired=!0,e.on("versionchange").fire(X)}),Y.onclose=z(function(X){e.on("close").fire(X)}),h&&(U=e._deps,J=b,Y=U.indexedDB,U=U.IDBKeyRange,cr(Y)||J===yn||sr(Y,U).put({name:J}).catch(j)),S()},y)}).catch(function(S){switch(S?.name){case"UnknownError":if(0<n.PR1398_maxLoop)return n.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),p();break;case"VersionError":if(0<i)return i=0,p()}return B.reject(S)})}var v,d=n.dbReadyResolve,O=null,h=!1;return B.race([r,(typeof navigator>"u"?B.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(S){function y(){return indexedDB.databases().finally(S)}v=setInterval(y,100),y()}).finally(function(){return clearInterval(v)}):Promise.resolve()).then(p)]).then(function(){return c(),n.onReadyBeingFired=[],B.resolve(lr(function(){return e.on.ready.fire(e.vip)})).then(function S(){if(0<n.onReadyBeingFired.length){var y=n.onReadyBeingFired.reduce(_n,j);return n.onReadyBeingFired=[],B.resolve(lr(function(){return y(e.vip)})).then(S)}})}).finally(function(){n.openCanceller===r&&(n.onReadyBeingFired=null,n.isBeingOpened=!1)}).catch(function(S){n.dbOpenError=S;try{O&&O.abort()}catch{}return r===n.openCanceller&&e._close(),on(S)}).finally(function(){n.openComplete=!0,d()}).then(function(){var S;return h&&(S={},e.tables.forEach(function(y){y.schema.indexes.forEach(function(b){b.name&&(S["idb://".concat(e.name,"/").concat(y.name,"/").concat(b.name)]=new Dn(-1/0,[[[]]]))}),S["idb://".concat(e.name,"/").concat(y.name,"/")]=S["idb://".concat(e.name,"/").concat(y.name,"/:dels")]=new Dn(-1/0,[[[]]])}),it(gt).fire(S),yr(S,!0)),e})}function vr(e){function n(a){return e.next(a)}var t=i(n),r=i(function(a){return e.throw(a)});function i(a){return function(v){var p=a(v),v=p.value;return p.done?v:v&&typeof v.then=="function"?v.then(t,r):A(v)?Promise.all(v).then(t,r):t(v)}}return i(n)()}function Ft(e,n,t){for(var r=A(e)?e.slice():[e],i=0;i<t;++i)r.push(n);return r}var Pi={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return E(E({},e),{table:function(n){var t=e.table(n),r=t.schema,i={},a=[];function c(h,S,y){var b=_t(h),x=i[b]=i[b]||[],m=h==null?0:typeof h=="string"?1:h.length,P=0<S,P=E(E({},y),{name:P?"".concat(b,"(virtual-from:").concat(y.name,")"):y.name,lowLevelIndex:y,isVirtual:P,keyTail:S,keyLength:m,extractKey:ir(h),unique:!P&&y.unique});return x.push(P),P.isPrimaryKey||a.push(P),1<m&&c(m===2?h[0]:h.slice(0,m-1),S+1,y),x.sort(function(C,N){return C.keyTail-N.keyTail}),P}n=c(r.primaryKey.keyPath,0,r.primaryKey),i[":id"]=[n];for(var p=0,v=r.indexes;p<v.length;p++){var d=v[p];c(d.keyPath,0,d)}function O(h){var S,y=h.query.index;return y.isVirtual?E(E({},h),{query:{index:y.lowLevelIndex,range:(S=h.query.range,y=y.keyTail,{type:S.type===1?2:S.type,lower:Ft(S.lower,S.lowerOpen?e.MAX_KEY:e.MIN_KEY,y),lowerOpen:!0,upper:Ft(S.upper,S.upperOpen?e.MIN_KEY:e.MAX_KEY,y),upperOpen:!0})}}):h}return E(E({},t),{schema:E(E({},r),{primaryKey:n,indexes:a,getIndexByKeyPath:function(h){return(h=i[_t(h)])&&h[0]}}),count:function(h){return t.count(O(h))},query:function(h){return t.query(O(h))},openCursor:function(h){var S=h.query.index,y=S.keyTail,b=S.isVirtual,x=S.keyLength;return b?t.openCursor(O(h)).then(function(P){return P&&m(P)}):t.openCursor(h);function m(P){return Object.create(P,{continue:{value:function(C){C!=null?P.continue(Ft(C,h.reverse?e.MAX_KEY:e.MIN_KEY,y)):h.unique?P.continue(P.key.slice(0,x).concat(h.reverse?e.MIN_KEY:e.MAX_KEY,y)):P.continue()}},continuePrimaryKey:{value:function(C,N){P.continuePrimaryKey(Ft(C,e.MAX_KEY,y),N)}},primaryKey:{get:function(){return P.primaryKey}},key:{get:function(){var C=P.key;return x===1?C[0]:C.slice(0,x)}},value:{get:function(){return P.value}}})}}})}})}};function mr(e,n,t,r){return t=t||{},r=r||"",L(e).forEach(function(i){var a,c,p;k(n,i)?(a=e[i],c=n[i],typeof a=="object"&&typeof c=="object"&&a&&c?(p=Ne(a))!==Ne(c)?t[r+i]=n[i]:p==="Object"?mr(a,c,t,r+i+"."):a!==c&&(t[r+i]=n[i]):a!==c&&(t[r+i]=n[i])):t[r+i]=void 0}),L(n).forEach(function(i){k(e,i)||(t[r+i]=n[i])}),t}function br(e,n){return n.type==="delete"?n.keys:n.keys||n.values.map(e.extractKey)}var Ci={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return E(E({},e),{table:function(n){var t=e.table(n),r=t.schema.primaryKey;return E(E({},t),{mutate:function(i){var a=f.trans,c=a.table(n).hook,p=c.deleting,v=c.creating,d=c.updating;switch(i.type){case"add":if(v.fire===j)break;return a._promise("readwrite",function(){return O(i)},!0);case"put":if(v.fire===j&&d.fire===j)break;return a._promise("readwrite",function(){return O(i)},!0);case"delete":if(p.fire===j)break;return a._promise("readwrite",function(){return O(i)},!0);case"deleteRange":if(p.fire===j)break;return a._promise("readwrite",function(){return function h(S,y,b){return t.query({trans:S,values:!1,query:{index:r,range:y},limit:b}).then(function(x){var m=x.result;return O({type:"delete",keys:m,trans:S}).then(function(P){return 0<P.numFailures?Promise.reject(P.failures[0]):m.length<b?{failures:[],numFailures:0,lastResult:void 0}:h(S,E(E({},y),{lower:m[m.length-1],lowerOpen:!0}),b)})})}(i.trans,i.range,1e4)},!0)}return t.mutate(i);function O(h){var S,y,b,x=f.trans,m=h.keys||br(r,h);if(!m)throw new Error("Keys missing");return(h=h.type==="add"||h.type==="put"?E(E({},h),{keys:m}):E({},h)).type!=="delete"&&(h.values=T([],h.values,!0)),h.keys&&(h.keys=T([],h.keys,!0)),S=t,b=m,((y=h).type==="add"?Promise.resolve([]):S.getMany({trans:y.trans,keys:b,cache:"immutable"})).then(function(P){var C=m.map(function(N,U){var Y,Z,J,X=P[U],ee={onerror:null,onsuccess:null};return h.type==="delete"?p.fire.call(ee,N,X,x):h.type==="add"||X===void 0?(Y=v.fire.call(ee,N,h.values[U],x),N==null&&Y!=null&&(h.keys[U]=N=Y,r.outbound||oe(h.values[U],r.keyPath,N))):(Y=mr(X,h.values[U]),(Z=d.fire.call(ee,Y,N,X,x))&&(J=h.values[U],Object.keys(Z).forEach(function($){k(J,$)?J[$]=Z[$]:oe(J,$,Z[$])}))),ee});return t.mutate(h).then(function(N){for(var U=N.failures,Y=N.results,Z=N.numFailures,N=N.lastResult,J=0;J<m.length;++J){var X=(Y||m)[J],ee=C[J];X==null?ee.onerror&&ee.onerror(U[J]):ee.onsuccess&&ee.onsuccess(h.type==="put"&&P[J]?h.values[J]:X)}return{failures:U,results:Y,numFailures:Z,lastResult:N}}).catch(function(N){return C.forEach(function(U){return U.onerror&&U.onerror(N)}),Promise.reject(N)})})}}})}})}};function Xr(e,n,t){try{if(!n||n.keys.length<e.length)return null;for(var r=[],i=0,a=0;i<n.keys.length&&a<e.length;++i)Fe(n.keys[i],e[a])===0&&(r.push(t?V(n.values[i]):n.values[i]),++a);return r.length===e.length?r:null}catch{return null}}var Ni={stack:"dbcore",level:-1,create:function(e){return{table:function(n){var t=e.table(n);return E(E({},t),{getMany:function(r){if(!r.cache)return t.getMany(r);var i=Xr(r.keys,r.trans._cache,r.cache==="clone");return i?B.resolve(i):t.getMany(r).then(function(a){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?V(a):a},a})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),t.mutate(r)}})}}}};function Zr(e,n){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!n.schema.primaryKey.outbound}function ei(e,n){switch(e){case"query":return n.values&&!n.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var ji={stack:"dbcore",level:0,name:"Observability",create:function(e){var n=e.schema.name,t=new Dn(e.MIN_KEY,e.MAX_KEY);return E(E({},e),{transaction:function(r,i,a){if(f.subscr&&i!=="readonly")throw new _.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(f.querier));return e.transaction(r,i,a)},table:function(r){var i=e.table(r),a=i.schema,c=a.primaryKey,h=a.indexes,p=c.extractKey,v=c.outbound,d=c.autoIncrement&&h.filter(function(y){return y.compound&&y.keyPath.includes(c.keyPath)}),O=E(E({},i),{mutate:function(y){function b($){return $="idb://".concat(n,"/").concat(r,"/").concat($),N[$]||(N[$]=new Dn)}var x,m,P,C=y.trans,N=y.mutatedParts||(y.mutatedParts={}),U=b(""),Y=b(":dels"),Z=y.type,ee=y.type==="deleteRange"?[y.range]:y.type==="delete"?[y.keys]:y.values.length<50?[br(c,y).filter(function($){return $}),y.values]:[],J=ee[0],X=ee[1],ee=y.trans._cache;return A(J)?(U.addKeys(J),(ee=Z==="delete"||J.length===X.length?Xr(J,ee):null)||Y.addKeys(J),(ee||X)&&(x=b,m=ee,P=X,a.indexes.forEach(function($){var ye=x($.name||"");function be(Ee){return Ee!=null?$.extractKey(Ee):null}function ke(Ee){return $.multiEntry&&A(Ee)?Ee.forEach(function(Hn){return ye.addKey(Hn)}):ye.addKey(Ee)}(m||P).forEach(function(Ee,Nn){var Ae=m&&be(m[Nn]),Nn=P&&be(P[Nn]);Fe(Ae,Nn)!==0&&(Ae!=null&&ke(Ae),Nn!=null&&ke(Nn))})}))):J?(X={from:J.lower,to:J.upper},Y.add(X),U.add(X)):(U.add(t),Y.add(t),a.indexes.forEach(function($){return b($.name).add(t)})),i.mutate(y).then(function($){return!J||y.type!=="add"&&y.type!=="put"||(U.addKeys($.results),d&&d.forEach(function(ye){var be=y.values.map(function(Ee){return ye.extractKey(Ee)}),ke=ye.keyPath.findIndex(function(Ee){return Ee===c.keyPath});$.results.forEach(function(Ee){return be[ke]=Ee}),b(ye.name).addKeys(be)})),C.mutatedParts=Dt(C.mutatedParts||{},N),$})}}),h=function(b){var x=b.query,b=x.index,x=x.range;return[b,new Dn((b=x.lower)!==null&&b!==void 0?b:e.MIN_KEY,(x=x.upper)!==null&&x!==void 0?x:e.MAX_KEY)]},S={get:function(y){return[c,new Dn(y.key)]},getMany:function(y){return[c,new Dn().addKeys(y.keys)]},count:h,query:h,openCursor:h};return L(S).forEach(function(y){O[y]=function(b){var x=f.subscr,m=!!x,P=Zr(f,i)&&ei(y,b)?b.obsSet={}:x;if(m){var C=function(X){return X="idb://".concat(n,"/").concat(r,"/").concat(X),P[X]||(P[X]=new Dn)},N=C(""),U=C(":dels"),x=S[y](b),m=x[0],x=x[1];if((y==="query"&&m.isPrimaryKey&&!b.values?U:C(m.name||"")).add(x),!m.isPrimaryKey){if(y!=="count"){var Y=y==="query"&&v&&b.values&&i.query(E(E({},b),{values:!1}));return i[y].apply(this,arguments).then(function(X){if(y==="query"){if(v&&b.values)return Y.then(function(be){return be=be.result,N.addKeys(be),X});var ee=b.values?X.result.map(p):X.result;(b.values?N:U).addKeys(ee)}else if(y==="openCursor"){var $=X,ye=b.values;return $&&Object.create($,{key:{get:function(){return U.addKey($.primaryKey),$.key}},primaryKey:{get:function(){var be=$.primaryKey;return U.addKey(be),be}},value:{get:function(){return ye&&N.addKey($.primaryKey),$.value}}})}return X})}U.add(t)}}return i[y].apply(this,arguments)}}),O}})}};function ni(e,n,t){if(t.numFailures===0)return n;if(n.type==="deleteRange")return null;var r=n.keys?n.keys.length:"values"in n&&n.values?n.values.length:1;return t.numFailures===r?null:(n=E({},n),A(n.keys)&&(n.keys=n.keys.filter(function(i,a){return!(a in t.failures)})),"values"in n&&A(n.values)&&(n.values=n.values.filter(function(i,a){return!(a in t.failures)})),n)}function gr(e,n){return t=e,((r=n).lower===void 0||(r.lowerOpen?0<Fe(t,r.lower):0<=Fe(t,r.lower)))&&(e=e,(n=n).upper===void 0||(n.upperOpen?Fe(e,n.upper)<0:Fe(e,n.upper)<=0));var t,r}function ti(e,n,S,r,i,a){if(!S||S.length===0)return e;var c=n.query.index,p=c.multiEntry,v=n.query.range,d=r.schema.primaryKey.extractKey,O=c.extractKey,h=(c.lowLevelIndex||c).extractKey,S=S.reduce(function(y,b){var x=y,m=[];if(b.type==="add"||b.type==="put")for(var P=new Dn,C=b.values.length-1;0<=C;--C){var N,U=b.values[C],Y=d(U);P.hasKey(Y)||(N=O(U),(p&&A(N)?N.some(function(ee){return gr(ee,v)}):gr(N,v))&&(P.addKey(Y),m.push(U)))}switch(b.type){case"add":x=y.concat(n.values?m:m.map(function($){return d($)}));break;case"put":var Z=new Dn().addKeys(b.values.map(function($){return d($)})),x=y.filter(function($){return!Z.hasKey(n.values?d($):$)}).concat(n.values?m:m.map(function($){return d($)}));break;case"delete":var J=new Dn().addKeys(b.keys);x=y.filter(function($){return!J.hasKey(n.values?d($):$)});break;case"deleteRange":var X=b.range;x=y.filter(function($){return!gr(d($),X)})}return x},e);return S===e?e:(S.sort(function(y,b){return Fe(h(y),h(b))||Fe(d(y),d(b))}),n.limit&&n.limit<1/0&&(S.length>n.limit?S.length=n.limit:e.length===n.limit&&S.length<n.limit&&(i.dirty=!0)),a?Object.freeze(S):S)}function ri(e,n){return Fe(e.lower,n.lower)===0&&Fe(e.upper,n.upper)===0&&!!e.lowerOpen==!!n.lowerOpen&&!!e.upperOpen==!!n.upperOpen}function Ii(e,n){return function(t,r,i,a){if(t===void 0)return r!==void 0?-1:0;if(r===void 0)return 1;if((r=Fe(t,r))===0){if(i&&a)return 0;if(i)return 1;if(a)return-1}return r}(e.lower,n.lower,e.lowerOpen,n.lowerOpen)<=0&&0<=function(t,r,i,a){if(t===void 0)return r!==void 0?1:0;if(r===void 0)return-1;if((r=Fe(t,r))===0){if(i&&a)return 0;if(i)return-1;if(a)return 1}return r}(e.upper,n.upper,e.upperOpen,n.upperOpen)}function Bi(e,n,t,r){e.subscribers.add(t),r.addEventListener("abort",function(){var i,a;e.subscribers.delete(t),e.subscribers.size===0&&(i=e,a=n,setTimeout(function(){i.subscribers.size===0&&qe(a,i)},3e3))})}var Ki={stack:"dbcore",level:0,name:"Cache",create:function(e){var n=e.schema.name;return E(E({},e),{transaction:function(t,r,i){var a,c,p=e.transaction(t,r,i);return r==="readwrite"&&(c=(a=new AbortController).signal,i=function(v){return function(){if(a.abort(),r==="readwrite"){for(var d=new Set,O=0,h=t;O<h.length;O++){var S=h[O],y=ut["idb://".concat(n,"/").concat(S)];if(y){var b=e.table(S),x=y.optimisticOps.filter(function(ye){return ye.trans===p});if(p._explicit&&v&&p.mutatedParts)for(var m=0,P=Object.values(y.queries.query);m<P.length;m++)for(var C=0,N=(Z=P[m]).slice();C<N.length;C++)pr((J=N[C]).obsSet,p.mutatedParts)&&(qe(Z,J),J.subscribers.forEach(function(ye){return d.add(ye)}));else if(0<x.length){y.optimisticOps=y.optimisticOps.filter(function(ye){return ye.trans!==p});for(var U=0,Y=Object.values(y.queries.query);U<Y.length;U++)for(var Z,J,X,ee=0,$=(Z=Y[U]).slice();ee<$.length;ee++)(J=$[ee]).res!=null&&p.mutatedParts&&(v&&!J.dirty?(X=Object.isFrozen(J.res),X=ti(J.res,J.req,x,b,J,X),J.dirty?(qe(Z,J),J.subscribers.forEach(function(ye){return d.add(ye)})):X!==J.res&&(J.res=X,J.promise=B.resolve({result:X}))):(J.dirty&&qe(Z,J),J.subscribers.forEach(function(ye){return d.add(ye)})))}}}d.forEach(function(ye){return ye()})}}},p.addEventListener("abort",i(!1),{signal:c}),p.addEventListener("error",i(!1),{signal:c}),p.addEventListener("complete",i(!0),{signal:c})),p},table:function(t){var r=e.table(t),i=r.schema.primaryKey;return E(E({},r),{mutate:function(a){var c=f.trans;if(i.outbound||c.db._options.cache==="disabled"||c.explicit)return r.mutate(a);var p=ut["idb://".concat(n,"/").concat(t)];return p?(c=r.mutate(a),a.type!=="add"&&a.type!=="put"||!(50<=a.values.length||br(i,a).some(function(v){return v==null}))?(p.optimisticOps.push(a),a.mutatedParts&&Ut(a.mutatedParts),c.then(function(v){0<v.numFailures&&(qe(p.optimisticOps,a),(v=ni(0,a,v))&&p.optimisticOps.push(v),a.mutatedParts&&Ut(a.mutatedParts))}),c.catch(function(){qe(p.optimisticOps,a),a.mutatedParts&&Ut(a.mutatedParts)})):c.then(function(v){var d=ni(0,E(E({},a),{values:a.values.map(function(y,h){var S,y=(S=i.keyPath)!==null&&S!==void 0&&S.includes(".")?V(y):E({},y);return oe(y,i.keyPath,v.results[h]),y})}),v);p.optimisticOps.push(d),queueMicrotask(function(){return a.mutatedParts&&Ut(a.mutatedParts)})}),c):r.mutate(a)},query:function(a){if(!Zr(f,r)||!ei("query",a))return r.query(a);var c=((d=f.trans)===null||d===void 0?void 0:d.db._options.cache)==="immutable",h=f,p=h.requery,v=h.signal,d=function(b,x,m,P){var C=ut["idb://".concat(b,"/").concat(x)];if(!C)return[];if(!(x=C.queries[m]))return[null,!1,C,null];var N=x[(P.query?P.query.index.name:null)||""];if(!N)return[null,!1,C,null];switch(m){case"query":var U=N.find(function(Y){return Y.req.limit===P.limit&&Y.req.values===P.values&&ri(Y.req.query.range,P.query.range)});return U?[U,!0,C,N]:[N.find(function(Y){return("limit"in Y.req?Y.req.limit:1/0)>=P.limit&&(!P.values||Y.req.values)&&Ii(Y.req.query.range,P.query.range)}),!1,C,N];case"count":return U=N.find(function(Y){return ri(Y.req.query.range,P.query.range)}),[U,!!U,C,N]}}(n,t,"query",a),O=d[0],h=d[1],S=d[2],y=d[3];return O&&h?O.obsSet=a.obsSet:(h=r.query(a).then(function(b){var x=b.result;if(O&&(O.res=x),c){for(var m=0,P=x.length;m<P;++m)Object.freeze(x[m]);Object.freeze(x)}else b.result=V(x);return b}).catch(function(b){return y&&O&&qe(y,O),Promise.reject(b)}),O={obsSet:a.obsSet,promise:h,subscribers:new Set,type:"query",req:a,dirty:!1},y?y.push(O):(y=[O],(S=S||(ut["idb://".concat(n,"/").concat(t)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[a.query.index.name||""]=y)),Bi(O,y,p,v),O.promise.then(function(b){return{result:ti(b.result,a,S?.optimisticOps,r,O,c)}})}})}})}};function Lt(e,n){return new Proxy(e,{get:function(t,r,i){return r==="db"?n:Reflect.get(t,r,i)}})}var nt=(hn.prototype.version=function(e){if(isNaN(e)||e<.1)throw new _.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new _.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var n=this._versions,t=n.filter(function(r){return r._cfg.version===e})[0];return t||(t=new this.Version(e),n.push(t),n.sort(xi),t.stores({}),this._state.autoSchema=!1,t)},hn.prototype._whenReady=function(e){var n=this;return this.idbdb&&(this._state.openComplete||f.letThrough||this._vip)?e():new B(function(t,r){if(n._state.openComplete)return r(new _.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._state.autoOpen)return void r(new _.DatabaseClosed);n.open().catch(j)}n._state.dbReadyPromise.then(t,r)}).then(e)},hn.prototype.use=function(e){var n=e.stack,t=e.create,r=e.level,i=e.name;return i&&this.unuse({stack:n,name:i}),e=this._middlewares[n]||(this._middlewares[n]=[]),e.push({stack:n,create:t,level:r??10,name:i}),e.sort(function(a,c){return a.level-c.level}),this},hn.prototype.unuse=function(e){var n=e.stack,t=e.name,r=e.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(i){return r?i.create!==r:!!t&&i.name!==t})),this},hn.prototype.open=function(){var e=this;return sn(u,function(){return Ti(e)})},hn.prototype._close=function(){var e=this._state,n=Rn.indexOf(this);if(0<=n&&Rn.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new B(function(t){e.dbReadyResolve=t}),e.openCanceller=new B(function(t,r){e.cancelOpen=r}))},hn.prototype.close=function(t){var n=(t===void 0?{disableAutoOpen:!0}:t).disableAutoOpen,t=this._state;n?(t.isBeingOpened&&t.cancelOpen(new _.DatabaseClosed),this._close(),t.autoOpen=!1,t.dbOpenError=new _.DatabaseClosed):(this._close(),t.autoOpen=this._options.autoOpen||t.isBeingOpened,t.openComplete=!1,t.dbOpenError=null)},hn.prototype.delete=function(e){var n=this;e===void 0&&(e={disableAutoOpen:!0});var t=0<arguments.length&&typeof arguments[0]!="object",r=this._state;return new B(function(i,a){function c(){n.close(e);var p=n._deps.indexedDB.deleteDatabase(n.name);p.onsuccess=z(function(){var v,d,O;v=n._deps,d=n.name,O=v.indexedDB,v=v.IDBKeyRange,cr(O)||d===yn||sr(O,v).delete(d).catch(j),i()}),p.onerror=Xn(a),p.onblocked=n._fireOnBlocked}if(t)throw new _.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(c):c()})},hn.prototype.backendDB=function(){return this.idbdb},hn.prototype.isOpen=function(){return this.idbdb!==null},hn.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},hn.prototype.hasFailed=function(){return this._state.dbOpenError!==null},hn.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(hn.prototype,"tables",{get:function(){var e=this;return L(this._allTables).map(function(n){return e._allTables[n]})},enumerable:!1,configurable:!0}),hn.prototype.transaction=function(){var e=function(n,t,r){var i=arguments.length;if(i<2)throw new _.InvalidArgument("Too few arguments");for(var a=new Array(i-1);--i;)a[i-1]=arguments[i];return r=a.pop(),[n,bn(a),r]}.apply(this,arguments);return this._transaction.apply(this,e)},hn.prototype._transaction=function(e,n,t){var r=this,i=f.trans;i&&i.db===this&&e.indexOf("!")===-1||(i=null);var a,c,p=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(c=n.map(function(d){if(d=d instanceof r.Table?d.name:d,typeof d!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return d}),e=="r"||e===Mn)a=Mn;else{if(e!="rw"&&e!=Wn)throw new _.InvalidArgument("Invalid transaction mode: "+e);a=Wn}if(i){if(i.mode===Mn&&a===Wn){if(!p)throw new _.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&c.forEach(function(d){if(i&&i.storeNames.indexOf(d)===-1){if(!p)throw new _.SubTransaction("Table "+d+" not included in parent transaction.");i=null}}),p&&i&&!i.active&&(i=null)}}catch(d){return i?i._promise(null,function(O,h){h(d)}):on(d)}var v=function d(O,h,S,y,b){return B.resolve().then(function(){var x=f.transless||f,m=O._createTransaction(h,S,O._dbSchema,y);if(m.explicit=!0,x={trans:m,transless:x},y)m.idbtrans=y.idbtrans;else try{m.create(),m.idbtrans._explicit=!0,O._state.PR1398_maxLoop=3}catch(N){return N.name===Qe.InvalidState&&O.isOpen()&&0<--O._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),O.close({disableAutoOpen:!1}),O.open().then(function(){return d(O,h,S,null,b)})):on(N)}var P,C=dn(b);return C&&fn(),x=B.follow(function(){var N;(P=b.call(m,m))&&(C?(N=pn.bind(null,null),P.then(N,N)):typeof P.next=="function"&&typeof P.throw=="function"&&(P=vr(P)))},x),(P&&typeof P.then=="function"?B.resolve(P).then(function(N){return m.active?N:on(new _.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):x.then(function(){return P})).then(function(N){return y&&m._resolve(),m._completion.then(function(){return N})}).catch(function(N){return m._reject(N),on(N)})})}.bind(null,this,a,c,i,t);return i?i._promise(a,v,"lock"):f.trans?sn(f.transless,function(){return r._whenReady(v)}):this._whenReady(v)},hn.prototype.table=function(e){if(!k(this._allTables,e))throw new _.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},hn);function hn(e,n){var t=this;this._middlewares={},this.verno=0;var r=hn.dependencies;this._options=n=E({addons:hn.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,cache:"cloned"},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange},r=n.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var i,a,c,p,v,d={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:j,dbReadyPromise:null,cancelOpen:j,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:n.autoOpen};d.dbReadyPromise=new B(function(h){d.dbReadyResolve=h}),d.openCanceller=new B(function(h,S){d.cancelOpen=S}),this._state=d,this.name=e,this.on=yt(this,"populate","blocked","versionchange","close",{ready:[_n,j]}),this.on.ready.subscribe=vn(this.on.ready.subscribe,function(h){return function(S,y){hn.vip(function(){var b,x=t._state;x.openComplete?(x.dbOpenError||B.resolve().then(S),y&&h(S)):x.onReadyBeingFired?(x.onReadyBeingFired.push(S),y&&h(S)):(h(S),b=t,y||h(function m(){b.on.ready.unsubscribe(S),b.on.ready.unsubscribe(m)}))})}}),this.Collection=(i=this,vt(mi.prototype,function(P,m){this.db=i;var y=Br,b=null;if(m)try{y=m()}catch(C){b=C}var x=P._ctx,m=x.table,P=m.hook.reading.fire;this._ctx={table:m,index:x.index,isPrimKey:!x.index||m.schema.primKey.keyPath&&x.index===m.schema.primKey.name,range:y,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:b,or:x.or,valueMapper:P!==H?P:null}})),this.Table=(a=this,vt(Ur.prototype,function(h,S,y){this.db=a,this._tx=y,this.name=h,this.schema=S,this.hook=a._allTables[h]?a._allTables[h].hook:yt(null,{creating:[Te,j],reading:[Se,H],updating:[mn,j],deleting:[ue,j]})})),this.Transaction=(c=this,vt(wi.prototype,function(h,S,y,b,x){var m=this;this.db=c,this.mode=h,this.storeNames=S,this.schema=y,this.chromeTransactionDurability=b,this.idbtrans=null,this.on=yt(this,"complete","error","abort"),this.parent=x||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new B(function(P,C){m._resolve=P,m._reject=C}),this._completion.then(function(){m.active=!1,m.on.complete.fire()},function(P){var C=m.active;return m.active=!1,m.on.error.fire(P),m.parent?m.parent._reject(P):C&&m.idbtrans&&m.idbtrans.abort(),on(P)})})),this.Version=(p=this,vt(ki.prototype,function(h){this.db=p,this._cfg={version:h,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(v=this,vt(Vr.prototype,function(h,S,y){if(this.db=v,this._ctx={table:h,index:S===":id"?null:S,or:y},this._cmp=this._ascending=Fe,this._descending=function(b,x){return Fe(x,b)},this._max=function(b,x){return 0<Fe(b,x)?b:x},this._min=function(b,x){return Fe(b,x)<0?b:x},this._IDBKeyRange=v._deps.IDBKeyRange,!this._IDBKeyRange)throw new _.MissingAPI})),this.on("versionchange",function(h){0<h.newVersion?console.warn("Another connection wants to upgrade database '".concat(t.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(t.name,"'. Closing db now to resume the delete request.")),t.close({disableAutoOpen:!1})}),this.on("blocked",function(h){!h.newVersion||h.newVersion<h.oldVersion?console.warn("Dexie.delete('".concat(t.name,"') was blocked")):console.warn("Upgrade '".concat(t.name,"' blocked by other connection holding version ").concat(h.oldVersion/10))}),this._maxKey=wt(n.IDBKeyRange),this._createTransaction=function(h,S,y,b){return new t.Transaction(h,S,y,t._options.chromeTransactionDurability,b)},this._fireOnBlocked=function(h){t.on("blocked").fire(h),Rn.filter(function(S){return S.name===t.name&&S!==t&&!S._state.vcFired}).map(function(S){return S.on("versionchange").fire(h)})},this.use(Ni),this.use(Ki),this.use(ji),this.use(Pi),this.use(Ci);var O=new Proxy(this,{get:function(h,S,y){if(S==="_vip")return!0;if(S==="table")return function(x){return Lt(t.table(x),O)};var b=Reflect.get(h,S,y);return b instanceof Ur?Lt(b,O):S==="tables"?b.map(function(x){return Lt(x,O)}):S==="_createTransaction"?function(){return Lt(b.apply(this,arguments),O)}:b}});this.vip=O,r.forEach(function(h){return h(t)})}var qt,Jn=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ri=(wr.prototype.subscribe=function(e,n,t){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:n,complete:t})},wr.prototype[Jn]=function(){return this},wr);function wr(e){this._subscribe=e}try{qt={indexedDB:D.indexedDB||D.mozIndexedDB||D.webkitIndexedDB||D.msIndexedDB,IDBKeyRange:D.IDBKeyRange||D.webkitIDBKeyRange}}catch{qt={indexedDB:null,IDBKeyRange:null}}function ii(e){var n,t=!1,r=new Ri(function(i){var a=dn(e),c,p=!1,v={},d={},O={get closed(){return p},unsubscribe:function(){p||(p=!0,c&&c.abort(),h&&it.storagemutated.unsubscribe(y))}};i.start&&i.start(O);var h=!1,S=function(){return Kn(b)},y=function(x){Dt(v,x),pr(d,v)&&S()},b=function(){var x,m,P;!p&&qt.indexedDB&&(v={},x={},c&&c.abort(),c=new AbortController,P=function(C){var N=Re();try{a&&fn();var U=We(e,C);return U=a?U.finally(pn):U}finally{N&&De()}}(m={subscr:x,signal:c.signal,requery:S,querier:e,trans:null}),Promise.resolve(P).then(function(C){t=!0,n=C,p||m.signal.aborted||(v={},function(N){for(var U in N)if(k(N,U))return;return 1}(d=x)||h||(it(gt,y),h=!0),Kn(function(){return!p&&i.next&&i.next(C)}))},function(C){t=!1,["DatabaseClosedError","AbortError"].includes(C?.name)||p||Kn(function(){p||i.error&&i.error(C)})}))};return setTimeout(S,0),O});return r.hasValue=function(){return t},r.getValue=function(){return n},r}var st=nt;function _r(e){var n=ot;try{ot=!0,it.storagemutated.fire(e),yr(e,!0)}finally{ot=n}}W(st,E(E({},q),{delete:function(e){return new st(e,{addons:[]}).delete()},exists:function(e){return new st(e,{addons:[]}).open().then(function(n){return n.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return n=st.dependencies,t=n.indexedDB,n=n.IDBKeyRange,(cr(t)?Promise.resolve(t.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==yn})}):sr(t,n).toCollection().primaryKeys()).then(e)}catch{return on(new _.MissingAPI)}var n,t},defineClass:function(){return function(e){g(this,e)}},ignoreTransaction:function(e){return f.trans?sn(f.transless,e):e()},vip:lr,async:function(e){return function(){try{var n=vr(e.apply(this,arguments));return n&&typeof n.then=="function"?n:B.resolve(n)}catch(t){return on(t)}}},spawn:function(e,n,t){try{var r=vr(e.apply(t,n||[]));return r&&typeof r.then=="function"?r:B.resolve(r)}catch(i){return on(i)}},currentTransaction:{get:function(){return f.trans||null}},waitFor:function(e,n){return n=B.resolve(typeof e=="function"?st.ignoreTransaction(e):e).timeout(n||6e4),f.trans?f.trans.waitFor(n):n},Promise:B,debug:{get:function(){return cn},set:function(e){Fn(e)}},derive:Xe,extend:g,props:W,override:vn,Events:yt,on:it,liveQuery:ii,extendObservabilitySet:Dt,getByKeyPath:rn,setByKeyPath:oe,delByKeyPath:function(e,n){typeof n=="string"?oe(e,n,void 0):"length"in n&&[].map.call(n,function(t){oe(e,t,void 0)})},shallowClone:Le,deepClone:V,getObjectDiff:mr,cmp:Fe,asap:re,minKey:-1/0,addons:[],connections:Rn,errnames:Qe,dependencies:qt,cache:ut,semVer:"4.0.8",version:"4.0.8".split(".").map(function(e){return parseInt(e)}).reduce(function(e,n,t){return e+n/Math.pow(10,2*t)})})),st.maxKey=wt(st.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(it(gt,function(e){ot||(e=new CustomEvent(nr,{detail:e}),ot=!0,dispatchEvent(e),ot=!1)}),addEventListener(nr,function(e){e=e.detail,ot||_r(e)}));var ht,ot=!1,oi=function(){};return typeof BroadcastChannel<"u"&&((oi=function(){(ht=new BroadcastChannel(nr)).onmessage=function(e){return e.data&&_r(e.data)}})(),typeof ht.unref=="function"&&ht.unref(),it(gt,function(e){ot||ht.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!nt.disableBfCache&&e.persisted){cn&&console.debug("Dexie: handling persisted pagehide"),ht?.close();for(var n=0,t=Rn;n<t.length;n++)t[n].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!nt.disableBfCache&&e.persisted&&(cn&&console.debug("Dexie: handling persisted pageshow"),oi(),_r({all:new Dn(-1/0,[[]])}))})),B.rejectionMapper=function(e,n){return!e||e instanceof ze||e instanceof TypeError||e instanceof SyntaxError||!e.name||!F[e.name]?e:(n=new F[e.name](n||e.message,e),"stack"in e&&Ge(n,"stack",{get:function(){return this.inner.stack}}),n)},Fn(cn),E(nt,Object.freeze({__proto__:null,Dexie:nt,liveQuery:ii,Entity:Kr,cmp:Fe,PropModSymbol:et,PropModification:mt,replacePrefix:function(e,n){return new mt({replacePrefix:[e,n]})},add:function(e){return new mt({add:e})},remove:function(e){return new mt({remove:e})},default:nt,RangeSet:Dn,mergeRanges:St,rangesOverlap:zr}),{default:nt}),nt})});var Fi=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Sr={randomUUID:Fi};var Jt,Li=new Uint8Array(16);function xr(){if(!Jt&&(Jt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Jt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Jt(Li)}var Sn=[];for(let K=0;K<256;++K)Sn.push((K+256).toString(16).slice(1));function ui(K,E=0){return Sn[K[E+0]]+Sn[K[E+1]]+Sn[K[E+2]]+Sn[K[E+3]]+"-"+Sn[K[E+4]]+Sn[K[E+5]]+"-"+Sn[K[E+6]]+Sn[K[E+7]]+"-"+Sn[K[E+8]]+Sn[K[E+9]]+"-"+Sn[K[E+10]]+Sn[K[E+11]]+Sn[K[E+12]]+Sn[K[E+13]]+Sn[K[E+14]]+Sn[K[E+15]]}function qi(K,E,T){if(Sr.randomUUID&&!E&&!K)return Sr.randomUUID();K=K||{};let D=K.random||(K.rng||xr)();if(D[6]=D[6]&15|64,D[8]=D[8]&63|128,E){T=T||0;for(let L=0;L<16;++L)E[T+L]=D[L];return E}return ui(D)}var Er=qi;var Gt=Ui(si(),1),ci=Symbol.for("Dexie"),zt=globalThis[ci]||(globalThis[ci]=Gt.default);if(Gt.default.semVer!==zt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Gt.default.semVer} and ${zt.semVer}`);var{liveQuery:li,mergeRanges:lo,rangesOverlap:fo,RangeSet:po,cmp:ho,Entity:yo,PropModSymbol:vo,PropModification:mo,replacePrefix:bo,add:go,remove:wo}=zt;var xn=zt;function at(K,E,T,D){function L(A){return A instanceof T?A:new T(function(g){g(A)})}return new(T||(T=Promise))(function(A,g){function te(W){try{k(D.next(W))}catch(he){g(he)}}function se(W){try{k(D.throw(W))}catch(he){g(he)}}function k(W){W.done?A(W.value):L(W.value).then(te,se)}k((D=D.apply(K,E||[])).next())})}function Qn(K,E){var T={label:0,sent:function(){if(A[0]&1)throw A[1];return A[1]},trys:[],ops:[]},D,L,A,g;return g={next:te(0),throw:te(1),return:te(2)},typeof Symbol=="function"&&(g[Symbol.iterator]=function(){return this}),g;function te(k){return function(W){return se([k,W])}}function se(k){if(D)throw new TypeError("Generator is already executing.");for(;T;)try{if(D=1,L&&(A=k[0]&2?L.return:k[0]?L.throw||((A=L.return)&&A.call(L),0):L.next)&&!(A=A.call(L,k[1])).done)return A;switch(L=0,A&&(k=[k[0]&2,A.value]),k[0]){case 0:case 1:A=k;break;case 4:return T.label++,{value:k[1],done:!1};case 5:T.label++,L=k[1],k=[0];continue;case 7:k=T.ops.pop(),T.trys.pop();continue;default:if(A=T.trys,!(A=A.length>0&&A[A.length-1])&&(k[0]===6||k[0]===2)){T=0;continue}if(k[0]===3&&(!A||k[1]>A[0]&&k[1]<A[3])){T.label=k[1];break}if(k[0]===6&&T.label<A[1]){T.label=A[1],A=k;break}if(A&&T.label<A[2]){T.label=A[2],T.ops.push(k);break}A[2]&&T.ops.pop(),T.trys.pop();continue}k=E.call(K,T)}catch(W){k=[6,W],L=0}finally{D=A=0}if(k[0]&5)throw k[1];return{value:k[0]?k[1]:void 0,done:!0}}}function Mi(K){var E=[K.schema.primKey].concat(K.schema.indexes);return E.map(function(T){return T.src}).join(",")}function Vi(K){for(var E={},T=0,D=K.tables;T<D.length;T++){var L=D[T];E[L.name]=L.schema}return E}function fi(K,E){return new Promise(function(T,D){var L=new FileReader;L.onabort=function(A){return D(new Error("file read aborted"))},L.onerror=function(A){return D(A.target.error)},L.onload=function(A){return T(A.target.result)},E==="binary"?L.readAsArrayBuffer(K):L.readAsText(K)})}function pi(K,E){if(typeof FileReaderSync>"u")throw new Error("FileReaderSync missing. Reading blobs synchronously requires code to run from within a web worker. Use TSON.encapsulateAsync() to do it from the main thread.");var T=new FileReaderSync,D=E==="binary"?T.readAsArrayBuffer(K):T.readAsText(K);return D}var Pr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Nr(K,E){return E={exports:{}},K(E,E.exports),E.exports}var Ht=Nr(function(K,E){(function(T,D){K.exports=D()})(Pr,function(){function T(_){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?T=function(F){return typeof F}:T=function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F},T(_)}function D(_,F,q,j,H,Se,me){try{var Te=_[Se](me),ue=Te.value}catch(mn){q(mn);return}Te.done?F(ue):Promise.resolve(ue).then(j,H)}function L(_){return function(){var F=this,q=arguments;return new Promise(function(j,H){var Se=_.apply(F,q);function me(ue){D(Se,j,H,me,Te,"next",ue)}function Te(ue){D(Se,j,H,me,Te,"throw",ue)}me(void 0)})}}function A(_,F){if(!(_ instanceof F))throw new TypeError("Cannot call a class as a function")}function g(_,F){for(var q=0;q<F.length;q++){var j=F[q];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(_,j.key,j)}}function te(_,F,q){return F&&g(_.prototype,F),q&&g(_,q),_}function se(_,F,q){return F in _?Object.defineProperty(_,F,{value:q,enumerable:!0,configurable:!0,writable:!0}):_[F]=q,_}function k(_,F){var q=Object.keys(_);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(_);F&&(j=j.filter(function(H){return Object.getOwnPropertyDescriptor(_,H).enumerable})),q.push.apply(q,j)}return q}function W(_){for(var F=1;F<arguments.length;F++){var q=arguments[F]!=null?arguments[F]:{};F%2?k(Object(q),!0).forEach(function(j){se(_,j,q[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_,Object.getOwnPropertyDescriptors(q)):k(Object(q)).forEach(function(j){Object.defineProperty(_,j,Object.getOwnPropertyDescriptor(q,j))})}return _}function he(_,F){return Oe(_)||Ce(_,F)||Ze()}function Ge(_){return Xe(_)||ge(_)||vn()}function Xe(_){if(Array.isArray(_)){for(var F=0,q=new Array(_.length);F<_.length;F++)q[F]=_[F];return q}}function Oe(_){if(Array.isArray(_))return _}function ge(_){if(Symbol.iterator in Object(_)||Object.prototype.toString.call(_)==="[object Arguments]")return Array.from(_)}function Ce(_,F){if(Symbol.iterator in Object(_)||Object.prototype.toString.call(_)==="[object Arguments]"){var q=[],j=!0,H=!1,Se=void 0;try{for(var me=_[Symbol.iterator](),Te;!(j=(Te=me.next()).done)&&(q.push(Te.value),!(F&&q.length===F));j=!0);}catch(ue){H=!0,Se=ue}finally{try{!j&&me.return!=null&&me.return()}finally{if(H)throw Se}}return q}}function vn(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Ze(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var re=function _(F){A(this,_),this.p=new Promise(F)};re.__typeson__type__="TypesonPromise",typeof Symbol<"u"&&(re.prototype[Symbol.toStringTag]="TypesonPromise"),re.prototype.then=function(_,F){var q=this;return new re(function(j,H){q.p.then(function(Se){j(_?_(Se):Se)}).catch(function(Se){return F?F(Se):Promise.reject(Se)}).then(j,H)})},re.prototype.catch=function(_){return this.then(null,_)},re.resolve=function(_){return new re(function(F){F(_)})},re.reject=function(_){return new re(function(F,q){q(_)})},["all","race"].forEach(function(_){re[_]=function(F){return new re(function(q,j){Promise[_](F.map(function(H){return H&&H.constructor&&H.constructor.__typeson__type__==="TypesonPromise"?H.p:H})).then(q,j)})}});var rn={},oe=rn.toString,Le={}.hasOwnProperty,Ye=Object.getPrototypeOf,bn=Le.toString;function I(_,F){return ve(_)&&typeof _.then=="function"&&(!F||typeof _.catch=="function")}function l(_){return oe.call(_).slice(8,-1)}function V(_,F){if(!_||T(_)!=="object")return!1;var q=Ye(_);if(!q)return F===null;var j=Le.call(q,"constructor")&&q.constructor;return typeof j!="function"?F===null:F===j||F!==null&&bn.call(j)===bn.call(F)||typeof F=="function"&&typeof j.__typeson__type__=="string"&&j.__typeson__type__===F.__typeson__type__}function R(_){if(!_||l(_)!=="Object")return!1;var F=Ye(_);return F?V(_,Object):!0}function Ne(_){if(!_||l(_)!=="Object")return!1;var F=Ye(_);return F?V(_,Object)||Ne(F):!0}function ve(_){return _&&T(_)==="object"}function Je(_){return _.replace(/~/g,"~0").replace(/\./g,"~1")}function qe(_){return _.replace(/~1/g,".").replace(/~0/g,"~")}function en(_,F){if(F==="")return _;var q=F.indexOf(".");if(q>-1){var j=_[qe(F.slice(0,q))];return j===void 0?void 0:en(j,F.slice(q+1))}return _[qe(F)]}function un(_,F,q){if(F==="")return q;var j=F.indexOf(".");if(j>-1){var H=_[qe(F.slice(0,j))];return un(H,F.slice(j+1),q)}return _[qe(F)]=q,_}function dn(_){return _===null?"null":Array.isArray(_)?"array":T(_)}var He=Object.keys,ze=Array.isArray,wn={}.hasOwnProperty,En=["type","replaced","iterateIn","iterateUnsetNumeric"];function pe(_,F){if(_.keypath==="")return-1;var q=_.keypath.match(/\./g)||0,j=F.keypath.match(/\./g)||0;return q&&(q=q.length),j&&(j=j.length),q>j?-1:q<j?1:_.keypath<F.keypath?-1:_.keypath>F.keypath}var Qe=function(){function _(F){A(this,_),this.options=F,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return te(_,[{key:"stringify",value:function(q,j,H,Se){Se=W({},this.options,{},Se,{stringification:!0});var me=this.encapsulate(q,null,Se);return ze(me)?JSON.stringify(me[0],j,H):me.then(function(Te){return JSON.stringify(Te,j,H)})}},{key:"stringifySync",value:function(q,j,H,Se){return this.stringify(q,j,H,W({throwOnBadSyncType:!0},Se,{sync:!0}))}},{key:"stringifyAsync",value:function(q,j,H,Se){return this.stringify(q,j,H,W({throwOnBadSyncType:!0},Se,{sync:!1}))}},{key:"parse",value:function(q,j,H){return H=W({},this.options,{},H,{parse:!0}),this.revive(JSON.parse(q,j),H)}},{key:"parseSync",value:function(q,j,H){return this.parse(q,j,W({throwOnBadSyncType:!0},H,{sync:!0}))}},{key:"parseAsync",value:function(q,j,H){return this.parse(q,j,W({throwOnBadSyncType:!0},H,{sync:!1}))}},{key:"specialTypeNames",value:function(q,j){var H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return H.returnTypeNames=!0,this.encapsulate(q,j,H)}},{key:"rootTypeName",value:function(q,j){var H=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return H.iterateNone=!0,this.encapsulate(q,j,H)}},{key:"encapsulate",value:function(q,j,H){H=W({sync:!0},this.options,{},H);var Se=H,me=Se.sync,Te=this,ue={},mn=[],kn=[],_n=[],cn="cyclic"in H?H.cyclic:!0,Fn=H,In=Fn.encapsulateObserver,Tn=Ve("",q,cn,j||{},_n);function On(ie){var s=Object.values(ue);if(H.iterateNone)return s.length?s[0]:_.getJSONType(ie);if(s.length){if(H.returnTypeNames)return Ge(new Set(s));!ie||!R(ie)||wn.call(ie,"$types")?ie={$:ie,$types:{$:ue}}:ie.$types=ue}else ve(ie)&&wn.call(ie,"$types")&&(ie={$:ie,$types:!0});return H.returnTypeNames?!1:ie}function nn(ie,s){return Me.apply(this,arguments)}function Me(){return Me=L(regeneratorRuntime.mark(function ie(s,o){var u;return regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,Promise.all(o.map(function(G){return G[1].p}));case 2:return u=w.sent,w.next=5,Promise.all(u.map(function(){var G=L(regeneratorRuntime.mark(function Q(B){var ne,ce,we,xe,Ke,Ie,je,Re,De,de,ln,z,M,le;return regeneratorRuntime.wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:if(ne=[],ce=o.splice(0,1),we=he(ce,1),xe=we[0],Ke=he(xe,7),Ie=Ke[0],je=Ke[2],Re=Ke[3],De=Ke[4],de=Ke[5],ln=Ke[6],z=Ve(Ie,B,je,Re,ne,!0,ln),M=V(z,re),!(Ie&&M)){fe.next=11;break}return fe.next=8,z.p;case 8:return le=fe.sent,De[de]=le,fe.abrupt("return",nn(s,ne));case 11:return Ie?De[de]=z:M?s=z.p:s=z,fe.abrupt("return",nn(s,ne));case 13:case"end":return fe.stop()}},Q)}));return function(Q){return G.apply(this,arguments)}}()));case 5:return w.abrupt("return",s);case 6:case"end":return w.stop()}},ie)})),Me.apply(this,arguments)}function Pe(ie,s,o){Object.assign(ie,s);var u=En.map(function(f){var w=ie[f];return delete ie[f],w});o(),En.forEach(function(f,w){ie[f]=u[w]})}function Ve(ie,s,o,u,f,w,G){var Q,B={},ne=T(s),ce=In?function(M){var le=G||u.type||_.getJSONType(s);In(Object.assign(M||B,{keypath:ie,value:s,cyclic:o,stateObj:u,promisesData:f,resolvingTypesonPromise:w,awaitingTypesonPromise:V(s,re)},{type:le}))}:null;if(["string","boolean","number","undefined"].includes(ne))return s===void 0||ne==="number"&&(isNaN(s)||s===-1/0||s===1/0)?(u.replaced?Q=s:Q=tn(ie,s,u,f,!1,w,ce),Q!==s&&(B={replaced:Q})):Q=s,ce&&ce(),Q;if(s===null)return ce&&ce(),s;if(o&&!u.iterateIn&&!u.iterateUnsetNumeric&&s&&T(s)==="object"){var we=mn.indexOf(s);if(we<0)o===!0&&(mn.push(s),kn.push(ie));else return ue[ie]="#",ce&&ce({cyclicKeypath:kn[we]}),"#"+kn[we]}var xe=R(s),Ke=ze(s),Ie=(xe||Ke)&&(!Te.plainObjectReplacers.length||u.replaced)||u.iterateIn?s:tn(ie,s,u,f,xe||Ke,null,ce),je;if(Ie!==s?(Q=Ie,B={replaced:Ie}):ie===""&&V(s,re)?(f.push([ie,s,o,u,void 0,void 0,u.type]),Q=s):Ke&&u.iterateIn!=="object"||u.iterateIn==="array"?(je=new Array(s.length),B={clone:je}):!["function","symbol"].includes(T(s))&&!("toJSON"in s)&&!V(s,re)&&!V(s,Promise)&&!V(s,ArrayBuffer)||xe||u.iterateIn==="object"?(je={},u.addLength&&(je.length=s.length),B={clone:je}):Q=s,ce&&ce(),H.iterateNone)return je||Q;if(!je)return Q;if(u.iterateIn){var Re=function(le){var ae={ownKeys:wn.call(s,le)};Pe(u,ae,function(){var fe=ie+(ie?".":"")+Je(le),_e=Ve(fe,s[le],!!o,u,f,w);V(_e,re)?f.push([fe,_e,!!o,u,je,le,u.type]):_e!==void 0&&(je[le]=_e)})};for(var De in s)Re(De);ce&&ce({endIterateIn:!0,end:!0})}else He(s).forEach(function(M){var le=ie+(ie?".":"")+Je(M),ae={ownKeys:!0};Pe(u,ae,function(){var fe=Ve(le,s[M],!!o,u,f,w);V(fe,re)?f.push([le,fe,!!o,u,je,M,u.type]):fe!==void 0&&(je[M]=fe)})}),ce&&ce({endIterateOwn:!0,end:!0});if(u.iterateUnsetNumeric){for(var de=s.length,ln=function(le){if(!(le in s)){var ae=ie+(ie?".":"")+le,fe={ownKeys:!1};Pe(u,fe,function(){var _e=Ve(ae,void 0,!!o,u,f,w);V(_e,re)?f.push([ae,_e,!!o,u,je,le,u.type]):_e!==void 0&&(je[le]=_e)})}},z=0;z<de;z++)ln(z);ce&&ce({endIterateUnsetNumeric:!0,end:!0})}return je}function tn(ie,s,o,u,f,w,G){for(var Q=f?Te.plainObjectReplacers:Te.nonplainObjectReplacers,B=Q.length;B--;){var ne=Q[B];if(ne.test(s,o)){var ce=ne.type;if(Te.revivers[ce]){var we=ue[ie];ue[ie]=we?[ce].concat(we):ce}if(Object.assign(o,{type:ce,replaced:!0}),(me||!ne.replaceAsync)&&!ne.replace)return G&&G({typeDetected:!0}),Ve(ie,s,cn&&"readonly",o,u,w,ce);G&&G({replacing:!0});var xe=me||!ne.replaceAsync?"replace":"replaceAsync";return Ve(ie,ne[xe](s,o),cn&&"readonly",o,u,w,ce)}}return s}return _n.length?me&&H.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(nn(Tn,_n)).then(On):!me&&H.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():H.stringification&&me?[On(Tn)]:me?On(Tn):Promise.resolve(On(Tn))}},{key:"encapsulateSync",value:function(q,j,H){return this.encapsulate(q,j,W({throwOnBadSyncType:!0},H,{sync:!0}))}},{key:"encapsulateAsync",value:function(q,j,H){return this.encapsulate(q,j,W({throwOnBadSyncType:!0},H,{sync:!1}))}},{key:"revive",value:function(q,j){var H=q&&q.$types;if(!H)return q;if(H===!0)return q.$;j=W({sync:!0},this.options,{},j);var Se=j,me=Se.sync,Te=[],ue={},mn=!0;H.$&&R(H.$)&&(q=q.$,H=H.$,mn=!1);var kn=this;function _n(Me,Pe){var Ve=kn.revivers[Me]||[],tn=he(Ve,1),ie=tn[0];if(!ie)throw new Error("Unregistered type: "+Me);return me&&!("revive"in ie)?Pe:ie[me&&ie.revive?"revive":!me&&ie.reviveAsync?"reviveAsync":"revive"](Pe,ue)}function cn(){var Me=[];if(Object.entries(H).forEach(function(Pe){var Ve=he(Pe,2),tn=Ve[0],ie=Ve[1];ie!=="#"&&[].concat(ie).forEach(function(s){var o=kn.revivers[s]||[null,{}],u=he(o,2),f=u[1].plain;f&&(Me.push({keypath:tn,type:s}),delete H[tn])})}),!!Me.length)return Me.sort(pe).reduce(function Pe(Ve,tn){var ie=tn.keypath,s=tn.type;if(I(Ve))return Ve.then(function(f){return Pe(f,{keypath:ie,type:s})});var o=en(q,ie);if(o=_n(s,o),V(o,re))return o.then(function(f){var w=un(q,ie,f);w===f&&(q=w)});var u=un(q,ie,o);u===o&&(q=u)},void 0)}var Fn=[];function In(Me,Pe,Ve,tn,ie){if(!(mn&&Me==="$types")){var s=H[Me],o=ze(Pe);if(o||R(Pe)){var u=o?new Array(Pe.length):{};for(He(Pe).forEach(function(we){var xe=In(Me+(Me?".":"")+Je(we),Pe[we],Ve||u,u,we),Ke=function(je){return V(je,An)?u[we]=void 0:je!==void 0&&(u[we]=je),je};V(xe,re)?Fn.push(xe.then(function(Ie){return Ke(Ie)})):Ke(xe)}),Pe=u;Te.length;){var f=he(Te[0],4),w=f[0],G=f[1],Q=f[2],B=f[3],ne=en(w,G);if(ne!==void 0)Q[B]=ne;else break;Te.splice(0,1)}}if(!s)return Pe;if(s==="#"){var ce=en(Ve,Pe.slice(1));return ce===void 0&&Te.push([Ve,Pe.slice(1),tn,ie]),ce}return[].concat(s).reduce(function we(xe,Ke){return V(xe,re)?xe.then(function(Ie){return we(Ie,Ke)}):_n(Ke,xe)},Pe)}}function Tn(Me){return V(Me,An)?void 0:Me}var On=cn(),nn;return V(On,re)?nn=On.then(function(){return q}):(nn=In("",q,null),Fn.length&&(nn=re.resolve(nn).then(function(Me){return re.all([Me].concat(Fn))}).then(function(Me){var Pe=he(Me,1),Ve=Pe[0];return Ve}))),I(nn)?me&&j.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():V(nn,re)?nn.p.then(Tn):nn:!me&&j.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():me?Tn(nn):Promise.resolve(Tn(nn))}},{key:"reviveSync",value:function(q,j){return this.revive(q,W({throwOnBadSyncType:!0},j,{sync:!0}))}},{key:"reviveAsync",value:function(q,j){return this.revive(q,W({throwOnBadSyncType:!0},j,{sync:!1}))}},{key:"register",value:function(q,j){return j=j||{},[].concat(q).forEach(function H(Se){var me=this;if(ze(Se))return Se.map(function(Te){return H.call(me,Te)});Se&&He(Se).forEach(function(Te){if(Te==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(_.JSON_TYPES.includes(Te))throw new TypeError("Plain JSON object types are reserved as type names");var ue=Se[Te],mn=ue&&ue.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,kn=mn.filter(function(Ve){return Ve.type===Te});if(kn.length&&(mn.splice(mn.indexOf(kn[0]),1),delete this.revivers[Te],delete this.types[Te]),typeof ue=="function"){var _n=ue;ue={test:function(tn){return tn&&tn.constructor===_n},replace:function(tn){return W({},tn)},revive:function(tn){return Object.assign(Object.create(_n.prototype),tn)}}}else if(ze(ue)){var cn=ue,Fn=he(cn,3),In=Fn[0],Tn=Fn[1],On=Fn[2];ue={test:In,replace:Tn,revive:On}}if(!(!ue||!ue.test)){var nn={type:Te,test:ue.test.bind(ue)};ue.replace&&(nn.replace=ue.replace.bind(ue)),ue.replaceAsync&&(nn.replaceAsync=ue.replaceAsync.bind(ue));var Me=typeof j.fallback=="number"?j.fallback:j.fallback?0:1/0;if(ue.testPlainObjects?this.plainObjectReplacers.splice(Me,0,nn):this.nonplainObjectReplacers.splice(Me,0,nn),ue.revive||ue.reviveAsync){var Pe={};ue.revive&&(Pe.revive=ue.revive.bind(ue)),ue.reviveAsync&&(Pe.reviveAsync=ue.reviveAsync.bind(ue)),this.revivers[Te]=[Pe,{plain:ue.testPlainObjects}]}this.types[Te]=ue}},this)},this),this}}]),_}(),An=function _(){A(this,_)};return An.__typeson__type__="TypesonUndefined",Qe.Undefined=An,Qe.Promise=re,Qe.isThenable=I,Qe.toStringTag=l,Qe.hasConstructorOf=V,Qe.isObject=ve,Qe.isPlainObject=R,Qe.isUserObject=Ne,Qe.escapeKeyPathComponent=Je,Qe.unescapeKeyPathComponent=qe,Qe.getByKeyPath=en,Qe.getJSONType=dn,Qe.JSON_TYPES=["null","boolean","number","string","array","object"],Qe})}),$i=Nr(function(K,E){(function(T,D){K.exports=D()})(Pr,function(){function T(s){return(T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(s)}function D(s,o){if(!(s instanceof o))throw new TypeError("Cannot call a class as a function")}function L(s,o){for(var u=0;u<o.length;u++){var f=o[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(s,f.key,f)}}function A(s,o,u){return o in s?Object.defineProperty(s,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):s[o]=u,s}function g(s,o){var u=Object.keys(s);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(s);o&&(f=f.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),u.push.apply(u,f)}return u}function te(s){return function(u){if(Array.isArray(u))return se(u)}(s)||function(u){if(typeof Symbol<"u"&&Symbol.iterator in Object(u))return Array.from(u)}(s)||function(u,f){if(u){if(typeof u=="string")return se(u,f);var w=Object.prototype.toString.call(u).slice(8,-1);if(w==="Object"&&u.constructor&&(w=u.constructor.name),w==="Map"||w==="Set")return Array.from(u);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return se(u,f)}}(s)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function se(s,o){(o==null||o>s.length)&&(o=s.length);for(var u=0,f=new Array(o);u<o;u++)f[u]=s[u];return f}function k(s){return(k=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(s)}function W(s,o){if(!(s instanceof o))throw new TypeError("Cannot call a class as a function")}function he(s,o){for(var u=0;u<o.length;u++){var f=o[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(s,f.key,f)}}function Ge(s,o,u){return o in s?Object.defineProperty(s,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):s[o]=u,s}function Xe(s,o){var u=Object.keys(s);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(s);o&&(f=f.filter(function(w){return Object.getOwnPropertyDescriptor(s,w).enumerable})),u.push.apply(u,f)}return u}function Oe(s){for(var o=1;o<arguments.length;o++){var u=arguments[o]!=null?arguments[o]:{};o%2?Xe(Object(u),!0).forEach(function(f){Ge(s,f,u[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(u)):Xe(Object(u)).forEach(function(f){Object.defineProperty(s,f,Object.getOwnPropertyDescriptor(u,f))})}return s}function ge(s,o){return function(f){if(Array.isArray(f))return f}(s)||function(f,w){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(f)))){var G=[],Q=!0,B=!1,ne=void 0;try{for(var ce,we=f[Symbol.iterator]();!(Q=(ce=we.next()).done)&&(G.push(ce.value),!w||G.length!==w);Q=!0);}catch(xe){B=!0,ne=xe}finally{try{Q||we.return==null||we.return()}finally{if(B)throw ne}}return G}}(s,o)||vn(s,o)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ce(s){return function(u){if(Array.isArray(u))return Ze(u)}(s)||function(u){if(typeof Symbol<"u"&&Symbol.iterator in Object(u))return Array.from(u)}(s)||vn(s)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function vn(s,o){if(s){if(typeof s=="string")return Ze(s,o);var u=Object.prototype.toString.call(s).slice(8,-1);return u==="Object"&&s.constructor&&(u=s.constructor.name),u==="Map"||u==="Set"?Array.from(s):u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u)?Ze(s,o):void 0}}function Ze(s,o){(o==null||o>s.length)&&(o=s.length);for(var u=0,f=new Array(o);u<o;u++)f[u]=s[u];return f}var re=function s(o){W(this,s),this.p=new Promise(o)};re.__typeson__type__="TypesonPromise",typeof Symbol<"u"&&(re.prototype[Symbol.toStringTag]="TypesonPromise"),re.prototype.then=function(s,o){var u=this;return new re(function(f,w){u.p.then(function(G){f(s?s(G):G)}).catch(function(G){return o?o(G):Promise.reject(G)}).then(f,w)})},re.prototype.catch=function(s){return this.then(null,s)},re.resolve=function(s){return new re(function(o){o(s)})},re.reject=function(s){return new re(function(o,u){u(s)})},["all","race"].forEach(function(s){re[s]=function(o){return new re(function(u,f){Promise[s](o.map(function(w){return w&&w.constructor&&w.constructor.__typeson__type__==="TypesonPromise"?w.p:w})).then(u,f)})}});var rn={}.toString,oe={}.hasOwnProperty,Le=Object.getPrototypeOf,Ye=oe.toString;function bn(s,o){return R(s)&&typeof s.then=="function"&&(!o||typeof s.catch=="function")}function I(s){return rn.call(s).slice(8,-1)}function l(s,o){if(!s||k(s)!=="object")return!1;var u=Le(s);if(!u)return o===null;var f=oe.call(u,"constructor")&&u.constructor;return typeof f!="function"?o===null:o===f||o!==null&&Ye.call(f)===Ye.call(o)||typeof o=="function"&&typeof f.__typeson__type__=="string"&&f.__typeson__type__===o.__typeson__type__}function V(s){return!(!s||I(s)!=="Object")&&(!Le(s)||l(s,Object))}function R(s){return s&&k(s)==="object"}function Ne(s){return s.replace(/~/g,"~0").replace(/\./g,"~1")}function ve(s){return s.replace(/~1/g,".").replace(/~0/g,"~")}function Je(s,o){if(o==="")return s;var u=o.indexOf(".");if(u>-1){var f=s[ve(o.slice(0,u))];return f===void 0?void 0:Je(f,o.slice(u+1))}return s[ve(o)]}function qe(s,o,u){if(o==="")return u;var f=o.indexOf(".");return f>-1?qe(s[ve(o.slice(0,f))],o.slice(f+1),u):(s[ve(o)]=u,s)}function en(s,o,u){return u?o?o(s):s:(s&&s.then||(s=Promise.resolve(s)),o?s.then(o):s)}var un=Object.keys,dn=Array.isArray,He={}.hasOwnProperty,ze=["type","replaced","iterateIn","iterateUnsetNumeric"];function wn(s){return function(){for(var o=[],u=0;u<arguments.length;u++)o[u]=arguments[u];try{return Promise.resolve(s.apply(this,o))}catch(f){return Promise.reject(f)}}}function En(s,o){if(s.keypath==="")return-1;var u=s.keypath.match(/\./g)||0,f=o.keypath.match(/\./g)||0;return u&&(u=u.length),f&&(f=f.length),u>f?-1:u<f?1:s.keypath<o.keypath?-1:s.keypath>o.keypath}var pe=function(){function s(o){W(this,s),this.options=o,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return function(u,f,w){return f&&he(u.prototype,f),w&&he(u,w),u}(s,[{key:"stringify",value:function(u,f,w,G){G=Oe(Oe(Oe({},this.options),G),{},{stringification:!0});var Q=this.encapsulate(u,null,G);return dn(Q)?JSON.stringify(Q[0],f,w):Q.then(function(B){return JSON.stringify(B,f,w)})}},{key:"stringifySync",value:function(u,f,w,G){return this.stringify(u,f,w,Oe(Oe({throwOnBadSyncType:!0},G),{},{sync:!0}))}},{key:"stringifyAsync",value:function(u,f,w,G){return this.stringify(u,f,w,Oe(Oe({throwOnBadSyncType:!0},G),{},{sync:!1}))}},{key:"parse",value:function(u,f,w){return w=Oe(Oe(Oe({},this.options),w),{},{parse:!0}),this.revive(JSON.parse(u,f),w)}},{key:"parseSync",value:function(u,f,w){return this.parse(u,f,Oe(Oe({throwOnBadSyncType:!0},w),{},{sync:!0}))}},{key:"parseAsync",value:function(u,f,w){return this.parse(u,f,Oe(Oe({throwOnBadSyncType:!0},w),{},{sync:!1}))}},{key:"specialTypeNames",value:function(u,f){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return w.returnTypeNames=!0,this.encapsulate(u,f,w)}},{key:"rootTypeName",value:function(u,f){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return w.iterateNone=!0,this.encapsulate(u,f,w)}},{key:"encapsulate",value:function(u,f,w){var G=wn(function(z,M){return en(Promise.all(M.map(function(le){return le[1].p})),function(le){return en(Promise.all(le.map(wn(function(ae){var fe=!1,_e=[],Bn=ge(M.splice(0,1),1),We=ge(Bn[0],7),fn=We[0],pn=We[2],Ue=We[3],Ln=We[4],Be=We[5],Pn=We[6],sn=de(fn,ae,pn,Ue,_e,!0,Pn),qn=l(sn,re);return function(on,$n){var Cn=on();return Cn&&Cn.then?Cn.then($n):$n(Cn)}(function(){if(fn&&qn)return en(sn.p,function(Kn){return Ln[Be]=Kn,fe=!0,G(z,_e)})},function(Kn){return fe?Kn:(fn?Ln[Be]=sn:z=qn?sn.p:sn,G(z,_e))})}))),function(){return z})})}),Q=(w=Oe(Oe({sync:!0},this.options),w)).sync,B=this,ne={},ce=[],we=[],xe=[],Ke=!("cyclic"in w)||w.cyclic,Ie=w.encapsulateObserver,je=de("",u,Ke,f||{},xe);function Re(z){var M=Object.values(ne);if(w.iterateNone)return M.length?M[0]:s.getJSONType(z);if(M.length){if(w.returnTypeNames)return Ce(new Set(M));z&&V(z)&&!He.call(z,"$types")?z.$types=ne:z={$:z,$types:{$:ne}}}else R(z)&&He.call(z,"$types")&&(z={$:z,$types:!0});return!w.returnTypeNames&&z}function De(z,M,le){Object.assign(z,M);var ae=ze.map(function(fe){var _e=z[fe];return delete z[fe],_e});le(),ze.forEach(function(fe,_e){z[fe]=ae[_e]})}function de(z,M,le,ae,fe,_e,Bn){var We,fn={},pn=k(M),Ue=Ie?function(Rn){var yn=Bn||ae.type||s.getJSONType(M);Ie(Object.assign(Rn||fn,{keypath:z,value:M,cyclic:le,stateObj:ae,promisesData:fe,resolvingTypesonPromise:_e,awaitingTypesonPromise:l(M,re)},{type:yn}))}:null;if(["string","boolean","number","undefined"].includes(pn))return M===void 0||Number.isNaN(M)||M===Number.NEGATIVE_INFINITY||M===Number.POSITIVE_INFINITY?(We=ae.replaced?M:ln(z,M,ae,fe,!1,_e,Ue))!==M&&(fn={replaced:We}):We=M,Ue&&Ue(),We;if(M===null)return Ue&&Ue(),M;if(le&&!ae.iterateIn&&!ae.iterateUnsetNumeric&&M&&k(M)==="object"){var Ln=ce.indexOf(M);if(!(Ln<0))return ne[z]="#",Ue&&Ue({cyclicKeypath:we[Ln]}),"#"+we[Ln];le===!0&&(ce.push(M),we.push(z))}var Be,Pn=V(M),sn=dn(M),qn=(Pn||sn)&&(!B.plainObjectReplacers.length||ae.replaced)||ae.iterateIn?M:ln(z,M,ae,fe,Pn||sn,null,Ue);if(qn!==M?(We=qn,fn={replaced:qn}):z===""&&l(M,re)?(fe.push([z,M,le,ae,void 0,void 0,ae.type]),We=M):sn&&ae.iterateIn!=="object"||ae.iterateIn==="array"?(Be=new Array(M.length),fn={clone:Be}):(["function","symbol"].includes(k(M))||"toJSON"in M||l(M,re)||l(M,Promise)||l(M,ArrayBuffer))&&!Pn&&ae.iterateIn!=="object"?We=M:(Be={},ae.addLength&&(Be.length=M.length),fn={clone:Be}),Ue&&Ue(),w.iterateNone)return Be||We;if(!Be)return We;if(ae.iterateIn){var Kn=function(yn){var Mn={ownKeys:He.call(M,yn)};De(ae,Mn,function(){var Wn=z+(z?".":"")+Ne(yn),Yn=de(Wn,M[yn],!!le,ae,fe,_e);l(Yn,re)?fe.push([Wn,Yn,!!le,ae,Be,yn,ae.type]):Yn!==void 0&&(Be[yn]=Yn)})};for(var on in M)Kn(on);Ue&&Ue({endIterateIn:!0,end:!0})}else un(M).forEach(function(Rn){var yn=z+(z?".":"")+Ne(Rn);De(ae,{ownKeys:!0},function(){var Mn=de(yn,M[Rn],!!le,ae,fe,_e);l(Mn,re)?fe.push([yn,Mn,!!le,ae,Be,Rn,ae.type]):Mn!==void 0&&(Be[Rn]=Mn)})}),Ue&&Ue({endIterateOwn:!0,end:!0});if(ae.iterateUnsetNumeric){for(var $n=M.length,Cn=function(yn){if(!(yn in M)){var Mn=z+(z?".":"")+yn;De(ae,{ownKeys:!1},function(){var Wn=de(Mn,void 0,!!le,ae,fe,_e);l(Wn,re)?fe.push([Mn,Wn,!!le,ae,Be,yn,ae.type]):Wn!==void 0&&(Be[yn]=Wn)})}},lt=0;lt<$n;lt++)Cn(lt);Ue&&Ue({endIterateUnsetNumeric:!0,end:!0})}return Be}function ln(z,M,le,ae,fe,_e,Bn){for(var We=fe?B.plainObjectReplacers:B.nonplainObjectReplacers,fn=We.length;fn--;){var pn=We[fn];if(pn.test(M,le)){var Ue=pn.type;if(B.revivers[Ue]){var Ln=ne[z];ne[z]=Ln?[Ue].concat(Ln):Ue}return Object.assign(le,{type:Ue,replaced:!0}),!Q&&pn.replaceAsync||pn.replace?(Bn&&Bn({replacing:!0}),de(z,pn[Q||!pn.replaceAsync?"replace":"replaceAsync"](M,le),Ke&&"readonly",le,ae,_e,Ue)):(Bn&&Bn({typeDetected:!0}),de(z,M,Ke&&"readonly",le,ae,_e,Ue))}}return M}return xe.length?Q&&w.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(G(je,xe)).then(Re):!Q&&w.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():w.stringification&&Q?[Re(je)]:Q?Re(je):Promise.resolve(Re(je))}},{key:"encapsulateSync",value:function(u,f,w){return this.encapsulate(u,f,Oe(Oe({throwOnBadSyncType:!0},w),{},{sync:!0}))}},{key:"encapsulateAsync",value:function(u,f,w){return this.encapsulate(u,f,Oe(Oe({throwOnBadSyncType:!0},w),{},{sync:!1}))}},{key:"revive",value:function(u,f){var w=u&&u.$types;if(!w)return u;if(w===!0)return u.$;var G=(f=Oe(Oe({sync:!0},this.options),f)).sync,Q=[],B={},ne=!0;w.$&&V(w.$)&&(u=u.$,w=w.$,ne=!1);var ce=this;function we(Re,De){var de=ge(ce.revivers[Re]||[],1)[0];if(!de)throw new Error("Unregistered type: "+Re);return G&&!("revive"in de)?De:de[G&&de.revive?"revive":!G&&de.reviveAsync?"reviveAsync":"revive"](De,B)}var xe=[];function Ke(Re){return l(Re,Qe)?void 0:Re}var Ie,je=function(){var De=[];if(Object.entries(w).forEach(function(de){var ln=ge(de,2),z=ln[0],M=ln[1];M!=="#"&&[].concat(M).forEach(function(le){ge(ce.revivers[le]||[null,{}],2)[1].plain&&(De.push({keypath:z,type:le}),delete w[z])})}),De.length)return De.sort(En).reduce(function de(ln,z){var M=z.keypath,le=z.type;if(bn(ln))return ln.then(function(_e){return de(_e,{keypath:M,type:le})});var ae=Je(u,M);if(l(ae=we(le,ae),re))return ae.then(function(_e){var Bn=qe(u,M,_e);Bn===_e&&(u=Bn)});var fe=qe(u,M,ae);fe===ae&&(u=fe)},void 0)}();return l(je,re)?Ie=je.then(function(){return u}):(Ie=function Re(De,de,ln,z,M){if(!ne||De!=="$types"){var le=w[De],ae=dn(de);if(ae||V(de)){var fe=ae?new Array(de.length):{};for(un(de).forEach(function(Be){var Pn=Re(De+(De?".":"")+Ne(Be),de[Be],ln||fe,fe,Be),sn=function(Kn){return l(Kn,Qe)?fe[Be]=void 0:Kn!==void 0&&(fe[Be]=Kn),Kn};l(Pn,re)?xe.push(Pn.then(function(qn){return sn(qn)})):sn(Pn)}),de=fe;Q.length;){var _e=ge(Q[0],4),Bn=_e[0],We=_e[1],fn=_e[2],pn=_e[3],Ue=Je(Bn,We);if(Ue===void 0)break;fn[pn]=Ue,Q.splice(0,1)}}if(!le)return de;if(le==="#"){var Ln=Je(ln,de.slice(1));return Ln===void 0&&Q.push([ln,de.slice(1),z,M]),Ln}return[].concat(le).reduce(function Be(Pn,sn){return l(Pn,re)?Pn.then(function(qn){return Be(qn,sn)}):we(sn,Pn)},de)}}("",u,null),xe.length&&(Ie=re.resolve(Ie).then(function(Re){return re.all([Re].concat(xe))}).then(function(Re){return ge(Re,1)[0]}))),bn(Ie)?G&&f.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():l(Ie,re)?Ie.p.then(Ke):Ie:!G&&f.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():G?Ke(Ie):Promise.resolve(Ke(Ie))}},{key:"reviveSync",value:function(u,f){return this.revive(u,Oe(Oe({throwOnBadSyncType:!0},f),{},{sync:!0}))}},{key:"reviveAsync",value:function(u,f){return this.revive(u,Oe(Oe({throwOnBadSyncType:!0},f),{},{sync:!1}))}},{key:"register",value:function(u,f){return f=f||{},[].concat(u).forEach(function w(G){var Q=this;if(dn(G))return G.map(function(B){return w.call(Q,B)});G&&un(G).forEach(function(B){if(B==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(s.JSON_TYPES.includes(B))throw new TypeError("Plain JSON object types are reserved as type names");var ne=G[B],ce=ne&&ne.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,we=ce.filter(function(De){return De.type===B});if(we.length&&(ce.splice(ce.indexOf(we[0]),1),delete this.revivers[B],delete this.types[B]),typeof ne=="function"){var xe=ne;ne={test:function(de){return de&&de.constructor===xe},replace:function(de){return Oe({},de)},revive:function(de){return Object.assign(Object.create(xe.prototype),de)}}}else if(dn(ne)){var Ke=ge(ne,3);ne={test:Ke[0],replace:Ke[1],revive:Ke[2]}}if(ne&&ne.test){var Ie={type:B,test:ne.test.bind(ne)};ne.replace&&(Ie.replace=ne.replace.bind(ne)),ne.replaceAsync&&(Ie.replaceAsync=ne.replaceAsync.bind(ne));var je=typeof f.fallback=="number"?f.fallback:f.fallback?0:Number.POSITIVE_INFINITY;if(ne.testPlainObjects?this.plainObjectReplacers.splice(je,0,Ie):this.nonplainObjectReplacers.splice(je,0,Ie),ne.revive||ne.reviveAsync){var Re={};ne.revive&&(Re.revive=ne.revive.bind(ne)),ne.reviveAsync&&(Re.reviveAsync=ne.reviveAsync.bind(ne)),this.revivers[B]=[Re,{plain:ne.testPlainObjects}]}this.types[B]=ne}},this)},this),this}}]),s}(),Qe=function s(){W(this,s)};Qe.__typeson__type__="TypesonUndefined",pe.Undefined=Qe,pe.Promise=re,pe.isThenable=bn,pe.toStringTag=I,pe.hasConstructorOf=l,pe.isObject=R,pe.isPlainObject=V,pe.isUserObject=function s(o){if(!o||I(o)!=="Object")return!1;var u=Le(o);return!u||l(o,Object)||s(u)},pe.escapeKeyPathComponent=Ne,pe.unescapeKeyPathComponent=ve,pe.getByKeyPath=Je,pe.getJSONType=function(o){return o===null?"null":Array.isArray(o)?"array":k(o)},pe.JSON_TYPES=["null","boolean","number","string","array","object"];for(var An={userObject:{test:function(o,u){return pe.isUserObject(o)},replace:function(o){return function(f){for(var w=1;w<arguments.length;w++){var G=arguments[w]!=null?arguments[w]:{};w%2?g(Object(G),!0).forEach(function(Q){A(f,Q,G[Q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(G)):g(Object(G)).forEach(function(Q){Object.defineProperty(f,Q,Object.getOwnPropertyDescriptor(G,Q))})}return f}({},o)},revive:function(o){return o}}},_=[{arrayNonindexKeys:{testPlainObjects:!0,test:function(o,u){return!!Array.isArray(o)&&(Object.keys(o).some(function(f){return String(Number.parseInt(f))!==f})&&(u.iterateIn="object",u.addLength=!0),!0)},replace:function(o,u){return u.iterateUnsetNumeric=!0,o},revive:function(o){if(Array.isArray(o))return o;var u=[];return Object.keys(o).forEach(function(f){var w=o[f];u[f]=w}),u}}},{sparseUndefined:{test:function(o,u){return o===void 0&&u.ownKeys===!1},replace:function(o){return 0},revive:function(o){}}}],F={undef:{test:function(o,u){return o===void 0&&(u.ownKeys||!("ownKeys"in u))},replace:function(o){return 0},revive:function(o){return new pe.Undefined}}},q={StringObject:{test:function(o){return pe.toStringTag(o)==="String"&&T(o)==="object"},replace:function(o){return String(o)},revive:function(o){return new String(o)}},BooleanObject:{test:function(o){return pe.toStringTag(o)==="Boolean"&&T(o)==="object"},replace:function(o){return!!o},revive:function(o){return new Boolean(o)}},NumberObject:{test:function(o){return pe.toStringTag(o)==="Number"&&T(o)==="object"},replace:function(o){return Number(o)},revive:function(o){return new Number(o)}}},j=[{nan:{test:function(o){return Number.isNaN(o)},replace:function(o){return"NaN"},revive:function(o){return Number.NaN}}},{infinity:{test:function(o){return o===Number.POSITIVE_INFINITY},replace:function(o){return"Infinity"},revive:function(o){return Number.POSITIVE_INFINITY}}},{negativeInfinity:{test:function(o){return o===Number.NEGATIVE_INFINITY},replace:function(o){return"-Infinity"},revive:function(o){return Number.NEGATIVE_INFINITY}}}],H={date:{test:function(o){return pe.toStringTag(o)==="Date"},replace:function(o){var u=o.getTime();return Number.isNaN(u)?"NaN":u},revive:function(o){return o==="NaN"?new Date(Number.NaN):new Date(o)}}},Se={regexp:{test:function(o){return pe.toStringTag(o)==="RegExp"},replace:function(o){return{source:o.source,flags:(o.global?"g":"")+(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.sticky?"y":"")+(o.unicode?"u":"")}},revive:function(o){var u=o.source,f=o.flags;return new RegExp(u,f)}}},me={map:{test:function(o){return pe.toStringTag(o)==="Map"},replace:function(o){return te(o.entries())},revive:function(o){return new Map(o)}}},Te={set:{test:function(o){return pe.toStringTag(o)==="Set"},replace:function(o){return te(o.values())},revive:function(o){return new Set(o)}}},ue="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",mn=new Uint8Array(256),kn=0;kn<ue.length;kn++)mn[ue.charCodeAt(kn)]=kn;var _n=function(o,u,f){f==null&&(f=o.byteLength);for(var w=new Uint8Array(o,u||0,f),G=w.length,Q="",B=0;B<G;B+=3)Q+=ue[w[B]>>2],Q+=ue[(3&w[B])<<4|w[B+1]>>4],Q+=ue[(15&w[B+1])<<2|w[B+2]>>6],Q+=ue[63&w[B+2]];return G%3==2?Q=Q.slice(0,-1)+"=":G%3==1&&(Q=Q.slice(0,-2)+"=="),Q},cn=function(o){var u,f,w,G,Q=o.length,B=.75*o.length,ne=0;o[o.length-1]==="="&&(B--,o[o.length-2]==="="&&B--);for(var ce=new ArrayBuffer(B),we=new Uint8Array(ce),xe=0;xe<Q;xe+=4)u=mn[o.charCodeAt(xe)],f=mn[o.charCodeAt(xe+1)],w=mn[o.charCodeAt(xe+2)],G=mn[o.charCodeAt(xe+3)],we[ne++]=u<<2|f>>4,we[ne++]=(15&f)<<4|w>>2,we[ne++]=(3&w)<<6|63&G;return ce},Fn={arraybuffer:{test:function(o){return pe.toStringTag(o)==="ArrayBuffer"},replace:function(o,u){u.buffers||(u.buffers=[]);var f=u.buffers.indexOf(o);return f>-1?{index:f}:(u.buffers.push(o),_n(o))},revive:function(o,u){if(u.buffers||(u.buffers=[]),T(o)==="object")return u.buffers[o.index];var f=cn(o);return u.buffers.push(f),f}}},In=typeof self>"u"?Pr:self,Tn={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(s){var o=s,u=In[o];u&&(Tn[s.toLowerCase()]={test:function(w){return pe.toStringTag(w)===o},replace:function(w,G){var Q=w.buffer,B=w.byteOffset,ne=w.length;G.buffers||(G.buffers=[]);var ce=G.buffers.indexOf(Q);return ce>-1?{index:ce,byteOffset:B,length:ne}:(G.buffers.push(Q),{encoded:_n(Q),byteOffset:B,length:ne})},revive:function(w,G){G.buffers||(G.buffers=[]);var Q,B=w.byteOffset,ne=w.length,ce=w.encoded,we=w.index;return"index"in w?Q=G.buffers[we]:(Q=cn(ce),G.buffers.push(Q)),new u(Q,B,ne)}})});var On={dataview:{test:function(o){return pe.toStringTag(o)==="DataView"},replace:function(o,u){var f=o.buffer,w=o.byteOffset,G=o.byteLength;u.buffers||(u.buffers=[]);var Q=u.buffers.indexOf(f);return Q>-1?{index:Q,byteOffset:w,byteLength:G}:(u.buffers.push(f),{encoded:_n(f),byteOffset:w,byteLength:G})},revive:function(o,u){u.buffers||(u.buffers=[]);var f,w=o.byteOffset,G=o.byteLength,Q=o.encoded,B=o.index;return"index"in o?f=u.buffers[B]:(f=cn(Q),u.buffers.push(f)),new DataView(f,w,G)}}},nn={IntlCollator:{test:function(o){return pe.hasConstructorOf(o,Intl.Collator)},replace:function(o){return o.resolvedOptions()},revive:function(o){return new Intl.Collator(o.locale,o)}},IntlDateTimeFormat:{test:function(o){return pe.hasConstructorOf(o,Intl.DateTimeFormat)},replace:function(o){return o.resolvedOptions()},revive:function(o){return new Intl.DateTimeFormat(o.locale,o)}},IntlNumberFormat:{test:function(o){return pe.hasConstructorOf(o,Intl.NumberFormat)},replace:function(o){return o.resolvedOptions()},revive:function(o){return new Intl.NumberFormat(o.locale,o)}}};function Me(s){for(var o=new Uint8Array(s.length),u=0;u<s.length;u++)o[u]=s.charCodeAt(u);return o.buffer}var Pe={file:{test:function(o){return pe.toStringTag(o)==="File"},replace:function(o){var u=new XMLHttpRequest;if(u.overrideMimeType("text/plain; charset=x-user-defined"),u.open("GET",URL.createObjectURL(o),!1),u.send(),u.status!==200&&u.status!==0)throw new Error("Bad File access: "+u.status);return{type:o.type,stringContents:u.responseText,name:o.name,lastModified:o.lastModified}},revive:function(o){var u=o.name,f=o.type,w=o.stringContents,G=o.lastModified;return new File([Me(w)],u,{type:f,lastModified:G})},replaceAsync:function(o){return new pe.Promise(function(u,f){var w=new FileReader;w.addEventListener("load",function(){u({type:o.type,stringContents:w.result,name:o.name,lastModified:o.lastModified})}),w.addEventListener("error",function(){f(w.error)}),w.readAsBinaryString(o)})}}},Ve={bigint:{test:function(o){return typeof o=="bigint"},replace:function(o){return String(o)},revive:function(o){return BigInt(o)}}},tn={bigintObject:{test:function(o){return T(o)==="object"&&pe.hasConstructorOf(o,BigInt)},replace:function(o){return String(o)},revive:function(o){return new Object(BigInt(o))}}},ie={cryptokey:{test:function(o){return pe.toStringTag(o)==="CryptoKey"&&o.extractable},replaceAsync:function(o){return new pe.Promise(function(u,f){crypto.subtle.exportKey("jwk",o).catch(function(w){f(w)}).then(function(w){u({jwk:w,algorithm:o.algorithm,usages:o.usages})})})},revive:function(o){var u=o.jwk,f=o.algorithm,w=o.usages;return crypto.subtle.importKey("jwk",u,f,!0,w)}}};return[An,F,_,q,j,H,Se,{imagedata:{test:function(o){return pe.toStringTag(o)==="ImageData"},replace:function(o){return{array:te(o.data),width:o.width,height:o.height}},revive:function(o){return new ImageData(new Uint8ClampedArray(o.array),o.width,o.height)}}},{imagebitmap:{test:function(o){return pe.toStringTag(o)==="ImageBitmap"||o&&o.dataset&&o.dataset.toStringTag==="ImageBitmap"},replace:function(o){var u=document.createElement("canvas");return u.getContext("2d").drawImage(o,0,0),u.toDataURL()},revive:function(o){var u=document.createElement("canvas"),f=u.getContext("2d"),w=document.createElement("img");return w.addEventListener("load",function(){f.drawImage(w,0,0)}),w.src=o,u},reviveAsync:function(o){var u=document.createElement("canvas"),f=u.getContext("2d"),w=document.createElement("img");return w.addEventListener("load",function(){f.drawImage(w,0,0)}),w.src=o,createImageBitmap(u)}}},Pe,{file:Pe.file,filelist:{test:function(o){return pe.toStringTag(o)==="FileList"},replace:function(o){for(var u=[],f=0;f<o.length;f++)u[f]=o.item(f);return u},revive:function(o){return new(function(){function u(){D(this,u),this._files=arguments[0],this.length=this._files.length}return function(w,G,Q){return G&&L(w.prototype,G),Q&&L(w,Q),w}(u,[{key:"item",value:function(w){return this._files[w]}},{key:Symbol.toStringTag,get:function(){return"FileList"}}]),u}())(o)}}},{blob:{test:function(o){return pe.toStringTag(o)==="Blob"},replace:function(o){var u=new XMLHttpRequest;if(u.overrideMimeType("text/plain; charset=x-user-defined"),u.open("GET",URL.createObjectURL(o),!1),u.send(),u.status!==200&&u.status!==0)throw new Error("Bad Blob access: "+u.status);return{type:o.type,stringContents:u.responseText}},revive:function(o){var u=o.type,f=o.stringContents;return new Blob([Me(f)],{type:u})},replaceAsync:function(o){return new pe.Promise(function(u,f){var w=new FileReader;w.addEventListener("load",function(){u({type:o.type,stringContents:w.result})}),w.addEventListener("error",function(){f(w.error)}),w.readAsBinaryString(o)})}}}].concat(typeof Map=="function"?me:[],typeof Set=="function"?Te:[],typeof ArrayBuffer=="function"?Fn:[],typeof Uint8Array=="function"?Tn:[],typeof DataView=="function"?On:[],typeof Intl<"u"?nn:[],typeof crypto<"u"?ie:[],typeof BigInt<"u"?[Ve,tn]:[])})}),dt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Et=new Uint8Array(256);for(xt=0;xt<dt.length;xt++)Et[dt.codePointAt(xt)]=xt;var xt,Cr=function(E,T,D){D==null&&(D=E.byteLength);for(var L=new Uint8Array(E,T||0,D),A=L.length,g="",te=0;te<A;te+=3)g+=dt[L[te]>>2],g+=dt[(L[te]&3)<<4|L[te+1]>>4],g+=dt[(L[te+1]&15)<<2|L[te+2]>>6],g+=dt[L[te+2]&63];return A%3===2?g=g.slice(0,-1)+"=":A%3===1&&(g=g.slice(0,-2)+"=="),g},hi=function(E){var T=E.length,D=E.length*.75,L=0,A,g,te,se;E[E.length-1]==="="&&(D--,E[E.length-2]==="="&&D--);for(var k=new ArrayBuffer(D),W=new Uint8Array(k),he=0;he<T;he+=4)A=Et[E.codePointAt(he)],g=Et[E.codePointAt(he+1)],te=Et[E.codePointAt(he+2)],se=Et[E.codePointAt(he+3)],W[L++]=A<<2|g>>4,W[L++]=(g&15)<<4|te>>2,W[L++]=(te&3)<<6|se&63;return k},Yi=typeof self>"u"?global:self,di={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(K){var E=K,T=Yi[E];T&&(di[K.toLowerCase()+"2"]={test:function(D){return Ht.toStringTag(D)===E},replace:function(D){var L=D.buffer,A=D.byteOffset,g=D.length;return{buffer:L,byteOffset:A,length:g}},revive:function(D){var L=D.buffer,A=D.byteOffset,g=D.length;return new T(L,A,g)}})});var Ji={arraybuffer:{test:function(K){return Ht.toStringTag(K)==="ArrayBuffer"},replace:function(K){return Cr(K,0,K.byteLength)},revive:function(K){var E=hi(K);return E}}},Gn=new Ht().register($i),Gi="FileReaderSync"in self,Wt=[],Tr=0;Gn.register([Ji,di,{blob2:{test:function(K){return Ht.toStringTag(K)==="Blob"},replace:function(K){if(K.isClosed)throw new Error("The Blob is closed");if(Gi){var E=pi(K,"binary"),T=Cr(E,0,E.byteLength);return{type:K.type,data:T}}else{Wt.push(K);var D={type:K.type,data:{start:Tr,end:Tr+K.size}};return Tr+=K.size,D}},finalize:function(K,E){K.data=Cr(E,0,E.byteLength)},revive:function(K){var E=K.type,T=K.data;return new Blob([hi(T)],{type:E})}}}]);Gn.mustFinalize=function(){return Wt.length>0};Gn.finalize=function(K){return at(void 0,void 0,void 0,function(){var E,T,D,L,A,g,te,se,k,W;return Qn(this,function(he){switch(he.label){case 0:return[4,fi(new Blob(Wt),"binary")];case 1:if(E=he.sent(),K){for(T=0,D=K;T<D.length;T++)if(L=D[T],L.$types){A=L.$types,g=A.$,g&&(A=A.$);for(te in A)se=A[te],k=Gn.types[se],k&&k.finalize&&(W=xn.getByKeyPath(L,g?"$."+te:te),k.finalize(W,E.slice(W.start,W.end)))}}return Wt=[],[2]}})})};var zi=2e3;function jr(K,E){return at(this,void 0,void 0,function(){function T(){return at(this,void 0,void 0,function(){var he,Ge,Xe,Oe,ge,Ce,vn,Ze,re,rn;return Qn(this,function(oe){switch(oe.label){case 0:return[4,Promise.all(L.map(function(Le){return Le.count()}))];case 1:he=oe.sent(),he.forEach(function(Le,Ye){return g[Ye].rowCount=Le}),W.totalRows=he.reduce(function(Le,Ye){return Le+Ye}),Ge=JSON.stringify(se,void 0,te?2:void 0),Xe=Ge.lastIndexOf("]"),Oe=Ge.substring(0,Xe),A.push(Oe),ge=E.filter,Ce=E.transform,vn=function(Le){var Ye,bn,I,l,V,R,Ne,ve,Je,qe,en,un;return Qn(this,function(dn){switch(dn.label){case 0:Ye=K.table(Le),bn=Ye.schema.primKey,I=!!bn.keyPath,l=E.numRowsPerChunk||zi,V=I?{tableName:Ye.name,inbound:!0,rows:[]}:{tableName:Ye.name,inbound:!1,rows:[]},R=JSON.stringify(V,void 0,te?2:void 0),te&&(R=R.split(`
`).join(`
    `)),Ne=R.lastIndexOf("]"),A.push(R.substring(0,Ne)),ve=null,Je=0,qe=!0,en=function(){var He,ze,wn,En,pe,F,Qe,An,_,F;return Qn(this,function(q){switch(q.label){case 0:return k&&xn.ignoreTransaction(function(){return k(W)}),He=ve==null?Ye.limit(l):Ye.where(":id").above(ve).limit(l),[4,He.toArray()];case 1:return ze=q.sent(),ze.length===0?[2,"break"]:(ve!=null&&Je>0&&(A.push(","),te&&A.push(`
      `)),qe=ze.length===l,I?(wn=ge?ze.filter(function(j){return ge(Le,j)}):ze,En=Ce?wn.map(function(j){return Ce(Le,j).value}):wn,pe=En.map(function(j){return Gn.encapsulate(j)}),Gn.mustFinalize()?[4,xn.waitFor(Gn.finalize(pe))]:[3,3]):[3,4]);case 2:q.sent(),q.label=3;case 3:return F=JSON.stringify(pe,void 0,te?2:void 0),te&&(F=F.split(`
`).join(`
      `)),A.push(new Blob([F.substring(1,F.length-1)])),Je=En.length,ve=ze.length>0?xn.getByKeyPath(ze[ze.length-1],bn.keyPath):null,[3,8];case 4:return[4,He.primaryKeys()];case 5:return Qe=q.sent(),An=Qe.map(function(j,H){return[j,ze[H]]}),ge&&(An=An.filter(function(j){var H=j[0],Se=j[1];return ge(Le,Se,H)})),Ce&&(An=An.map(function(j){var H=j[0],Se=j[1],me=Ce(Le,Se,H);return[me.key,me.value]})),_=An.map(function(j){return Gn.encapsulate(j)}),Gn.mustFinalize()?[4,xn.waitFor(Gn.finalize(_))]:[3,7];case 6:q.sent(),q.label=7;case 7:F=JSON.stringify(_,void 0,te?2:void 0),te&&(F=F.split(`
`).join(`
      `)),A.push(new Blob([F.substring(1,F.length-1)])),Je=An.length,ve=Qe.length>0?Qe[Qe.length-1]:null,q.label=8;case 8:return W.completedRows+=ze.length,[2]}})},dn.label=1;case 1:return qe?[5,en()]:[3,3];case 2:return un=dn.sent(),un==="break"?[3,3]:[3,1];case 3:return A.push(R.substr(Ne)),W.completedTables+=1,W.completedTables<W.totalTables&&A.push(","),[2]}})},Ze=0,re=g,oe.label=2;case 2:return Ze<re.length?(rn=re[Ze].name,[5,vn(rn)]):[3,5];case 3:oe.sent(),oe.label=4;case 4:return Ze++,[3,2];case 5:return A.push(Ge.substr(Xe)),W.done=!0,k&&xn.ignoreTransaction(function(){return k(W)}),[2]}})})}var D,L,A,g,te,se,k,W;return Qn(this,function(he){switch(he.label){case 0:E=E||{},D=E.skipTables?E.skipTables:[],L=K.tables.filter(function(Ge){return!D.includes(Ge.name)}),A=[],g=L.map(function(Ge){return{name:Ge.name,schema:Mi(Ge),rowCount:0}}),te=E.prettyJson,se={formatName:"dexie",formatVersion:1,data:{databaseName:K.name,databaseVersion:K.verno,tables:g,data:[]}},k=E.progressCallback,W={done:!1,completedRows:0,completedTables:0,totalRows:NaN,totalTables:g.length},he.label=1;case 1:return he.trys.push([1,,6,7]),E.noTransaction?[4,T()]:[3,3];case 2:return he.sent(),[3,5];case 3:return[4,K.transaction("r",K.tables,T)];case 4:he.sent(),he.label=5;case 5:return[3,7];case 6:return Gn.finalize(),[7];case 7:return[2,new Blob(A,{type:"text/json"})]}})})}var Wi=1,Hi={Stream:function(){}},Qi=Nr(function(K,E){(function(T){var D=typeof process=="object"&&process.env?process.env:self;T.parser=function(I){return new Xe(I)},T.CParser=Xe,T.CStream=ge,T.createStream=Oe,T.MAX_BUFFER_LENGTH=10*1024*1024,T.DEBUG=D.CDEBUG==="debug",T.INFO=D.CDEBUG==="debug"||D.CDEBUG==="info",T.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var L={textNode:void 0,numberNode:""},A=T.EVENTS.filter(function(I){return I!=="error"&&I!=="end"}),g=0,te;T.STATE={BEGIN:g++,VALUE:g++,OPEN_OBJECT:g++,CLOSE_OBJECT:g++,OPEN_ARRAY:g++,CLOSE_ARRAY:g++,TEXT_ESCAPE:g++,STRING:g++,BACKSLASH:g++,END:g++,OPEN_KEY:g++,CLOSE_KEY:g++,TRUE:g++,TRUE2:g++,TRUE3:g++,FALSE:g++,FALSE2:g++,FALSE3:g++,FALSE4:g++,NULL:g++,NULL2:g++,NULL3:g++,NUMBER_DECIMAL_POINT:g++,NUMBER_DIGIT:g++};for(var se in T.STATE)T.STATE[T.STATE[se]]=se;g=T.STATE;let k={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125};Object.create||(Object.create=function(I){function l(){this.__proto__=I}return l.prototype=I,new l}),Object.getPrototypeOf||(Object.getPrototypeOf=function(I){return I.__proto__}),Object.keys||(Object.keys=function(I){var l=[];for(var V in I)I.hasOwnProperty(V)&&l.push(V);return l});function W(I){var l=Math.max(T.MAX_BUFFER_LENGTH,10),V=0;for(var R in L){var Ne=I[R]===void 0?0:I[R].length;if(Ne>l)switch(R){case"text":closeText(I);break;default:oe(I,"Max buffer length exceeded: "+R)}V=Math.max(V,Ne)}I.bufferCheckPosition=T.MAX_BUFFER_LENGTH-V+I.position}function he(I){for(var l in L)I[l]=L[l]}var Ge=/[\\"\n]/g;function Xe(I){if(!(this instanceof Xe))return new Xe(I);var l=this;he(l),l.bufferCheckPosition=T.MAX_BUFFER_LENGTH,l.q=l.c=l.p="",l.opt=I||{},l.closed=l.closedRoot=l.sawRoot=!1,l.tag=l.error=null,l.state=g.BEGIN,l.stack=new Array,l.position=l.column=0,l.line=1,l.slashed=!1,l.unicodeI=0,l.unicodeS=null,l.depth=0,Ce(l,"onready")}Xe.prototype={end:function(){Le(this)},write:bn,resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{te=Hi.Stream}catch{te=function(){}}function Oe(I){return new ge(I)}function ge(I){if(!(this instanceof ge))return new ge(I);this._parser=new Xe(I),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string="";var l=this;te.apply(l),this._parser.onend=function(){l.emit("end")},this._parser.onerror=function(V){l.emit("error",V),l._parser.error=null},A.forEach(function(V){Object.defineProperty(l,"on"+V,{get:function(){return l._parser["on"+V]},set:function(R){if(!R)return l.removeAllListeners(V),l._parser["on"+V]=R,R;l.on(V,R)},enumerable:!0,configurable:!1})})}ge.prototype=Object.create(te.prototype,{constructor:{value:ge}}),ge.prototype.write=function(I){I=new Buffer(I);for(var l=0;l<I.length;l++){var V=I[l];if(this.bytes_remaining>0){for(var R=0;R<this.bytes_remaining;R++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+R]=I[R];this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,l=l+R-1,this._parser.write(this.string),this.emit("data",this.string);continue}if(this.bytes_remaining===0&&V>=128)if(V>=194&&V<=223&&(this.bytes_in_sequence=2),V>=224&&V<=239&&(this.bytes_in_sequence=3),V>=240&&V<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+l>I.length){for(var Ne=0;Ne<=I.length-1-l;Ne++)this.temp_buffs[this.bytes_in_sequence][Ne]=I[l+Ne];return this.bytes_remaining=l+this.bytes_in_sequence-I.length,!0}else{this.string=I.slice(l,l+this.bytes_in_sequence).toString(),l=l+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string);continue}for(var ve=l;ve<I.length&&!(I[ve]>=128);ve++);this.string=I.slice(l,ve).toString(),this._parser.write(this.string),this.emit("data",this.string),l=ve-1}},ge.prototype.end=function(I){return I&&I.length&&this._parser.write(I.toString()),this._parser.end(),!0},ge.prototype.on=function(I,l){var V=this;return!V._parser["on"+I]&&A.indexOf(I)!==-1&&(V._parser["on"+I]=function(){var R=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);R.splice(0,0,I),V.emit.apply(V,R)}),te.prototype.on.call(V,I,l)},ge.prototype.destroy=function(){he(this._parser),this.emit("close")};function Ce(I,l,V){T.INFO&&console.log("-- emit",l,V),I[l]&&I[l](V)}function vn(I,l,V){Ze(I),Ce(I,l,V)}function Ze(I,l){I.textNode=rn(I.opt,I.textNode),I.textNode!==void 0&&Ce(I,l||"onvalue",I.textNode),I.textNode=void 0}function re(I){I.numberNode&&Ce(I,"onvalue",parseFloat(I.numberNode)),I.numberNode=""}function rn(I,l){return l===void 0||(I.trim&&(l=l.trim()),I.normalize&&(l=l.replace(/\s+/g," "))),l}function oe(I,l){return Ze(I),l+=`
Line: `+I.line+`
Column: `+I.column+`
Char: `+I.c,l=new Error(l),I.error=l,Ce(I,"onerror",l),I}function Le(I){return(I.state!==g.VALUE||I.depth!==0)&&oe(I,"Unexpected end"),Ze(I),I.c="",I.closed=!0,Ce(I,"onend"),Xe.call(I,I.opt),I}function Ye(I){return I===k.carriageReturn||I===k.lineFeed||I===k.space||I===k.tab}function bn(I){var l=this;if(this.error)throw this.error;if(l.closed)return oe(l,"Cannot write after close. Assign an onready handler.");if(I===null)return Le(l);var V=0,R=I.charCodeAt(0),Ne=l.p;for(T.DEBUG&&console.log("write -> ["+I+"]");R&&(Ne=R,l.c=R=I.charCodeAt(V++),Ne!==R?l.p=Ne:Ne=l.p,!!R);)switch(T.DEBUG&&console.log(V,R,T.STATE[l.state]),l.position++,R===k.lineFeed?(l.line++,l.column=0):l.column++,l.state){case g.BEGIN:R===k.openBrace?l.state=g.OPEN_OBJECT:R===k.openBracket?l.state=g.OPEN_ARRAY:Ye(R)||oe(l,"Non-whitespace before {[.");continue;case g.OPEN_KEY:case g.OPEN_OBJECT:if(Ye(R))continue;if(l.state===g.OPEN_KEY)l.stack.push(g.CLOSE_KEY);else if(R===k.closeBrace){Ce(l,"onopenobject"),this.depth++,Ce(l,"oncloseobject"),this.depth--,l.state=l.stack.pop()||g.VALUE;continue}else l.stack.push(g.CLOSE_OBJECT);R===k.doubleQuote?l.state=g.STRING:oe(l,'Malformed object key should start with "');continue;case g.CLOSE_KEY:case g.CLOSE_OBJECT:if(Ye(R))continue;l.state,g.CLOSE_KEY,R===k.colon?(l.state===g.CLOSE_OBJECT?(l.stack.push(g.CLOSE_OBJECT),Ze(l,"onopenobject"),this.depth++):Ze(l,"onkey"),l.state=g.VALUE):R===k.closeBrace?(vn(l,"oncloseobject"),this.depth--,l.state=l.stack.pop()||g.VALUE):R===k.comma?(l.state===g.CLOSE_OBJECT&&l.stack.push(g.CLOSE_OBJECT),Ze(l),l.state=g.OPEN_KEY):oe(l,"Bad object");continue;case g.OPEN_ARRAY:case g.VALUE:if(Ye(R))continue;if(l.state===g.OPEN_ARRAY)if(Ce(l,"onopenarray"),this.depth++,l.state=g.VALUE,R===k.closeBracket){Ce(l,"onclosearray"),this.depth--,l.state=l.stack.pop()||g.VALUE;continue}else l.stack.push(g.CLOSE_ARRAY);R===k.doubleQuote?l.state=g.STRING:R===k.openBrace?l.state=g.OPEN_OBJECT:R===k.openBracket?l.state=g.OPEN_ARRAY:R===k.t?l.state=g.TRUE:R===k.f?l.state=g.FALSE:R===k.n?l.state=g.NULL:R===k.minus?l.numberNode+="-":k._0<=R&&R<=k._9?(l.numberNode+=String.fromCharCode(R),l.state=g.NUMBER_DIGIT):oe(l,"Bad value");continue;case g.CLOSE_ARRAY:if(R===k.comma)l.stack.push(g.CLOSE_ARRAY),Ze(l,"onvalue"),l.state=g.VALUE;else if(R===k.closeBracket)vn(l,"onclosearray"),this.depth--,l.state=l.stack.pop()||g.VALUE;else{if(Ye(R))continue;oe(l,"Bad array")}continue;case g.STRING:l.textNode===void 0&&(l.textNode="");var ve=V-1,Je=l.slashed,qe=l.unicodeI;e:for(;;){for(T.DEBUG&&console.log(V,R,T.STATE[l.state],Je);qe>0;)if(l.unicodeS+=String.fromCharCode(R),R=I.charCodeAt(V++),l.position++,qe===4?(l.textNode+=String.fromCharCode(parseInt(l.unicodeS,16)),qe=0,ve=V-1):qe++,!R)break e;if(R===k.doubleQuote&&!Je){l.state=l.stack.pop()||g.VALUE,l.textNode+=I.substring(ve,V-1),l.position+=V-1-ve;break}if(R===k.backslash&&!Je&&(Je=!0,l.textNode+=I.substring(ve,V-1),l.position+=V-1-ve,R=I.charCodeAt(V++),l.position++,!R))break;if(Je){if(Je=!1,R===k.n?l.textNode+=`
`:R===k.r?l.textNode+="\r":R===k.t?l.textNode+="	":R===k.f?l.textNode+="\f":R===k.b?l.textNode+="\b":R===k.u?(qe=1,l.unicodeS=""):l.textNode+=String.fromCharCode(R),R=I.charCodeAt(V++),l.position++,ve=V-1,R)continue;break}Ge.lastIndex=V;var en=Ge.exec(I);if(en===null){V=I.length+1,l.textNode+=I.substring(ve,V-1),l.position+=V-1-ve;break}if(V=en.index+1,R=I.charCodeAt(en.index),!R){l.textNode+=I.substring(ve,V-1),l.position+=V-1-ve;break}}l.slashed=Je,l.unicodeI=qe;continue;case g.TRUE:R===k.r?l.state=g.TRUE2:oe(l,"Invalid true started with t"+R);continue;case g.TRUE2:R===k.u?l.state=g.TRUE3:oe(l,"Invalid true started with tr"+R);continue;case g.TRUE3:R===k.e?(Ce(l,"onvalue",!0),l.state=l.stack.pop()||g.VALUE):oe(l,"Invalid true started with tru"+R);continue;case g.FALSE:R===k.a?l.state=g.FALSE2:oe(l,"Invalid false started with f"+R);continue;case g.FALSE2:R===k.l?l.state=g.FALSE3:oe(l,"Invalid false started with fa"+R);continue;case g.FALSE3:R===k.s?l.state=g.FALSE4:oe(l,"Invalid false started with fal"+R);continue;case g.FALSE4:R===k.e?(Ce(l,"onvalue",!1),l.state=l.stack.pop()||g.VALUE):oe(l,"Invalid false started with fals"+R);continue;case g.NULL:R===k.u?l.state=g.NULL2:oe(l,"Invalid null started with n"+R);continue;case g.NULL2:R===k.l?l.state=g.NULL3:oe(l,"Invalid null started with nu"+R);continue;case g.NULL3:R===k.l?(Ce(l,"onvalue",null),l.state=l.stack.pop()||g.VALUE):oe(l,"Invalid null started with nul"+R);continue;case g.NUMBER_DECIMAL_POINT:R===k.period?(l.numberNode+=".",l.state=g.NUMBER_DIGIT):oe(l,"Leading zero not followed by .");continue;case g.NUMBER_DIGIT:k._0<=R&&R<=k._9?l.numberNode+=String.fromCharCode(R):R===k.period?(l.numberNode.indexOf(".")!==-1&&oe(l,"Invalid number has two dots"),l.numberNode+="."):R===k.e||R===k.E?((l.numberNode.indexOf("e")!==-1||l.numberNode.indexOf("E")!==-1)&&oe(l,"Invalid number has two exponential"),l.numberNode+="e"):R===k.plus||R===k.minus?(Ne===k.e||Ne===k.E||oe(l,"Invalid symbol in number"),l.numberNode+=String.fromCharCode(R)):(re(l),V--,l.state=l.stack.pop()||g.VALUE);continue;default:oe(l,"Unknown state: "+l.state)}return l.position>=l.bufferCheckPosition&&W(l),l}})(E)});function Xi(K){var E=0,T=Zi(!0),D={pullAsync:function(L){return at(this,void 0,void 0,function(){var A,g,te;return Qn(this,function(se){switch(se.label){case 0:return A=K.slice(E,E+L),E+=L,[4,fi(A,"text")];case 1:return g=se.sent(),te=T.write(g),D.result=te||{},[2,te]}})})},pullSync:function(L){var A=K.slice(E,E+L);E+=L;var g=pi(A,"text"),te=T.write(g);return D.result=te||{},te},done:function(){return T.done()},eof:function(){return E>=K.size},result:{}};return D}function Zi(K){var E=Qi.parser(),T=0,D,L=[],A,g,te=!1,se=!1;return E.onopenobject=function(k){var W={};W.incomplete=!0,D||(D=W),A&&(L.push([g,A,se]),K&&(se?A.push(W):A[g]=W)),A=W,g=k,se=!1,++T},E.onkey=function(k){return g=k},E.onvalue=function(k){return se?A.push(k):A[g]=k},E.oncloseobject=function(){var k;if(delete A.incomplete,g=null,--T===0)te=!0;else{var W=A;k=L.pop(),g=k[0],A=k[1],se=k[2],K||(se?A.push(W):A[g]=W)}},E.onopenarray=function(){var k=[];k.incomplete=!0,D||(D=k),A&&(L.push([g,A,se]),K&&(se?A.push(k):A[g]=k)),A=k,se=!0,g=null,++T},E.onclosearray=function(){var k;if(delete A.incomplete,g=null,--T===0)te=!0;else{var W=A;k=L.pop(),g=k[0],A=k[1],se=k[2],K||(se?A.push(W):A[g]=W)}},{write:function(k){return E.write(k),D},done:function(){return te}}}var yi=1024;function eo(K,E){return at(this,void 0,void 0,function(){var T,D,L,A;return Qn(this,function(g){switch(g.label){case 0:return E=E||{},T=E.chunkSizeBytes||yi*1024,[4,vi(K,T)];case 1:return D=g.sent(),L=D.result.data,A=new xn(L.databaseName),A.version(L.databaseVersion).stores(Vi(L)),[4,Qt(A,D,E)];case 2:return g.sent(),[2,A]}})})}function Qt(K,E,T){return at(this,void 0,void 0,function(){function D(){return at(this,void 0,void 0,function(){var ge,Ce,vn,Ze,re;return Qn(this,function(rn){switch(rn.label){case 0:ge=function(oe){var Le,Ye,bn,I,l,V,R,Ne,ve,Je,qe,en,un;return Qn(this,function(dn){switch(dn.label){case 0:if(k.includes(oe.tableName))return[2,"continue"];if(!oe.rows)return[2,"break"];if(!oe.rows.incomplete&&oe.rows.length===0)return[2,"continue"];if(W&&xn.ignoreTransaction(function(){return W(he)}),Le=oe.tableName,Ye=K.table(Le),bn=se.tables.filter(function(He){return He.name===Le})[0].schema,!Ye){if(T.acceptMissingTables)return[2,"continue"];throw new Error("Exported table ".concat(oe.tableName," is missing in installed database"))}if(!T.acceptChangedPrimaryKey&&bn.split(",")[0]!=Ye.schema.primKey.src)throw new Error("Primary key differs for table ".concat(oe.tableName,". "));for(I=oe.rows,l=[],V=0;V<I.length&&(R=I[V],!R.incomplete);V++)l.push(Gn.revive(R));return Ne=T.filter,ve=T.transform,Je=Ne?oe.inbound?l.filter(function(He){return Ne(Le,He)}):l.filter(function(He){var ze=He[0],wn=He[1];return Ne(Le,wn,ze)}):l,ve&&(Je=Je.map(oe.inbound?function(He){return ve(Le,He).value}:function(He){var ze=He[0],wn=He[1],En=ve(Le,wn,ze);return[En.key,En.value]})),qe=oe.inbound?[void 0,Je]:[Je.map(function(He){return He[0]}),l.map(function(He){return He[1]})],en=qe[0],un=qe[1],T.overwriteValues?[4,Ye.bulkPut(un,en)]:[3,2];case 1:return dn.sent(),[3,4];case 2:return[4,Ye.bulkAdd(un,en)];case 3:dn.sent(),dn.label=4;case 4:return he.completedRows+=l.length,l.incomplete||(he.completedTables+=1),I.splice(0,l.length),[2]}})},Ce=0,vn=se.data,rn.label=1;case 1:return Ce<vn.length?(Ze=vn[Ce],[5,ge(Ze)]):[3,4];case 2:if(re=rn.sent(),re==="break")return[3,4];rn.label=3;case 3:return Ce++,[3,1];case 4:for(;se.data.length>0&&se.data[0].rows&&!se.data[0].rows.incomplete;)se.data.splice(0,1);return!A.done()&&!A.eof()?te?(A.pullSync(L),[3,7]):[3,5]:[3,8];case 5:return[4,xn.waitFor(A.pullAsync(L))];case 6:rn.sent(),rn.label=7;case 7:return[3,9];case 8:return[3,10];case 9:return[3,0];case 10:return[2]}})})}var L,A,g,te,se,k,W,he,Ge,Xe,Oe;return Qn(this,function(ge){switch(ge.label){case 0:return T=T||{},L=T.chunkSizeBytes||yi*1024,[4,vi(E,L)];case 1:if(A=ge.sent(),g=A.result,te="FileReaderSync"in self,se=g.data,k=T.skipTables?T.skipTables:[],!T.acceptNameDiff&&K.name!==se.databaseName)throw new Error("Name differs. Current database name is ".concat(K.name," but export is ").concat(se.databaseName));if(!T.acceptVersionDiff&&K.verno!==se.databaseVersion)throw new Error("Database version differs. Current database is in version ".concat(K.verno," but export is ").concat(se.databaseVersion));if(W=T.progressCallback,he={done:!1,completedRows:0,completedTables:0,totalRows:se.tables.reduce(function(Ce,vn){return Ce+vn.rowCount},0),totalTables:se.tables.length},W&&xn.ignoreTransaction(function(){return W(he)}),!T.clearTablesBeforeImport)return[3,5];Ge=0,Xe=K.tables,ge.label=2;case 2:return Ge<Xe.length?(Oe=Xe[Ge],k.includes(Oe.name)?[3,4]:[4,Oe.clear()]):[3,5];case 3:ge.sent(),ge.label=4;case 4:return Ge++,[3,2];case 5:return T.noTransaction?[4,D()]:[3,7];case 6:return ge.sent(),[3,9];case 7:return[4,K.transaction("rw",K.tables,D)];case 8:ge.sent(),ge.label=9;case 9:return he.done=!0,W&&xn.ignoreTransaction(function(){return W(he)}),[2]}})})}function vi(K,E){return at(this,void 0,void 0,function(){var T,D;return Qn(this,function(L){switch(L.label){case 0:T="slice"in K?Xi(K):K,L.label=1;case 1:return T.eof()?[3,3]:[4,T.pullAsync(E)];case 2:return L.sent(),T.result.data&&T.result.data.data?[3,3]:[3,1];case 3:if(D=T.result,!D||D.formatName!="dexie")throw new Error("Given file is not a dexie export");if(D.formatVersion>Wi)throw new Error("Format version ".concat(D.formatVersion," not supported"));if(!D.data)throw new Error("No data in export file");if(!D.data.databaseName)throw new Error("Missing databaseName in export file");if(!D.data.databaseVersion)throw new Error("Missing databaseVersion in export file");if(!D.data.tables)throw new Error("Missing tables in export file");return[2,T]}})})}xn.prototype.export=function(K){return jr(this,K)};xn.prototype.import=function(K,E){return Qt(this,K,E)};xn.import=function(K,E){return eo(K,E)};var Ir=class extends xn{constructor(){super(Yt.db.NAME),this.version(1).stores({stocks:"&id, &scripCode.nse"});let E=[];this.on("ready",()=>tt(this,null,function*(){let T=yield this.stocks.toArray();E=yield Promise.all(T.map(D=>tt(this,null,function*(){if(D.scripCode.isin)return D;{let L=yield fetch(Yt.api.STOCK_QUOTE+D.vendorCode.etm);if(L.ok){let A=yield L.json(),g=A.nseScripCode?A.nseScripCode.toUpperCase().endsWith("EQ")?A.nseScripCode.slice(0,-2):A.nseScripCode:"",te=yield fetch(Yt.api.STOCK_SEARCH_SECONDARY+(g||A.bseScripCode||"")),se;if(te.ok){let{result:k}=yield te.json();k.length>0&&(se=k.find(W=>W.isinid&&W.isinid===A.isinCode||W.nseid&&W.nseid===g||W.bseid&&W.bseid===A.bseScripCode))}return $t(Vt({},D),{scripCode:{isin:A.isinCode||"",nse:g,bse:A.bseScripCode||""},vendorCode:{etm:{primary:A.companyId,chart:(A.nseScripCode&&A.nse?A.nse.symbol:A.bse?.symbol)||""},mc:{primary:se?.id||""}}})}else return D}}))),this.stocks.clear(),this.stocks.bulkAdd(E)})),this.version(2).stores({stocks:"&id, &scripCode.isin"})}},zn=new Ir;var Io=(()=>{class K{constructor(){this.stocks$=li(()=>zn.stocks.toArray())}addOrUpdate(T,D){return tt(this,null,function*(){let L=yield zn.stocks.get({"scripCode.isin":T.scripCode.isin});L?.id?yield zn.stocks.update(L.id,{transactions:[...L.transactions,D]}):(T=$t(Vt({},T),{id:Er(),transactions:[D]}),yield zn.stocks.add(T,T.id))})}delete(T){return tt(this,null,function*(){yield zn.stocks.delete(T)})}importDb(T,D){return tt(this,null,function*(){yield zn.delete(),yield zn.open(),yield Qt(zn,T,{progressCallback:D})})}exportDb(T){return tt(this,null,function*(){return yield jr(zn,{progressCallback:T})})}deleteDb(){return tt(this,null,function*(){yield zn.delete(),yield zn.open()})}static{this.\u0275fac=function(D){return new(D||K)}}static{this.\u0275prov=ai({token:K,factory:K.\u0275fac,providedIn:"root"})}}return K})();export{Er as a,Io as b};
