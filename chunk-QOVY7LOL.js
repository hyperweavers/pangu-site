import{d as a,g as b}from"./chunk-YKAOPC6R.js";import{a as w,b as x}from"./chunk-2SVEDF6X.js";import{X as N,_ as O,a as j,b as C,fa as W,la as D,r as I,w as M}from"./chunk-JGUQRCJW.js";var p=(function(n){return n.BUY="BUY",n.SELL="SELL",n})(p||{});var ee=(()=>{let r=class r{constructor(){let U=D(x),f=D(b);this.portfolio$=I(U.stocks$).pipe(O(A=>f.getStocks(A.map(m=>m.vendorCode.etm.primary)).pipe(M(m=>{let c=m.map(e=>{let s=A.find(o=>o.vendorCode.etm.primary===e.vendorCode.etm.primary),l=s?.transactions.reduce((o,t)=>t.type===p.BUY?o+t.quantity:o-t.quantity,0)||0,g=s?.transactions.reduce((o,t)=>t.type===p.BUY?o+t.quantity*t.price+(t.charges||0):o-t.quantity*t.price-(t.charges||0),0)||0,Y=g/l||0,V=e.quote?.nse?(e.quote.nse.price-Y)*l:0,z=V/g*100||0;return C(j({},e),{id:s?.id||w(),transactions:s?.transactions||[],quantity:l,averagePrice:Y,investment:g,marketValue:e.quote?.nse?e.quote.nse.price*l:0,totalProfitLoss:{direction:V>=0?a.UP:a.DOWN,percentage:z,value:V}})}),i=0,y=0,u=0,B=0,d=0,q=0,P=0,v=0;c.map(e=>{let s=e.quote?.nse&&e.quantity?e.quote.nse.price*e.quantity:0;i+=e.investment||0,y+=s,u+=e.quote?.nse&&e.quantity?e.quote.nse.change.value*e.quantity:0,B+=e.quote?.nse?.close&&e.quantity?e.quote.nse.close*e.quantity:0,e.quote?.nse?.change?.direction===a.UP?d++:q++,e.totalProfitLoss?.direction===a.UP?P++:v++});let E=u/B*100||0,L=y-i,S=L/i*100||0,$=d/c.length*100||0,F=q/c.length*100||0,R=P/c.length*100||0,h=v/c.length*100||0;return{holdings:c,investment:i,marketValue:y,dayProfitLoss:{direction:u>=0?a.UP:a.DOWN,percentage:E,value:u},totalProfitLoss:{direction:L>=0?a.UP:a.DOWN,percentage:S,value:L},dayAdvance:{percentage:$,value:d},dayDecline:{percentage:F,value:q},totalAdvance:{percentage:R,value:P},totalDecline:{percentage:h,value:v}}})))).pipe(N(1))}};r.\u0275fac=function(f){return new(f||r)},r.\u0275prov=W({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();export{p as a,ee as b};
